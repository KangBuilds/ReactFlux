import{p as Ft,m as ue,u as p,r as g,d as z,P as ps,i as gs,o as Et,a as xs,b as ys,c as _s,e as W,M as v,C as js,j as e,f as ee,g as Ke,h as oe,A as bs,I as vs,T as _,S as Fe,k as Ge,l as mt,n as ws,q as Ss,s as Ye,t as Cs,v as ks,w as Oe,B as F,x as Ts,D as Is,y as Ee,z as de,E as At,F as Fs,G as Es,H as As,J as pt,K as Nt,L as Ns,N as Ae,O as Ls,Q as Lt,R as re,U as Rs,V as Ps,W as Ds,X as Ms,Y as Vs,Z as H,_ as Y,$ as R,a0 as gt,a1 as P,a2 as ge,a3 as q,a4 as Xe,a5 as xt,a6 as Rt,a7 as Os,a8 as Pt,a9 as Dt,aa as zs,ab as ce,ac as Us,ad as $s,ae as Bs,af as Hs,ag as qs,ah as Ws,ai as Ks,aj as Gs,ak as Ys,al as Xs,am as Mt,an as Vt,ao as Qe,ap as Qs,aq as Js,ar as Zs,as as er,at as tr,au as sr,av as ze,aw as rr,ax as ar,ay as nr,az as Ne,aA as or,aB as ir,aC as lr,aD as cr,aE as dr,aF as Be,aG as ur,aH as Ot,aI as hr,aJ as fr,aK as mr,aL as Je,aM as pr,aN as yt,aO as gr,aP as xr,aQ as yr,aR as _r,aS as jr,aT as br,aU as vr,aV as wr}from"./vendor-BwBbEY10.js";(function(){const s=document.createElement("link").relList;if(s&&s.supports&&s.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))a(n);new MutationObserver(n=>{for(const l of n)if(l.type==="childList")for(const o of l.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&a(o)}).observe(document,{childList:!0,subtree:!0});function r(n){const l={};return n.integrity&&(l.integrity=n.integrity),n.referrerPolicy&&(l.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?l.credentials="include":n.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function a(n){if(n.ep)return;n.ep=!0;const l=r(n);fetch(n.href,l)}})();const Sr="modulepreload",Cr=function(t){return"/"+t},_t={},ve=function(s,r,a){let n=Promise.resolve();if(r&&r.length>0){document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),i=(o==null?void 0:o.nonce)||(o==null?void 0:o.getAttribute("nonce"));n=Promise.allSettled(r.map(u=>{if(u=Cr(u),u in _t)return;_t[u]=!0;const d=u.endsWith(".css"),c=d?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${u}"]${c}`))return;const h=document.createElement("link");if(h.rel=d?"stylesheet":Sr,d||(h.as="script"),h.crossOrigin="",h.href=u,i&&h.setAttribute("nonce",i),document.head.appendChild(h),d)return new Promise((x,b)=>{h.addEventListener("load",x),h.addEventListener("error",()=>b(new Error(`Unable to preload CSS for ${u}`)))})}))}function l(o){const i=new Event("vite:preloadError",{cancelable:!0});if(i.payload=o,window.dispatchEvent(i),!i.defaultPrevented)throw o}return n.then(o=>{for(const i of o||[])i.status==="rejected"&&l(i.reason);return s().catch(l)})},kr=(t,s,r)=>{const a=t[s];return a?typeof a=="function"?a():Promise.resolve(a):new Promise((n,l)=>{(typeof queueMicrotask=="function"?queueMicrotask:setTimeout)(l.bind(null,new Error("Unknown variable dynamic import: "+s+(s.split("/").length!==r?". Note that variables only represent file names one level deep.":""))))})},Tr=()=>{const{language:t}=I.get(),s=Ze();return t||s},Ze=()=>{const t=navigator.language;return t==="zh-Hans-CN"?"zh-CN":t},zt={articleWidth:90,fontFamily:"system-ui",fontSize:1.05,homePage:"all",language:Ze(),layout:"large",markReadOnScroll:!1,orderBy:"created_at",orderDirection:"desc",pageSize:100,removeDuplicates:"none",showAllFeeds:!1,showUnreadFeedsOnly:!1,showDetailedRelativeTime:!1,showFeedIcon:!0,showStatus:"unread",theme:"light",themeColor:"Blue"},I=Ft("settings",zt,{encode:JSON.stringify,decode:JSON.parse}),U=t=>I.get()[t],B=t=>I.set({...I.get(),...t}),Ir=()=>I.set(zt),E=(t,s=null)=>r=>{const a=t.get();if(typeof a=="object"&&a!==null){if(s===null)return;typeof r=="function"?t.set({...a,[s]:r(a[s])}):t.set({...a,[s]:r})}else typeof r=="function"?t.set(r(a)):t.set(r)},V=ue({polyglot:null}),Fr=E(V,"polyglot"),Er=async(t,s)=>{let r,a=t;try{r=await kr(Object.assign({"../locales/en-US.json":()=>ve(()=>import("./en-US-Cpyzyciy.js"),[]),"../locales/es-ES.json":()=>ve(()=>import("./es-ES-8x7boQ8A.js"),[]),"../locales/zh-CN.json":()=>ve(()=>import("./zh-CN-D--ZqATe.js"),[])}),`../locales/${t}.json`,3)}catch{r=await ve(()=>import("./en-US-Cpyzyciy.js"),[]),a="en-US"}{const n=new ps({phrases:r.default,locale:a});Fr(n)}},Ut=()=>{const{language:t}=p(I);g.useEffect(()=>{t?(Er(t),t==="zh-CN"?z.locale("zh-cn"):t==="es"||t.startsWith("es-")?z.locale("es"):z.locale("en")):B({language:Ze()})},[t])},et=ue({addFeedModalVisible:!1,settingsModalVisible:!1}),Ar=E(et,"addFeedModalVisible"),Nr=E(et,"settingsModalVisible"),tt=()=>{const{addFeedModalVisible:t,settingsModalVisible:s}=p(et);return{addFeedModalVisible:t,setAddFeedModalVisible:Ar,settingsModalVisible:s,setSettingsModalVisible:Nr}},xe=()=>{const[t,s]=g.useState(window.innerWidth),r=t<=768,a=t<=992;return g.useEffect(()=>{const n=()=>s(window.innerWidth);return window.addEventListener("resize",n),()=>window.removeEventListener("resize",n)},[]),{width:t,isBelowMedium:r,isBelowLarge:a}},$t={server:"",token:"",username:"",password:""},Ue=Ft("auth",$t,{encode:JSON.stringify,decode:JSON.parse}),Bt=t=>Ue.set(t),Lr=()=>Bt($t),Rr=t=>{try{const s=new URL(t),{hostname:r,port:a}=s;return!!r&&!!a}catch{return!1}},Le=t=>{const{server:s,token:r,username:a,password:n}=t;return!s||!gs(s,{require_protocol:!0})&&!Rr(s)?!1:r||a&&n},Pr=()=>Et.create({retry:3,onRequest({_request:t,options:s}){const r=Ue.get();if(!Le(r))throw new Error("Invalid auth");const{server:a,token:n,username:l,password:o}=r;s.baseURL=a,s.headers=n?{"X-Auth-Token":n}:{Authorization:`Basic ${btoa(`${l}:${o}`)}`}},onRequestError({_request:t,_options:s,error:r}){console.error("Request error: ",r)},async onResponseError({_request:t,response:s,_options:r}){var l;s.status===401&&(localStorage.removeItem("auth"),await ms.navigate("/login"));const n=((l=s._data)==null?void 0:l.error_message)??s.statusText;throw console.error("Response error: ",n),new Error(n)}}),C=Pr();C.get=t=>C(t,{method:"GET"});C.post=(t,s)=>C(t,{method:"POST",body:s});C.put=(t,s)=>C(t,{method:"PUT",body:s});const Dr=async()=>C.get("/v1/categories"),Mr=async t=>C.post("/v1/categories",{title:t}),Vr=async t=>C.raw(`/v1/categories/${t}`,{method:"DELETE"}),Or=async(t,s,r=!1)=>{const a={title:s,hide_globally:r?"on":void 0};return C.put(`/v1/categories/${t}`,a)},zr=async t=>C.put(`/v1/categories/${t}/mark-all-as-read`);z.extend(xs);z.extend(ys);z.extend(_s);const Ur=t=>z(t).isAfter(z().subtract(24,"hour")),$r=()=>z().subtract(24,"hour").unix(),Br=()=>z().utc().format("YYYY-MM-DDTHH:mm:ss.SSSSSSZ"),Hr=t=>z(t).format("dddd, MMMM D, YYYY h:mm A"),Ht=(t,s)=>{const{polyglot:r}=V.get();if(!s){const m=z(),j=z(t),T=j.from(m),w=z.duration(m.diff(j)).asSeconds();return w>=0&&w<60?r.t("date.just_now"):T}const a=z(),l=z(t).diff(a),o=z.duration(Math.abs(l)),i=o.years(),u=o.months(),d=o.days(),c=o.hours(),h=o.minutes(),x=[];if(i>0&&x.push(r.t("date.years",i)),u>0&&x.push(r.t("date.months",u)),d>0&&x.push(r.t("date.days",d)),c>0&&x.push(r.t("date.hours",c)),h>0&&x.push(r.t("date.minutes",h)),x.length===0)return r.t("date.just_now");const b=x.join(" ");return l>0?r.t("date.in_time",{time:b}):r.t("date.time_ago",{time:b})},qt=t=>{const{polyglot:s}=V.get(),r=s.t("date.minutes",t);return s.t("article_card.reading_time",{time:r})},$e=async(t,s)=>C.put("/v1/entries",{entry_ids:t,status:s}),qr=async t=>C.put(`/v1/entries/${t}/bookmark`),Wr=async t=>C.get(`/v1/entries/${t}/fetch-content`),Kr=async t=>C.raw(`/v1/entries/${t}/save`,{method:"POST"}),he=(t,s={})=>{const{baseUrl:r,orderField:a,offset:n,limit:l,status:o}=t,i=U("orderDirection"),u=new URLSearchParams({order:a,direction:i,offset:n,limit:l,...s});return o&&u.append("status",o),`${r}?${u}`},Gr=async(t=0,s=null)=>{const r=U("orderBy"),a=U("pageSize"),n=U("showAllFeeds"),l={baseUrl:"/v1/entries",orderField:r,offset:t,limit:a,status:s},o={globally_visible:!n};return C.get(he(l,o))},Te=async(t=0,s=null,r=null)=>{const a=U("orderBy"),n=r??U("pageSize"),l=U("showAllFeeds"),o=$r(),i={baseUrl:"/v1/entries",orderField:a,offset:t,limit:n,status:s},u={globally_visible:!l,published_after:o};return C.get(he(i,u))},Wt=async(t=0,s=null)=>{const r=U("pageSize"),a={baseUrl:"/v1/entries",orderField:"changed_at",offset:t,limit:r,status:s},n={starred:"true"};return C.get(he(a,n))},Yr=async(t=0)=>{const s=U("pageSize"),r={baseUrl:"/v1/entries",orderField:"changed_at",offset:t,limit:s,status:"read"};return C.get(he(r))},Xr=async()=>C.get("/v1/feeds"),Qr=async()=>C.get("/v1/feeds/counters"),Jr=async t=>C.raw(`/v1/feeds/${t}/refresh`,{method:"PUT"}),Zr=async()=>C.raw("/v1/feeds/refresh",{method:"PUT"}),ea=async(t,s,r)=>C.post("/v1/feeds",{feed_url:t,category_id:s,crawler:r}),ta=async t=>C.raw(`/v1/feeds/${t}`,{method:"DELETE"}),jt=async(t,s)=>{const{categoryId:r,title:a,siteUrl:n,feedUrl:l,hidden:o,disabled:i,isFullText:u}=s;return C.put(`/v1/feeds/${t}`,{category_id:r,title:a,site_url:n,feed_url:l,hide_globally:o,disabled:i,crawler:u})},sa=async t=>C.put(`/v1/feeds/${t}/mark-all-as-read`),ra=async()=>C.get("/v1/me"),aa=async t=>C.get(`/v1/icons/${t}`),na=async()=>C.get("/v1/version"),oa=async()=>{const t=await ra();return C.put(`/v1/users/${t.data.id}/mark-all-as-read`)},Kt={isAppDataReady:!1,unreadInfo:{},unreadTodayCount:0,starredCount:0,historyCount:0,feedsData:[],categoriesData:[],isVersionAtLeast2_2_0:!1},O=ue(Kt),st=W(O,t=>{const{unreadInfo:s,feedsData:r}=t;return r.map(n=>({...n,unreadCount:s[n.id]??0})).sort((n,l)=>n.title.localeCompare(l.title,"en"))}),ye=W([O,st],(t,s)=>{const{categoriesData:r}=t;return r.map(n=>{const l=s.filter(o=>o.category.id===n.id);return{...n,unreadCount:l.reduce((o,i)=>o+(i.unreadCount??0),0),feedCount:l.length}}).sort((n,l)=>n.title.localeCompare(l.title,"en"))}),Gt=W(ye,t=>t.filter(s=>s.hide_globally).map(s=>s.id)),rt=W([st,Gt],(t,s)=>t.filter(r=>r.hide_globally||s.includes(r.category.id)).map(r=>r.id)),Yt=W([st,rt,I],(t,s,r)=>{const{showAllFeeds:a}=r;return t.filter(n=>a||!s.includes(n.id))}),ia=W([ye,Gt,I],(t,s,r)=>{const{showAllFeeds:a}=r;return t.filter(n=>a||!s.includes(n.id))}),Xt=W(Yt,t=>t.reduce((s,r)=>{const{id:a}=r.category;return s[a]||(s[a]=[]),s[a].push(r),s},{})),la=W([O,Yt],(t,s)=>{const{unreadInfo:r}=t;return Object.entries(r).reduce((a,[n,l])=>s.some(o=>o.id===Number(n))?a+l:a,0)}),Ie=E(O,"categoriesData"),ae=E(O,"feedsData"),Re=E(O,"historyCount"),bt=E(O,"isAppDataReady"),Pe=E(O,"starredCount"),at=E(O,"unreadInfo"),nt=E(O,"unreadTodayCount"),ca=E(O,"isVersionAtLeast2_2_0"),da=()=>O.set(Kt),Qt=(t,s)=>{const r=s.map(a=>a.id);return t.map(a=>r.includes(a.id)&&s.find(l=>l.id===a.id)||a)},He=(t,s)=>{const r={};let a=0;const n=t.filter(d=>d.status!==s);if(n.length===0)return;const{showStatus:l}=I.get();s==="read"?(Re(d=>d+n.length),l==="unread"&&Ve(d=>d-n.length)):(Re(d=>Math.max(0,d-n.length)),l==="unread"&&Ve(d=>d+n.length));for(const d of n){const c=d.feed.id,h=Ur(d.published_at),x=s==="read"?-1:1;r[c]=(r[c]??0)+x,a+=h?x:0}nt(d=>Math.max(0,d+a)),at(d=>{const c={...d};for(const[h,x]of Object.entries(r))c[h]=Math.max(0,(c[h]??0)+x);return c});const o=n.map(d=>({...d,status:s})),{activeContent:i}=A.get(),u=o.find(d=>d.id===(i==null?void 0:i.id));u&&X(u),je(d=>Qt(d,o))},ot=()=>{const{activeContent:t}=p(A),{polyglot:s}=p(V),r=(u,d)=>{He([u],d)},a=(u,d)=>{d?(Pe(h=>h+1),js({particleCount:100,angle:120,spread:70,origin:{x:1,y:1}})):Pe(h=>Math.max(0,h-1));const c={...u,starred:d};t&&X(c),je(h=>Qt(h,[c]))};return{handleEntryStatusUpdate:r,handleFetchContent:async()=>{try{const u=await Wr(t.id);v.success(s.t("actions.fetched_content_success")),X({...t,content:u.content})}catch{v.error(s.t("actions.fetched_content_error"))}},handleSaveToThirdPartyServices:async()=>{try{(await Kr(t.id)).status===202?v.success(s.t("actions.saved_to_third-party_services_success")):v.error(s.t("actions.saved_to_third-party_services_error"))}catch{v.error(s.t("actions.saved_to_third-party_services_error"))}},handleToggleStarred:async u=>{const d=!u.starred;a(u,d),qr(u.id).catch(()=>{v.error(d?s.t("actions.star_error"):s.t("actions.unstar_error")),a(u,!d)})},handleToggleStatus:async u=>{const d=u.status,c=d==="read"?"unread":"read";r(u,c),$e([u.id],c).catch(()=>{v.error(c==="read"?s.t("actions.mark_as_read_error"):s.t("actions.mark_as_unread_error")),r(u,d)})}}},ua=(t,s)=>{const{polyglot:r}=V.get();if(t.length===0||s==="none")return t;const a=t.map((c,h)=>({id:c.id,index:h})),n=new Map,l=new Map,o=new Map,i=[],u=t.slice().sort((c,h)=>c.id-h.id).filter(c=>{const{hash:h,title:x,url:b,id:m}=c;switch(s){case"hash":if(n.has(h))return i.push(c),!1;n.set(h,m);break;case"title":if(l.has(x))return i.push(c),!1;l.set(x,m);break;case"url":if(o.has(b))return i.push(c),!1;o.set(b,m);break;default:return!0}return!0}),d=i.filter(c=>c.status==="unread").map(c=>c.id);return d.length>0&&(He(i,"read"),$e(d,"read").catch(()=>{v.error(r.t("deduplicate.mark_as_read_error")),He(i,"unread")})),u.sort((c,h)=>{const x=a.find(m=>m.id===c.id).index,b=a.find(m=>m.id===h.id).index;return x-b})},ha=t=>{const s=new Array(t.length).fill(0);let r=0,a=1;for(;a<t.length;)t[a]===t[r]?(r++,s[a]=r,a++):r!==0?r=s[r-1]:(s[a]=0,a++);return s},we=(t,s,r=!0)=>{const a=r?t.toLowerCase():t,n=r?s.toLowerCase():s;if(n.length===0)return 0;const l=ha(n);let o=0,i=0;for(;o<a.length;)if(a[o]===n[i]?(o++,i++):i!==0?i=l[i-1]:o++,i===n.length)return o-i;return-1},fa=t=>{const s=[],r=[];let a=[];const n=[],l=t.match(/([-+|]?)\s*"([^"]+)"/g);let o=t;l&&(a=l.map(u=>{const d=u.trim()[0],c=u.match(/"([^"]+)"/)[1];switch(d){case"-":r.push(c);break;case"+":s.push(c);break;case"|":n.push([c]);break;default:s.push(c);break}return c}),o=t.replace(/([-+|]?)\s*"([^"]+)"/g,""));const i=o.split(/\s+/);for(const u of i){const d=u.replace(/^-|\+|\|$/,"");if(u.startsWith("-")&&d)r.push(d);else if(u.startsWith("+")&&d)s.push(d);else if(u.includes("|")){const c=u.split("|").filter(h=>h);c.length>0&&n.push(c)}else d&&s.push(d)}return{includeTerms:s,excludeTerms:r,exactPhrases:a,orConditions:n}},ma=(t,s,r=[],a=!0)=>{const{includeTerms:n,excludeTerms:l,exactPhrases:o,orConditions:i}=fa(s);return t.filter(u=>r.some(d=>{const c=u[d];if(typeof c!="string")return!1;const h=a?c.toLowerCase():c;if(l.some(m=>we(h,m,a)!==-1)||o.length>0&&!o.some(m=>we(h,m,a)!==-1))return!1;const x=n.every(m=>we(h,m,a)!==-1),b=i.length===0||i.some(m=>m.some(j=>we(h,j,a)!==-1));return x&&b}))},Jt=(t,s,r=[],a=!0)=>!Array.isArray(t)||t.length===0?(console.error("Invalid data input:",{receivedData:t,type:typeof t,isArray:Array.isArray(t),length:Array.isArray(t)?t.length:"N/A"}),[]):typeof s!="string"||s.trim().length===0?(console.error("Invalid query input:",{receivedQuery:s,type:typeof s,trimmedLength:typeof s=="string"?s.trim().length:"N/A"}),[]):ma(t,s,r,a),pa=(t,s)=>t.toLowerCase().includes(s.toLowerCase()),ga=(t,s,r)=>r?Jt(t,r,[s]):t,Zt={activeContent:null,entries:[],filterString:"",filterType:"Title",infoFrom:U("homePage"),isArticleFocused:!1,isArticleListReady:!1,loadMoreVisible:!1,offset:0,total:0},A=ue(Zt),_e=W([A,O,rt,I],(t,s,r,a)=>{const{entries:n,filterString:l,filterType:o,infoFrom:i}=t,u=ga(n,o,l),{isVersionAtLeast2_2_0:d}=s,{removeDuplicates:c,showAllFeeds:h}=a,x=!["starred","history"].includes(i),b=j=>d||h||!r.includes(j.feed.id),m=x?u.filter(b):u;return c==="none"||["starred","history"].includes(i)?m:ua(m,c)}),es=W([A,_e],(t,s)=>{const{activeContent:r}=t;return r?s.findIndex(a=>a.id===r.id):-1}),X=E(A,"activeContent"),je=E(A,"entries"),De=E(A,"filterString"),Me=E(A,"filterType"),xa=E(A,"infoFrom"),ne=E(A,"isArticleFocused"),vt=E(A,"isArticleListReady"),ts=E(A,"loadMoreVisible"),Ve=E(A,"offset"),ya=E(A,"total"),_a=()=>A.set(Zt),wt=ue(),Se=new Set,ja=t=>{const s=p(wt);return g.useEffect(()=>{s[t]||Se.has(t)||(Se.add(t),aa(t).then(r=>{const a=`data:${r.data}`;wt.setKey(t,a),Se.delete(t)}).catch(()=>{Se.delete(t)}))},[t,s]),s[t]},ba=t=>{const s=/^(?:http|https):\/\/((?!(\d+\.){3}\d+)([^/?#]+))/,r=t.match(s);return r?r[1]:null},St=t=>{const s=ba(t);if(s){const r=s.split(".");if(r.length>=2)return r.slice(-2).join(".")}return null},va=t=>`https://icons.duckduckgo.com/ip3/${St(t.site_url)??St(t.feed_url)}.ico`,ss=({feed:t,className:s="feed-icon"})=>{const{icon_id:r}=t.icon,a=va(t);if(r===0)return e.jsx("img",{className:s,src:a,alt:""});const[n,l]=g.useState(a),o=ja(r);return g.useEffect(()=>{o&&l(o)},[o]),e.jsx("img",{className:s,src:n,alt:"",onError:()=>l(a)})},rs=ee.Item,wa=({category:t,path:s})=>{var o;const a=(o=p(Xt)[t.id])==null?void 0:o.reduce((i,u)=>i+u.unreadCount,0),n=oe(),l=()=>{n(`/category/${t.id}`),X(null)};return e.jsxs("div",{className:Oe("category-title",{"submenu-active":s===`/category/${t.id}`,"submenu-inactive":s!==`/category/${t.id}`}),onClick:l,onKeyDown:i=>{(i.key==="Enter"||i.key===" ")&&l()},tabIndex:0,role:"button",style:{cursor:"pointer"},children:[e.jsx(_.Ellipsis,{expandable:!1,showTooltip:!0,style:{width:a?"80%":"100%",fontWeight:500},children:t.title}),a>0&&e.jsx(_.Ellipsis,{className:"unread-count",expandable:!1,style:{fontWeight:500},children:a})]})},Sa=({count:t})=>e.jsx(_.Ellipsis,{className:"item-count",expandable:!1,children:t||""}),Ce=({path:t,Icon:s,label:r,count:a})=>{const n=Ke(),l=oe(),o=n.pathname===t,i=()=>{l(t),X(null)};return e.jsx(rs,{onClick:i,className:Oe("arco-menu-item",{"arco-menu-selected":o}),children:e.jsxs("div",{className:"custom-menu-item",children:[e.jsxs("span",{children:[e.jsx(s,{}),r]}),e.jsx(Sa,{count:a})]})},t)},as=()=>{const{homePage:t,showFeedIcon:s,showUnreadFeedsOnly:r}=p(I),{historyCount:a,isAppDataReady:n,starredCount:l,unreadTodayCount:o}=p(O),i=p(Xt),u=p(ia),d=p(la),{polyglot:c}=p(V),h=Ke(),x=oe(),[b,m]=g.useState([`/${t}`]),j=h.pathname;g.useEffect(()=>{m([j])},[j]);const T=()=>e.jsxs(e.Fragment,{children:[e.jsx(Ce,{path:"/all",Icon:ws,label:c.t("sidebar.all"),count:d}),e.jsx(Ce,{path:"/today",Icon:Ss,label:c.t("sidebar.today"),count:o}),e.jsx(Ce,{path:"/starred",Icon:Ye,label:c.t("sidebar.starred"),count:l}),e.jsx(Ce,{path:"/history",Icon:Cs,label:c.t("sidebar.history"),count:a})]}),w=S=>{var $;return($=i[S])==null?void 0:$.filter(D=>!r||D.unreadCount>0).map(D=>e.jsx(rs,{style:{position:"relative",overflow:"hidden"},onClick:K=>{K.stopPropagation(),x(`/feed/${D.id}`),X(null)},children:e.jsxs("div",{className:"custom-menu-item",children:[e.jsxs(_.Ellipsis,{expandable:!1,showTooltip:!0,style:{width:D.unreadCount?"80%":"100%",paddingLeft:"20px",boxSizing:"border-box"},children:[s&&e.jsx(ss,{feed:D,className:"feed-icon-sidebar"}),D.title]}),D.unreadCount!==0&&e.jsx(_.Ellipsis,{className:"item-count",expandable:!1,children:D.unreadCount})]})},`/feed/${D.id}`))},M=()=>u.filter(S=>!r||S.unreadCount>0).map(S=>e.jsx(mt.Item,{name:`/category/${S.id}`,style:{position:"relative",overflow:"hidden"},header:e.jsx(wa,{category:S,path:j}),expandIcon:e.jsx(ks,{}),children:w(S.id)},S.id));return e.jsxs("div",{className:"sidebar-container",children:[e.jsxs(ee,{hasCollapseButton:!1,selectedKeys:b,children:[e.jsxs("div",{className:"menu-header",children:[e.jsx(bs,{className:"avatar",size:32,children:e.jsx(vs,{style:{color:"var(--color-bg-1)"}})}),e.jsx(_.Title,{heading:6,style:{margin:0},children:"ReactFlux"})]}),e.jsx(_.Title,{className:"section-title",heading:6,style:{paddingLeft:"12px"},children:c.t("sidebar.articles")}),e.jsx(Fe,{loading:!n,animation:!0,text:{rows:3}}),n&&T(),e.jsx(_.Title,{className:"section-title",heading:6,style:{paddingLeft:"12px"},children:c.t("sidebar.feeds")})]}),e.jsx("div",{className:"feeds-menu-wrapper",children:e.jsx(Ge,{style:{maxHeight:"100%"},autoHide:!0,children:e.jsxs(ee,{autoScrollIntoView:!0,hasCollapseButton:!1,selectedKeys:b,children:[e.jsx(Fe,{loading:!n,animation:!0,text:{rows:6}}),n&&e.jsx(mt,{triggerRegion:"icon",bordered:!1,children:M()})]})})})]})},Ca=()=>{const{showAllFeeds:t,theme:s}=p(I),{polyglot:r}=p(V),a=[{label:r.t("header.theme_option_light"),value:"light"},{label:r.t("header.theme_option_dark"),value:"dark"},{label:r.t("header.theme_option_system"),value:"system"}],n=oe(),l=Ke().pathname,{setAddFeedModalVisible:o,setSettingsModalVisible:i}=tt(),{isBelowLarge:u}=xe(),[d,c]=g.useState(!1),[h,x]=g.useState(!1),[b,m]=g.useState(!1);g.useEffect(()=>{u||c(!1)},[u]),g.useEffect(()=>{l&&c(!1)},[l]);const j=()=>{B({showAllFeeds:!t})},T=()=>{B({theme:s==="light"?"dark":"light"})},w=()=>{Ir(),x(!1)},M=()=>{Lr(),_a(),da(),n("/login"),v.success(r.t("header.logout_success"))},S=()=>s==="dark"?e.jsx(Rs,{}):s==="system"?e.jsx(Ps,{}):e.jsx(Ds,{});return e.jsxs("div",{className:"header",children:[e.jsx("div",{className:"brand",children:e.jsx(F,{className:"trigger",onClick:()=>c(!d),shape:"circle",size:"small",children:e.jsx(Ts,{})})}),e.jsx(Is,{className:"sidebar-drawer",visible:d,title:null,footer:null,closable:!1,onCancel:()=>c(!1),placement:"left",width:240,children:e.jsx(as,{})}),e.jsx("div",{className:"button-group",children:e.jsxs(Ee,{size:16,children:[e.jsx(de,{content:r.t("header.add_feed"),mini:!0,children:e.jsx(F,{shape:"circle",size:"small",type:"primary",icon:e.jsx(At,{}),onClick:()=>o(!0)})}),e.jsx(de,{content:t?r.t("header.hide_some_feeds"):r.t("header.show_all_feeds"),mini:!0,children:e.jsx(F,{shape:"circle",size:"small",icon:t?e.jsx(Fs,{}):e.jsx(Es,{}),onClick:j})}),e.jsx(F,{shape:"circle",size:"small",icon:e.jsx(As,{}),onClick:()=>window.open("https://github.com/electh/ReactFlux","_blank")}),e.jsx(pt,{droplist:e.jsx(ee,{defaultSelectedKeys:[s],className:"theme-menu",children:a.map(({label:$,value:D})=>e.jsxs(ee.Item,{className:"theme-menu-item",onClick:()=>B({theme:D}),children:[$,s===D&&e.jsx(Nt,{style:{marginLeft:8}})]},D))}),children:e.jsx(F,{icon:S(),shape:"circle",size:"small",onClick:T})}),e.jsx(pt,{droplist:e.jsxs(ee,{children:[e.jsxs(ee.Item,{onClick:()=>i(!0),children:[e.jsx(Ns,{className:"icon-right"}),r.t("header.settings")]},"0"),e.jsxs(ee.Item,{onClick:()=>x(!0),children:[e.jsx(Ae,{className:"icon-right"}),r.t("header.reset_settings")]},"1"),e.jsxs(ee.Item,{onClick:()=>m(!0),children:[e.jsx(Ls,{className:"icon-right"}),r.t("header.logout")]},"2")]}),trigger:"click",children:e.jsx(F,{icon:e.jsx(Lt,{}),shape:"circle",size:"small"})})]})}),e.jsx(re,{title:r.t("header.settings_reset_confirm"),visible:h,onOk:w,onCancel:()=>x(!1),children:e.jsx("p",{children:r.t("header.settings_reset_description")})}),e.jsx(re,{title:r.t("header.logout_confirm"),visible:b,onOk:M,onCancel:()=>m(!1),children:e.jsx("p",{children:r.t("header.logout_description")})})]})},ka=(t,s)=>{const r=t.split("."),a=s.split(".");for(let n=0;n<Math.max(r.length,a.length);n++){const l=r[n]||"0",o=a[n]||"0",i=l.localeCompare(o,void 0,{numeric:!0});if(i!==0)return i}return 0},it=()=>{const t=g.useRef(!1);return{fetchAppData:async()=>{if(!t.current){t.current=!0,bt(!1);try{const r=await Promise.all([Qr(),Te(0,"unread"),Wt(),Xr(),Dr(),na()]),[a,n,l,o,i,u]=r,d=o.reduce((h,x)=>(h[x.id]=a.unreads[x.id]??0,h),{}),c=Object.values(a.reads).reduce((h,x)=>h+x,0);at(d),nt(n.total??0),Pe(l.total??0),Re(c),ae(o),Ie(i),ca(ka(u.version,"2.2.0")>=0),bt(!0)}catch(r){console.error("Error fetching app data: ",r)}finally{t.current=!1}}}}},qe={Red:{light:"#F53F3F",dark:"#F76965"},Orange:{light:"#F77234",dark:"#F9925A"},Gold:{light:"#F7BA1E",dark:"#F9CC44"},Green:{light:"#00B42A",dark:"#27C346"},Cyan:{light:"#14C9C9",dark:"#3FD4CF"},Blue:{light:"#165DFF",dark:"#3C7EFF"},Purple:{light:"#722ED1",dark:"#8E51DA"},Magenta:{light:"#F5319D",dark:"#F756A9"}},We=t=>{const s=qe[t]||qe.Blue,r=window.matchMedia("(prefers-color-scheme: dark)").matches,a=U("theme");return(a==="system"?r:a==="dark")?s.dark:s.light},ns=t=>{Ms(We(t),{list:!0}).map(Vs).forEach((r,a)=>{document.body.style.setProperty(`--primary-${a+1}`,r)})},Ta=()=>{const{articleWidth:t,fontSize:s,fontFamily:r,layout:a,showDetailedRelativeTime:n,showFeedIcon:l,themeColor:o}=p(I),{polyglot:i}=p(V),u=[{label:i.t("appearance.font_family_system"),value:"system-ui"},{label:"Sans-serif",value:"sans-serif"},{label:"Serif",value:"serif"},{label:"Fira Sans",value:"'Fira Sans', sans-serif"},{label:"Open Sans",value:"'Open Sans', sans-serif"},{label:"Source Sans Pro",value:"'Source Sans Pro', sans-serif"},{label:"Source Serif Pro",value:"'Source Serif Pro', serif"},{label:i.t("appearance.font_family_noto_sans"),value:"'Noto Sans SC', sans-serif"},{label:i.t("appearance.font_family_noto_serif"),value:"'Noto Serif SC', serif"},{label:i.t("appearance.font_family_lxgw_wenkai"),value:"'LXGW WenKai Screen', sans-serif"}],d=c=>{B(c),c.themeColor&&ns(c.themeColor)};return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"setting-row",children:[e.jsxs("div",{children:[e.jsx(_.Title,{heading:6,style:{marginTop:0},children:i.t("appearance.theme_color_label")}),e.jsx(_.Text,{type:"secondary",children:i.t("appearance.theme_color_description")})]}),e.jsx("div",{style:{display:"flex"},children:Object.keys(qe).map(c=>e.jsx("div",{style:{width:"18px",height:"18px",borderRadius:"50%",margin:"2px",backgroundColor:We(c),cursor:"pointer",border:"3px solid var(--color-bg-3)",outline:c===o?`1px solid ${We(c)}`:"none"},onClick:()=>d({themeColor:c}),onKeyDown:h=>{(h.key==="Enter"||h.key===" ")&&d({themeColor:c})},"aria-label":i.t("appearance.theme_color_aria_label",{color:c})},c))})]}),e.jsx(H,{}),e.jsxs("div",{className:"setting-row",children:[e.jsxs("div",{children:[e.jsx(_.Title,{heading:6,style:{marginTop:0},children:i.t("appearance.compact_article_list_label")}),e.jsx(_.Text,{type:"secondary",children:i.t("appearance.compact_article_list_description")})]}),e.jsx("div",{children:e.jsx(Y,{checked:a==="small",onChange:c=>d({layout:c?"small":"large"})})})]}),e.jsx(H,{}),e.jsxs("div",{className:"setting-row",children:[e.jsxs("div",{children:[e.jsx(_.Title,{heading:6,style:{marginTop:0},children:i.t("appearance.show_detailed_relative_time_label")}),e.jsx(_.Text,{type:"secondary",children:i.t("appearance.show_detailed_relative_time_description")})]}),e.jsx("div",{children:e.jsx(Y,{checked:n,onChange:c=>d({showDetailedRelativeTime:c})})})]}),e.jsx(H,{}),e.jsxs("div",{className:"setting-row",children:[e.jsxs("div",{children:[e.jsx(_.Title,{heading:6,style:{marginTop:0},children:i.t("appearance.show_feed_icon_label")}),e.jsx(_.Text,{type:"secondary",children:i.t("appearance.show_feed_icon_description")})]}),e.jsx("div",{children:e.jsx(Y,{checked:l,onChange:c=>d({showFeedIcon:c})})})]}),e.jsx(H,{}),e.jsxs("div",{className:"setting-row",children:[e.jsxs("div",{children:[e.jsx(_.Title,{heading:6,style:{marginTop:0},children:i.t("appearance.font_family_label")}),e.jsx(_.Text,{type:"secondary",children:i.t("appearance.font_family_description")})]}),e.jsx("div",{children:e.jsx(R,{style:{width:166},value:r,onChange:c=>d({fontFamily:c}),children:u.map(({label:c,value:h})=>e.jsx(R.Option,{value:h,children:c},h))})})]}),e.jsx(H,{}),e.jsxs("div",{className:"setting-row",children:[e.jsxs("div",{children:[e.jsx(_.Title,{heading:6,style:{marginTop:0},children:i.t("appearance.font_size_label")}),e.jsx(_.Text,{type:"secondary",children:i.t("appearance.font_size_description")})]}),e.jsx("div",{children:e.jsxs(Ee,{children:[e.jsx(_.Text,{style:{fontSize:"0.75rem"},children:"A"}),e.jsx(gt,{formatTooltip:c=>`${c}rem`,max:1.25,min:.75,showTicks:!0,step:.05,style:{width:200},value:s,onChange:c=>d({fontSize:c})}),e.jsx(_.Text,{style:{fontSize:"1.25rem"},children:"A"})]})})]}),e.jsx(H,{}),e.jsxs("div",{className:"setting-row",children:[e.jsxs("div",{children:[e.jsx(_.Title,{heading:6,style:{marginTop:0},children:i.t("appearance.article_width_label")}),e.jsx(_.Text,{type:"secondary",children:i.t("appearance.article_width_description")})]}),e.jsx("div",{children:e.jsxs(Ee,{children:[e.jsx(_.Text,{children:"60%"}),e.jsx(gt,{formatTooltip:c=>`${c}%`,max:90,min:60,showTicks:!0,step:10,style:{width:160},value:t,onChange:c=>d({articleWidth:c})}),e.jsx(_.Text,{children:"90%"})]})})]})]})},Ia=()=>{const t=p(ye),{polyglot:s}=p(V),[r]=P.useForm(),[a,n]=g.useState(!1),[l,o]=g.useState(""),[i,u]=g.useState({}),[d,c]=g.useState(!1),h=async()=>{if(l.trim()){try{const m=await Mr(l);Ie(j=>[...j,{...m}]),v.success(s.t("category_list.add_category_success"))}catch(m){console.error(`${s.t("category_list.add_category_error")}: `,m),v.error(s.t("category_list.add_category_error"))}o(""),c(!1)}},x=async(m,j,T)=>{try{const w=await Or(m,j,T);ae(M=>M.map(S=>S.category.id===m?{...S,category:{...S.category,title:j,hide_globally:T}}:S)),Ie(M=>M.map(S=>S.id===m?{...S,...w}:S)),v.success(s.t("category_list.update_category_success"))}catch{v.error(s.t("category_list.update_category_error"))}n(!1),r.resetFields()},b=async m=>{try{(await Vr(m.id)).status===204?(Ie(T=>T.filter(w=>w.id!==m.id)),v.success(s.t("category_list.remove_category_success",{title:m.title}))):v.error(s.t("category_list.remove_category_error",{title:m.title}))}catch(j){console.error(s.t("category_list.remove_category_error",{title:m.title}),j),v.error(s.t("category_list.remove_category_error",{title:m.title}))}};return e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[t.map(m=>e.jsx(ge,{className:"tag-style",closable:m.feedCount===0,size:"medium",onClick:()=>{u(m),n(!0),r.setFieldsValue({title:m.title})},onClose:async j=>{j.stopPropagation(),await b(m)},children:m.title},m.id)),d?e.jsx(q,{autoFocus:!0,className:"input-style",onBlur:h,onChange:o,onPressEnter:h,size:"small",value:l}):e.jsx(ge,{className:"add-category-tag",icon:e.jsx(At,{}),onClick:()=>c(!0),size:"medium",tabIndex:0})]}),i&&e.jsx(re,{className:"modal-style",onOk:r.submit,title:"Edit Category",unmountOnExit:!0,visible:a,onCancel:()=>{n(!1),r.resetFields()},children:e.jsxs(P,{form:r,layout:"vertical",onSubmit:m=>x(i.id,m.title,m.hidden),labelCol:{style:{flexBasis:90}},wrapperCol:{style:{flexBasis:"calc(100% - 90px)"}},children:[e.jsx(P.Item,{label:"Title",field:"title",rules:[{required:!0}],children:e.jsx(q,{placeholder:"Please input category title"})}),e.jsx(P.Item,{label:"Hidden",field:"hidden",initialValue:i.hide_globally,triggerPropName:"checked",rules:[{type:"boolean"}],children:e.jsx(Y,{})})]})})]})},Fa=t=>new Promise(s=>setTimeout(s,t)),Ea=(t,s,r=!1)=>{let a;return function(...n){const l=()=>{a=null,r||t.apply(this,n)},o=r&&!a;clearTimeout(a),a=setTimeout(l,s),o&&t.apply(this,n)}},os=Xe(""),Ct=E(os),lt=Xe("title"),Aa=E(lt),is=W([O,os,lt],(t,s,r)=>{const{feedsData:a}=t,n=[...a].sort((l,o)=>l.disabled&&!o.disabled?1:!l.disabled&&o.disabled?-1:0).sort((l,o)=>o.parsing_error_count-l.parsing_error_count);return s?Jt(n,s,[r]):n}),Na=W(is,t=>t.map(s=>({category:s.category,checked_at:s.checked_at,crawler:s.crawler,disabled:s.disabled,feed_url:s.feed_url,hidden:s.hide_globally,key:s.id,parsing_error_count:s.parsing_error_count,site_url:s.site_url,title:s.title}))),kt=(t,s,r=null)=>r===null||r===t.id?{...t,parsing_error_count:s?0:t.parsing_error_count+1,checked_at:Br()}:t,La=()=>{const t=p(ye),{isAppDataReady:s}=p(O),{showDetailedRelativeTime:r}=p(I),a=p(is),n=p(lt),l=p(Na),{polyglot:o}=p(V),i=o.t("search.tooltip").split(`
`),[u,d]=g.useState(!1),[c]=P.useForm(),[h,x]=g.useState(!1),[b,m]=g.useState(""),[j,T]=g.useState(null),{isBelowMedium:w}=xe();g.useEffect(()=>{Ct("")},[]);const M=f=>{T(f),x(!0),c.setFieldsValue({category:f.category.id,title:f.title,siteUrl:f.site_url,feedUrl:f.feed_url,hidden:f.hidden,disabled:f.disabled,crawler:f.crawler})},S=async(f,y,k=!0)=>{try{const L=(await f()).status===204;return k&&(L?v.success(o.t("feed_table.refresh_success")):v.error(o.t("feed_table.refresh_error"))),ae(Z=>Z.map(ie=>y(ie,L))),L}catch{return k&&v.error(o.t("feed_table.refresh_error")),ae(L=>L.map(Z=>y(Z,!1))),!1}},$=async(f,y=!0)=>{const k=f.id||f.key;return S(()=>Jr(k),(N,L)=>kt(N,L,k),y)},D=async()=>{try{const f=await Promise.all(a.map(async y=>{const k=new URL(y.feed_url).hostname;if(k===b)return y;const N=y.feed_url.replace(k,b),L=await jt(y.id,{feedUrl:N});return{...y,...L}}));ae(y=>y.map(k=>f.find(N=>N.id===k.id)||k)),v.success(o.t("feed_table.bulk_update_success")),d(!1)}catch{v.error(o.t("feed_table.bulk_update_error"))}},K=()=>{const[f,y]=g.useState(!1),k=async()=>{y(!1),await S(Zr,kt)},N=async()=>{y(!1);const Z=a.filter(me=>me.parsing_error_count>0);v.success(o.t("feed_table.bulk_refresh_error_feeds_message"));let ie=0,be=0;for(const me of Z)await $(me,!1)?ie++:be++,await Fa(500);v.success(o.t("feed_table.bulk_refresh_error_feeds_result",{success:ie,failure:be}))},L=()=>y(!1);return e.jsxs(e.Fragment,{children:[e.jsx(F,{icon:e.jsx(Ae,{}),shape:"circle",size:"small",onClick:()=>y(!0)}),e.jsx(re,{className:"edit-modal",onCancel:L,title:o.t("feed_table.refresh_feeds_title"),visible:f,footer:[e.jsx(F,{onClick:L,children:o.t("feed_table.refresh_feeds_cancel")},"cancel"),e.jsx(F,{type:"outline",onClick:N,children:o.t("feed_table.refresh_feeds_error")},"error"),e.jsx(F,{type:"primary",onClick:k,children:o.t("feed_table.refresh_feeds_all")},"all")],children:e.jsx("p",{children:o.t("feed_table.refresh_feeds_description")})})]})},Q=async f=>{try{(await ta(f.key)).status===204?(ae(k=>k.filter(N=>N.id!==f.key)),v.success(o.t("feed_table.remove_feed_success",{title:f.title}))):v.error(o.t("feed_table.remove_feed_error",{title:f.title}))}catch(y){console.error(`Failed to unfollow feed: ${f.title}`,y),v.error(o.t("feed_table.remove_feed_error",{title:f.title}))}},te=[{title:o.t("feed_table.table_title"),dataIndex:"title",sorter:(f,y)=>f.title.localeCompare(y.title,"en"),render:(f,y)=>{const k=y.parsing_error_count;let N=y.disabled?`🚫 ${f}`:f;k>0&&(N=`⚠️ ${f}`);const L=e.jsxs("div",{children:[f,k>0&&e.jsxs(e.Fragment,{children:[e.jsx("br",{}),"⚠️ Parsing error count: ",k]})]});return e.jsx(_.Ellipsis,{expandable:!1,children:e.jsx(de,{mini:!0,content:L,children:N})})}},!w&&{title:o.t("feed_table.table_url"),dataIndex:"feed_url",sorter:(f,y)=>f.feed_url.localeCompare(y.feed_url,"en"),render:f=>e.jsx(_.Ellipsis,{expandable:!1,showTooltip:!0,children:f})},{title:o.t("feed_table.table_category"),dataIndex:"category.title",sorter:(f,y)=>f.category.title.localeCompare(y.category.title,"en"),render:f=>e.jsx(_.Ellipsis,{expandable:!1,showTooltip:!0,children:e.jsx(ge,{children:f})})},!w&&{title:o.t("feed_table.table_checked_at"),dataIndex:"checked_at",sorter:(f,y)=>f.checked_at.localeCompare(y.checked_at,"en"),render:f=>e.jsx(_.Ellipsis,{expandable:!1,children:Ht(f,r)})},{title:o.t("feed_table.table_actions"),dataIndex:"op",fixed:"right",width:100,render:(f,y)=>e.jsxs(Ee,{children:[e.jsx("button",{"aria-label":o.t("feed_table.table_feed_edit_label"),className:"list-item-action",onClick:()=>M(y),type:"button",children:e.jsx(xt,{})}),e.jsx("button",{"aria-label":o.t("feed_table.table_feed_refresh_label"),className:"list-item-action",onClick:()=>$(y),type:"button",children:e.jsx(Ae,{})}),e.jsx(Rt,{focusLock:!0,position:"left",title:o.t("feed_table.table_feed_remove_confirm"),onOk:()=>Q(y),children:e.jsx("span",{className:"list-item-action",children:e.jsx(Os,{})})})]})}].filter(Boolean),J=async(f,y)=>{try{const k=await jt(f,y);ae(N=>N.map(L=>L.id===f?{...L,...k}:L)),v.success(o.t("feed_table.update_feed_success")),x(!1),c.resetFields()}catch{v.error(o.t("feed_table.update_feed_error"))}};return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"feed-table-action-bar",children:[e.jsx("div",{style:{display:"flex",flex:1,justifyContent:"center",minWidth:0},children:e.jsx(q.Search,{allowClear:!0,className:"search-input",onChange:Ct,placeholder:o.t("search.placeholder"),addBefore:e.jsxs(R,{onChange:Aa,style:{width:126},value:n,children:[e.jsx(R.Option,{value:"title",children:o.t("search.type_title")}),e.jsx(R.Option,{value:"feed_url",children:o.t("search.type_feed_url")}),e.jsx(R.Option,{value:"site_url",children:o.t("search.type_site_url")})]})})}),e.jsxs("div",{className:"button-group",children:[e.jsx(de,{mini:!0,position:"bottom",content:e.jsx("div",{children:i.map((f,y)=>e.jsxs(g.Fragment,{children:[f,y<i.length-1&&e.jsx("br",{})]},`line-${y}-${f.length}`))}),children:e.jsx(F,{shape:"circle",size:"small",icon:e.jsx(Pt,{})})}),e.jsx(F,{icon:e.jsx(xt,{}),shape:"circle",size:"small",onClick:()=>d(!0)}),e.jsxs(re,{className:"edit-modal",onOk:D,title:o.t("feed_table.modal_bulk_update_title"),visible:u,onCancel:()=>{d(!1),m("")},children:[e.jsx("p",{children:o.t("feed_table.modal_bulk_update_description")}),e.jsx(q,{placeholder:"rsshub.app",value:b,onChange:f=>m(f)})]}),e.jsx(K,{})]})]}),e.jsx(Dt,{borderCell:!0,className:"feed-table",columns:te,data:l,loading:!s,pagePosition:"bottomCenter",scroll:{x:!0},size:"small"}),j&&e.jsx(re,{className:"edit-modal",onOk:c.submit,title:o.t("feed_table.modal_edit_feed_title"),unmountOnExit:!0,visible:h,onCancel:()=>{x(!1),c.resetFields()},children:e.jsxs(P,{form:c,labelCol:{span:7},layout:"vertical",wrapperCol:{span:17},onSubmit:async f=>{const y={categoryId:f.category,title:f.title,siteUrl:f.siteUrl.trim(),feedUrl:f.feedUrl.trim(),hidden:f.hidden,disabled:f.disabled,isFullText:f.crawler};y.feedUrl?await J(j.key,y):v.error(o.t("feed_table.modal_edit_feed_submit_error"))},children:[e.jsx(P.Item,{label:o.t("feed_table.modal_edit_feed_category_label"),required:!0,field:"category",rules:[{required:!0}],children:e.jsx(R,{children:t.map(f=>e.jsx(R.Option,{value:f.id,children:f.title},f.id))})}),e.jsx(P.Item,{label:o.t("feed_table.modal_edit_feed_title_label"),field:"title",rules:[{required:!0}],children:e.jsx(q,{placeholder:o.t("feed_table.modal_edit_feed_title_placeholder")})}),e.jsx(P.Item,{label:o.t("feed_table.modal_edit_feed_site_url_label"),field:"siteUrl",rules:[{required:!0}],children:e.jsx(q,{placeholder:o.t("feed_table.modal_edit_feed_site_url_placeholder")})}),e.jsx(P.Item,{label:o.t("feed_table.modal_edit_feed_feed_url_label"),field:"feedUrl",rules:[{required:!0}],children:e.jsx(q,{placeholder:o.t("feed_table.modal_edit_feed_feed_url_placeholder")})}),e.jsx(P.Item,{label:o.t("feed_table.modal_edit_feed_hidden_label"),field:"hidden",initialValue:j.hidden,triggerPropName:"checked",rules:[{type:"boolean"}],children:e.jsx(Y,{})}),e.jsx(P.Item,{label:o.t("feed_table.modal_edit_feed_disabled_label"),field:"disabled",initialValue:j.disabled,triggerPropName:"checked",rules:[{type:"boolean"}],children:e.jsx(Y,{})}),e.jsx(P.Item,{label:o.t("feed_table.modal_edit_feed_crawler_label"),field:"crawler",tooltip:e.jsx("div",{children:o.t("feed_table.modal_edit_feed_crawler_tooltip")}),triggerPropName:"checked",rules:[{type:"boolean"}],children:e.jsx(Y,{})})]})})]})},Ra=[{label:"English",value:"en-US"},{label:"Español",value:"es-ES"},{label:"简体中文",value:"zh-CN"}],Pa=()=>{const{homePage:t,language:s,markReadOnScroll:r,orderBy:a,pageSize:n,removeDuplicates:l,showUnreadFeedsOnly:o}=p(I),{polyglot:i}=p(V),u=[{label:i.t("settings.default_home_page_option_all"),value:"all"},{label:i.t("settings.default_home_page_option_today"),value:"today"},{label:i.t("settings.default_home_page_option_starred"),value:"starred"},{label:i.t("settings.default_home_page_option_history"),value:"history"}],d=[{label:i.t("settings.remove_duplicates_option_none"),value:"none"},{label:i.t("settings.remove_duplicates_option_hash"),value:"hash"},{label:i.t("settings.remove_duplicates_option_title"),value:"title"},{label:i.t("settings.remove_duplicates_option_url"),value:"url"}];return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"setting-row",children:[e.jsxs("div",{children:[e.jsx(_.Title,{heading:6,style:{marginTop:0},children:i.t("appearance.language_label")}),e.jsx(_.Text,{type:"secondary",children:i.t("appearance.language_description")})]}),e.jsx("div",{children:e.jsx(R,{className:"input-select",onChange:c=>B({language:c}),value:s,children:Ra.map(({label:c,value:h})=>e.jsx(R.Option,{value:h,children:c},h))})})]}),e.jsx(H,{}),e.jsxs("div",{className:"setting-row",children:[e.jsxs("div",{children:[e.jsx(_.Title,{heading:6,style:{marginTop:0},children:i.t("settings.default_home_page_label")}),e.jsx(_.Text,{type:"secondary",children:i.t("settings.default_home_page_description")})]}),e.jsx("div",{children:e.jsx(R,{className:"input-select",onChange:c=>B({homePage:c}),value:t,children:u.map(({label:c,value:h})=>e.jsx(R.Option,{value:h,children:c},h))})})]}),e.jsx(H,{}),e.jsxs("div",{className:"setting-row",children:[e.jsxs("div",{children:[e.jsx(_.Title,{heading:6,style:{marginTop:0},children:i.t("settings.show_unread_feeds_only_label")}),e.jsx(_.Text,{type:"secondary",children:i.t("settings.show_unread_feeds_only_description")})]}),e.jsx("div",{children:e.jsx(Y,{checked:o,onChange:c=>B({showUnreadFeedsOnly:c})})})]}),e.jsx(H,{}),e.jsxs("div",{className:"setting-row",children:[e.jsxs("div",{children:[e.jsx(_.Title,{heading:6,style:{marginTop:0},children:i.t("settings.entries_order_label")}),e.jsx(_.Text,{type:"secondary",children:i.t("settings.entries_order_description")})]}),e.jsx("div",{children:e.jsxs(R,{className:"input-select",onChange:c=>B({orderBy:c}),value:a,children:[e.jsx(R.Option,{value:"published_at",children:i.t("settings.entries_order_option_published_at")}),e.jsx(R.Option,{value:"created_at",children:i.t("settings.entries_order_option_created_at")})]})})]}),e.jsx(H,{}),e.jsxs("div",{className:"setting-row",children:[e.jsxs("div",{children:[e.jsx(_.Title,{heading:6,style:{marginTop:0},children:i.t("settings.entries_per_page_label")}),e.jsx(_.Text,{type:"secondary",children:i.t("settings.entries_per_page_description")})]}),e.jsx("div",{children:e.jsx(zs,{className:"input-select",defaultValue:n,min:1,mode:"button",onChange:c=>B({pageSize:c}),size:"small"})})]}),e.jsx(H,{}),e.jsxs("div",{className:"setting-row",children:[e.jsxs("div",{children:[e.jsx(_.Title,{heading:6,style:{marginTop:0},children:i.t("settings.remove_duplicates_label")}),e.jsx(_.Text,{type:"secondary",children:i.t("settings.remove_duplicates_description")})]}),e.jsx("div",{children:e.jsx(R,{className:"input-select",onChange:c=>B({removeDuplicates:c}),value:l,children:d.map(({label:c,value:h})=>e.jsx(R.Option,{value:h,children:c},h))})})]}),e.jsx(H,{}),e.jsxs("div",{className:"setting-row",children:[e.jsxs("div",{children:[e.jsx(_.Title,{heading:6,style:{marginTop:0},children:i.t("settings.mark_read_on_scroll_label")}),e.jsx(_.Text,{type:"secondary",children:i.t("settings.mark_read_on_scroll_description")})]}),e.jsx("div",{children:e.jsx(Y,{checked:r,onChange:c=>B({markReadOnScroll:c})})})]})]})},Da=()=>{const{polyglot:t}=p(V),s=[{title:t.t("hotkeys.key"),dataIndex:"keyName",render:a=>e.jsx(ge,{children:a})},{title:t.t("hotkeys.function"),dataIndex:"description"}],r=[{key:"1",keyName:"Esc",description:t.t("hotkeys.esc")},{key:"2",keyName:"←",description:t.t("hotkeys.left")},{key:"3",keyName:"Ctrl + ←",description:t.t("hotkeys.ctrl_left")},{key:"4",keyName:"→",description:t.t("hotkeys.right")},{key:"5",keyName:"Ctrl + →",description:t.t("hotkeys.ctrl_right")},{key:"6",keyName:"A",description:t.t("hotkeys.a")},{key:"7",keyName:"B",description:t.t("hotkeys.b")},{key:"8",keyName:"D",description:t.t("hotkeys.d")},{key:"9",keyName:"M",description:t.t("hotkeys.m")},{key:"10",keyName:"S",description:t.t("hotkeys.s")},{key:"11",keyName:"V",description:t.t("hotkeys.v")}];return e.jsx(Dt,{borderCell:!0,columns:s,data:r,pagination:!1,size:"small",style:{margin:"0 auto",width:"90%"}})},Ma=()=>{const{polyglot:t}=p(V),s=(r,a)=>e.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center"},children:[r,e.jsx("div",{style:{fontSize:"12px"},children:a})]});return e.jsxs(ce,{className:"custom-tabs",defaultActiveTab:"1",tabPosition:"top",animation:!0,children:[e.jsx(ce.TabPane,{title:s(e.jsx(Us,{style:{fontSize:"20px"}}),t.t("settings.feeds")),children:e.jsx(La,{})},"1"),e.jsx(ce.TabPane,{title:s(e.jsx($s,{style:{fontSize:"20px"}}),t.t("settings.categories")),children:e.jsx(Ia,{})},"2"),e.jsx(ce.TabPane,{title:s(e.jsx(Bs,{style:{fontSize:"20px"}}),t.t("settings.general")),children:e.jsx(Pa,{})},"3"),e.jsx(ce.TabPane,{title:s(e.jsx(Hs,{style:{fontSize:"20px"}}),t.t("settings.appearance")),children:e.jsx(Ta,{})},"4"),e.jsx(ce.TabPane,{title:s(e.jsx(qs,{style:{fontSize:"20px"}}),t.t("settings.hotkeys")),children:e.jsx(Da,{})},"5")]})},Va=[{required:!0}],Oa=[{required:!0}],za=[{type:"boolean"}],Ua=()=>{const{setSettingsModalVisible:t,settingsModalVisible:s}=tt();return e.jsx(re,{alignCenter:!1,autoFocus:!1,className:"settings-modal",focusLock:!0,footer:null,onCancel:()=>t(!1),title:null,unmountOnExit:!0,visible:s,children:e.jsx(Ma,{})})},$a=()=>{const t=p(ye),{polyglot:s}=p(V),{addFeedModalVisible:r,setAddFeedModalVisible:a}=tt(),[n,l]=g.useState(!1),[o]=P.useForm(),{fetchAppData:i}=it(),u=async(d,c,h)=>{l(!0);try{await ea(d,c,h),await i(),v.success(s.t("main.add_feed_success")),a(!1),o.resetFields()}catch{v.error(s.t("main.add_feed_error"))}finally{l(!1)}};return e.jsx(re,{title:s.t("main.add_feed_modal_title"),visible:r,unmountOnExit:!0,style:{width:"400px"},onOk:o.submit,confirmLoading:n,onCancel:()=>{a(!1),o.resetFields()},children:e.jsxs(P,{form:o,labelCol:{span:7},layout:"vertical",wrapperCol:{span:17},onSubmit:async d=>{const c=d.url.trim();c?await u(c,d.category,d.crawler):v.error(s.t("main.add_feed_url_empty"))},children:[e.jsx(P.Item,{label:s.t("main.add_feed_modal_feed_url_label"),field:"url",rules:Va,children:e.jsx(q,{placeholder:s.t("main.add_feed_modal_feed_url_placeholder")})}),e.jsx(P.Item,{field:"category",label:s.t("main.add_feed_modal_category_label"),required:!0,rules:Oa,children:e.jsx(R,{placeholder:s.t("main.add_feed_modal_category_placeholder"),showSearch:!0,filterOption:(d,c)=>pa(c.props.children,d),children:t.map(d=>e.jsx(R.Option,{value:d.id,children:d.title},d.id))})}),e.jsx(P.Item,{field:"crawler",initialValue:!1,label:s.t("main.add_feed_modal_crawler_label"),rules:za,style:{marginBottom:0},triggerPropName:"checked",children:e.jsx(Y,{})})]})})},Ba=()=>e.jsxs("div",{className:"main",children:[e.jsx(Ws,{}),e.jsx(Ua,{}),e.jsx($a,{})]}),ls=()=>{const{theme:t,themeColor:s}=p(I),[r,a]=g.useState(window.matchMedia("(prefers-color-scheme: dark)").matches);g.useEffect(()=>{const n=window.matchMedia("(prefers-color-scheme: dark)"),l=o=>a(o.matches);return n.addEventListener("change",l),()=>n.removeEventListener("change",l)},[]),g.useEffect(()=>{const n=l=>{const o=l?"dark":"light";document.body.setAttribute("arco-theme",o),document.body.style.colorScheme=o};ns(s),n(t==="system"?r:t==="dark")},[r,t,s])},ct=()=>{const t=document.querySelector(".spinner");t&&(t.style.display="none")},Ha=()=>{Ut(),ls();const{isBelowLarge:t}=xe(),{polyglot:s}=p(V);return g.useEffect(()=>{ct()},[]),s&&e.jsxs("div",{className:"app",children:[t?null:e.jsx(Ks.Sider,{breakpoint:"lg",className:"sidebar",collapsible:!1,trigger:null,width:240,children:e.jsx(as,{})}),e.jsx(Ca,{}),e.jsx(Ba,{})]})},cs=t=>{const r=new DOMParser().parseFromString(t,"text/html").querySelectorAll("img");return Array.from(r).map(a=>a.getAttribute("src"))},ds=t=>{var n;const a=(n=new DOMParser().parseFromString(t.content,"text/html").querySelector("img"))==null?void 0:n.getAttribute("src");return{...t,imgSrc:a}},qa=t=>{if((t==null?void 0:t.total)>=0){const s=t.entries.map(ds);je(s),ya(t.total),ts(s.length<t.total)}},Wa=(t,s)=>{const{isAppDataReady:r}=p(O),{showStatus:a}=p(I),n=g.useRef(!1),l=async o=>{if(!n.current){n.current=!0,vt(!1);try{const i=a==="unread"?await o(0,"unread"):await o();switch(t.from){case"feed":a==="unread"&&at(u=>({...u,[Number(t.id)]:i.total}));break;case"history":Re(i.total);break;case"starred":a!=="unread"&&Pe(i.total);break;case"today":a==="unread"&&nt(i.total);break}vt(!0),ne(!0),qa(i)}catch(i){console.error("Error fetching articles: ",i),ne(!1)}finally{n.current=!1}}};return g.useEffect(()=>{r&&l(s)},[r]),{fetchArticleList:l}},us=Xe(!1),Tt=E(us),dt=()=>{const{offset:t}=p(A),{pageSize:s,showStatus:r}=p(I),a=p(us),n=o=>{const i=(u,d)=>d.filter(c=>!u.some(h=>h.id===c.id));je(u=>[...u,...i(u,o)]),Ve(u=>u+s)};return{handleLoadMore:async o=>{var i;Tt(!0);try{const u=r==="unread"?await o(t+s,"unread"):await o(t+s);if(((i=u==null?void 0:u.entries)==null?void 0:i.length)>0){const d=u.entries.map(ds);n(d)}else ts(!1)}catch(u){console.error("Error fetching more articles: ",u)}finally{Tt(!1)}},loadingMore:a}},ut=ue({isPhotoSliderVisible:!1,selectedIndex:0}),Ka=E(ut,"isPhotoSliderVisible"),Ga=E(ut,"selectedIndex"),hs=()=>{const{isPhotoSliderVisible:t,selectedIndex:s}=p(ut);return{isPhotoSliderVisible:t,setIsPhotoSliderVisible:Ka,selectedIndex:s,setSelectedIndex:Ga}},fs=(t,s)=>{const{activeContent:r,loadMoreVisible:a}=p(A),n=p(es),l=p(_e),{isPhotoSliderVisible:o,setIsPhotoSliderVisible:i,setSelectedIndex:u}=hs(),{loadingMore:d}=dt(),[c,h]=g.useState(!1),[x,b]=g.useState(!1);g.useEffect(()=>{x&&!d&&(h(!1),b(!1),S())},[d,x]);const m=()=>{if(s.current){const f=s.current.el.querySelector(".card-custom-selected-style");f&&f.scrollIntoView({behavior:"smooth",block:"nearest"})}},j=f=>(...y)=>{if(r)return f(...y)},T=j(()=>{X(null),s.current&&s.current.contentWrapperEl.focus()}),w=(f,y,k,N)=>{const L=y==="prev"?N.slice(0,f).toReversed():N.slice(f+1);return k?L.find(Z=>Z.status==="unread"):N[f+(y==="prev"?-1:1)]},M=(f=!1)=>{if(n>0){const y=w(n,"prev",f,l);y&&(t(y),setTimeout(()=>m(),200))}},S=(f=!1)=>{if(c)return;if(n===l.length-1&&a){h(!0),b(!0);return}if(n===-1){s.current.contentWrapperEl.scrollTo({top:0});return}const k=w(n,"next",f,l);k&&(t(k),setTimeout(()=>m(),200),b(!1))},$=j(()=>{window.open(r.url,"_blank")}),D=j(f=>{f()}),K=j(f=>{f()}),Q=j(f=>{f()}),te=j(f=>{f()}),J=j(()=>{!cs(r.content).length||o||(u(0),i(!0),ne(!1))});return{exitDetailView:T,fetchOriginalArticle:D,navigateToNextArticle:S,navigateToPreviousArticle:M,openLinkExternally:$,openPhotoSlider:J,saveToThirdPartyServices:K,toggleReadStatus:Q,toggleStarStatus:te}},Ya=({handleEntryClick:t,entryListRef:s})=>{const{activeContent:r}=p(A),a=p(es),n=p(_e),l=a===0,o=a===n.length-1,[i,u]=g.useState(!1),{handleFetchContent:d,handleSaveToThirdPartyServices:c,handleToggleStarred:h,handleToggleStatus:x}=ot(),{exitDetailView:b,navigateToNextArticle:m,navigateToPreviousArticle:j}=fs(t,s),T=r.status==="unread",w=r.starred;return g.useEffect(()=>{u(!1)},[r]),e.jsxs("div",{className:"action-buttons",children:[e.jsxs("div",{className:"left-side",children:[e.jsx(F,{icon:e.jsx(Gs,{}),onClick:()=>b(),shape:"circle"}),e.jsx(F,{icon:e.jsx(Ys,{}),onClick:()=>j(),shape:"circle",disabled:l}),e.jsx(F,{icon:e.jsx(Xs,{}),onClick:()=>m(),shape:"circle",disabled:o})]}),e.jsxs("div",{className:"right-side",children:[e.jsx(F,{icon:T?e.jsx(Mt,{}):e.jsx(Vt,{}),onClick:()=>x(r),shape:"circle"}),e.jsx(F,{icon:w?e.jsx(Qe,{style:{color:"#ffcd00"}}):e.jsx(Ye,{}),onClick:()=>h(r),shape:"circle"}),e.jsx(F,{icon:e.jsx(Qs,{}),onClick:async()=>{await d(),u(!0)},shape:"circle",disabled:i}),e.jsx(F,{icon:e.jsx(Js,{}),onClick:c,shape:"circle"})]})]})},Xa=({url:t,text:s})=>{const[r,a]=g.useState(!1),n=()=>a(!r);return e.jsx(tr,{to:t,style:{color:"inherit",textDecoration:r?"underline":"none"},onMouseEnter:n,onMouseLeave:n,children:s})},It=({node:t,index:s,togglePhotoSlider:r,isLinkWrapper:a=!1})=>{var m;const{fontSize:n}=p(I),[l,o]=g.useState(!1),[i,u]=g.useState(!1),{isBelowMedium:d}=xe();g.useEffect(()=>{const T=(a?t.children[0]:t).attribs.src,w=new Image;w.src=T,w.onload=()=>u(w.width<=100&&w.height<=100)},[t,a]);const c=a?t.children[0]:t,h=()=>e.jsx("img",{...c.attribs,alt:c.attribs.alt??"image",style:i?{display:"inline-block",width:"auto",height:`${n}rem`,margin:0}:{}});if(i)return a?e.jsxs("a",{...t.attribs,children:[h(),(m=t.children[1])==null?void 0:m.data]}):h();const x=()=>o(!0),b=()=>o(!1);return e.jsx("div",{style:{textAlign:"center",position:"relative"},children:e.jsxs("div",{style:{display:"inline-block",position:"relative"},onMouseEnter:x,onMouseLeave:b,children:[a?e.jsx("a",{...t.attribs,children:h()}):h(),e.jsx(F,{icon:e.jsx(sr,{}),shape:"circle",style:{position:"absolute",top:30,right:10,color:"white",backgroundColor:"rgba(0, 0, 0, 0.5)",opacity:d||l?1:0,transition:"opacity 0.3s"},onClick:j=>{j.preventDefault(),r(s)}})]})})},Qa=(t,s)=>({replace:r=>{if(r.type==="tag"&&r.name==="a"&&r.children.length>0){const a=r.children[0];if(a.type==="tag"&&a.name==="img"){const n=t.findIndex(l=>l===a.attribs.src);return e.jsx(It,{node:r,index:n,togglePhotoSlider:s,isLinkWrapper:!0})}}else if(r.type==="tag"&&r.name==="img"){const a=t.findIndex(n=>n===r.attribs.src);return e.jsx(It,{node:r,index:a,togglePhotoSlider:s})}return r}}),Ja=g.forwardRef((t,s)=>{const r=oe(),{activeContent:a}=p(A),{articleWidth:n,fontFamily:l,fontSize:o}=p(I),{isPhotoSliderVisible:i,setIsPhotoSliderVisible:u,selectedIndex:d,setSelectedIndex:c}=hs(),h=()=>{Me("author"),De(a.author)},x=M=>{c(M),u(S=>!S),ne(S=>!S)},b=cs(a.content),m=Qa(b,x),j=Zs(a.content,m),{id:T,title:w}=a.feed.category;return e.jsx("article",{className:"article-content",onBlur:()=>ne(!1),onFocus:()=>ne(!0),ref:s,tabIndex:-1,children:e.jsxs(Ge,{className:"scroll-container",children:[e.jsxs("div",{className:"article-header",style:{width:`${n}%`},children:[e.jsx(_.Title,{className:"article-title",heading:3,children:e.jsx("a",{href:a.url,target:"_blank",rel:"noopener noreferrer",children:a.title})}),e.jsxs("div",{className:"article-meta",children:[e.jsx(_.Text,{children:e.jsx(Xa,{url:`/feed/${a.feed.id}`,text:a.feed.title})}),e.jsx(_.Text,{onClick:h,style:{cursor:"pointer"},children:` - ${a.author}`}),e.jsx(_.Text,{children:e.jsx(ge,{size:"small",style:{marginLeft:"10px",cursor:"pointer"},onClick:()=>r(`/category/${T}`),children:w})})]}),e.jsx(_.Text,{className:"article-date",children:Hr(a.published_at)}),e.jsx("br",{}),e.jsx(_.Text,{className:"article-date",children:qt(a.reading_time)}),e.jsx(H,{})]}),e.jsxs("div",{className:"article-body",style:{fontSize:`${o}rem`,width:`${n}%`,fontFamily:l},children:[j,e.jsx(er,{images:b.map(M=>({src:M,key:M})),loop:!1,visible:i,onClose:()=>{u(!1),ne(!0)},index:d,onIndexChange:c})]},a.id)]})})}),Za=({alt:t,borderRadius:s,height:r,src:a,status:n,width:l})=>{const[o,i]=g.useState(!1),{ref:u}=ze({triggerOnce:!0,onChange:(d,c)=>{if(d&&!o){const h=new Image;h.onload=()=>i(!0),h.onerror=()=>{c.target.style.display="none"},h.src=a}}});return e.jsx("div",{className:"image-container",ref:u,children:e.jsx("div",{className:"img-placeholder",style:{width:"100%",height:"100%",backgroundColor:"var(--color-fill-2)",position:"absolute",left:0,top:0},children:o?e.jsx("img",{className:n==="unread"?"":"read",src:a,alt:t,style:{width:l,height:r,objectFit:"cover",borderRadius:s}}):e.jsx("div",{className:"skeleton-container",children:e.jsx(Fe,{text:{rows:0},image:{style:{width:l,height:r,margin:"0",borderRadius:s}},animation:!0})})})})},en=({entry:t,isThumbnail:s})=>{if(!t.imgSrc)return null;const r=s?{width:"80px",height:"80px"}:{width:"100%",height:"160px"};return e.jsx("div",{className:s?"thumbnail":"cover-image",children:e.jsx(Za,{alt:t.id,borderRadius:s?"2px":void 0,src:t.imgSrc,status:t.status,width:r.width,height:r.height})})},tn=({entry:t,showFeedIcon:s,mini:r,children:a})=>{const{showDetailedRelativeTime:n}=p(I),l=Oe({"article-card-mini-content":r,"article-card-mini-content-padding":r&&s});return e.jsxs("div",{className:l,style:{width:"100%",boxSizing:"border-box",opacity:t.status==="unread"?1:.5},children:[e.jsx("div",{style:{padding:t.imgSrc?r?"0 10px 0 0":"0 0 10px 0":"0"},children:e.jsx(en,{entry:t,isThumbnail:r})}),e.jsxs("div",{className:r?"article-card-mini-content-text":"",children:[e.jsx(_.Text,{className:"article-card-title",children:t.title}),e.jsxs(_.Text,{className:"article-card-info",children:[e.jsx("br",{}),s&&e.jsx(ss,{feed:t.feed,className:r?"feed-icon-mini":"feed-icon"}),t.feed.title,e.jsx("br",{}),Ht(t.published_at,n),e.jsx("br",{}),qt(t.reading_time)]}),t.starred&&e.jsx(Qe,{className:"icon-starred"})]}),e.jsx("div",{children:a})]})},sn=({entry:t,handleEntryClick:s,mini:r,children:a})=>{const{markReadOnScroll:n,showFeedIcon:l}=p(I),{activeContent:o}=p(A),{polyglot:i}=p(V),u=o&&t.id===o.id,{handleToggleStarred:d,handleToggleStatus:c}=ot(),[h,x]=g.useState(0),b=60,m=.5,j=t.starred,T=t.status==="unread",w=rr({preventScrollOnSwipe:!0,delta:b/2,onSwiping:f=>{const y=Math.min(Math.abs(f.deltaX*m),b)*Math.sign(f.deltaX);x(y)},onSwiped:async f=>{try{f.deltaX>b?(await d(t),v.success(j?i.t("article_card.unmarked_as_starred"):i.t("article_card.marked_as_starred"))):f.deltaX<-b&&(await c(t),v.success(T?i.t("article_card.marked_as_read"):i.t("article_card.marked_as_unread")))}catch{v.error(i.t("article_card.update_failed"))}x(0)}}),[M,S]=g.useState(!1),[$,D]=g.useState(!1),K=()=>c(t),Q=20,{ref:te}=ze({skip:$,onChange:async(f,y)=>{if(!(!n||!T)){if(f)S(!0);else if(M){const{top:k}=y.boundingClientRect;k<Q&&(await K(),D(!0))}}}}),J=ar({x:h});return g.createElement("div",{...w,className:"article-card",key:t.id},e.jsxs("div",{ref:te,children:[e.jsx(nr.div,{className:"swipe-card",style:J,children:e.jsx(Ne,{className:Oe("swipe-content","card-custom-style","card-custom-hover-style",{"card-custom-selected-style":u}),"data-entry-id":t.id,hoverable:!0,onClick:()=>s(t),bordered:!1,children:e.jsx(Ne.Meta,{description:e.jsx(tn,{entry:t,showFeedIcon:l,mini:r,children:a})})})}),e.jsxs("div",{className:"swipe-actions",children:[e.jsx("div",{className:"swipe-action left",children:j?e.jsx(Qe,{style:{color:"#ffcd00",fontSize:"24px"}}):e.jsx(Ye,{style:{color:"#ffffff",fontSize:"24px"}})}),e.jsx("div",{className:"swipe-action right",children:T?e.jsx(Mt,{style:{color:"#ffffff",fontSize:"24px"}}):e.jsx(Vt,{style:{color:"#ffffff",fontSize:"24px"}})})]})]}))},rn=()=>{const{layout:t}=p(I),{isArticleListReady:s}=p(A),r=t==="large"?2:4,a=n=>e.jsx(Ne,{className:"card-style",cover:t==="large"?e.jsx("div",{className:"card-cover-style"}):null,children:e.jsx(Ne.Meta,{description:e.jsx(Fe,{loading:!s,animation:!0,text:{rows:3,width:150}})})},n);return!s&&Array.from({length:r},(n,l)=>a(l))},an=()=>{const{orderDirection:t}=p(I),{filterType:s}=p(A),{polyglot:r}=p(V),a=r.t("search.tooltip").split(`
`),[n,l]=g.useState(""),o=g.useCallback(Ea(d=>De(d),500),[]),{isBelowMedium:i}=xe(),u=()=>{B({orderDirection:t==="desc"?"asc":"desc"})};return g.useEffect(()=>{Me("title")},[]),g.useEffect(()=>{n===""?De(n):o(n)},[n,o]),e.jsxs("div",{className:"search-and-sort-bar",children:[e.jsx(q.Search,{allowClear:!0,onChange:l,placeholder:r.t("search.placeholder"),style:{width:i?"100%":272,marginLeft:8},addBefore:e.jsxs(R,{onChange:Me,style:{width:100},value:s,children:[e.jsx(R.Option,{value:"title",children:r.t("search.type_title")}),e.jsx(R.Option,{value:"content",children:r.t("search.type_content")}),e.jsx(R.Option,{value:"author",children:r.t("search.type_author")})]})}),e.jsxs("div",{className:"button-group",children:[e.jsx(de,{mini:!0,content:e.jsx("div",{children:a.map((d,c)=>e.jsxs(g.Fragment,{children:[d,c<a.length-1&&e.jsx("br",{})]},`line-${c}-${d.length}`))}),children:e.jsx(F,{shape:"circle",size:"small",icon:e.jsx(Pt,{})})}),e.jsx(de,{mini:!0,content:t==="desc"?r.t("article_list.sort_direction_desc"):r.t("article_list.sort_direction_asc"),children:e.jsx(F,{shape:"circle",size:"small",icon:t==="desc"?e.jsx(or,{}):e.jsx(ir,{}),onClick:u})})]})]})},nn=(...t)=>s=>{for(const r of t)typeof r=="function"?r(s):r&&typeof r=="object"&&(r.current=s)},on=(t,s,r)=>{g.useLayoutEffect(()=>{let a=null;return t>0&&(clearTimeout(a),a=setTimeout(()=>{r(),clearTimeout(a)},s*4)),()=>clearTimeout(a)},[t,s,r])},ln=({duration:t,color:s})=>{const[r,a]=g.useState([]);on(r.length,t,()=>{a([])});const n=l=>{const o=l.currentTarget.getBoundingClientRect(),i=o.width>o.height?o.width:o.height,u=l.pageX-o.x-i/2,d=l.pageY-o.y-i/2,c={x:u,y:d,size:i,id:`${new Date().getTime()}-${u}-${d}`};a([...r,c])};return e.jsx("div",{className:"ripple-container",onMouseDown:n,children:r.length>0&&r.map(l=>e.jsx("span",{className:"ripple-span",style:{top:l.y,left:l.x,width:l.size,height:l.size,backgroundColor:s,animationDuration:`${t}ms`}},l.id))})},cn=({getEntries:t})=>{const{isArticleListReady:s,loadMoreVisible:r}=p(A),{loadingMore:a,handleLoadMore:n}=dt(),{ref:l,inView:o}=ze(),i=g.useCallback(async()=>{r&&o&&s&&!a&&await n(t)},[r,o,s,a,n,t]);return g.useEffect(()=>{const u=setInterval(i,500);return()=>clearInterval(u)},[i]),s&&r&&e.jsxs("div",{className:"load-more-container",ref:l,children:[e.jsx(cr,{loading:a,style:{paddingRight:"10px"}}),"Loading more ..."]})},dn=g.forwardRef(({getEntries:t,handleEntryClick:s,cardsRef:r},a)=>{const{layout:n,pageSize:l}=p(I),o=n==="small",{isArticleListReady:i,loadMoreVisible:u}=p(A),d=p(_e),c=d.length-Math.ceil(l*.2)-1,{loadingMore:h,handleLoadMore:x}=dt(),{ref:b}=ze({skip:!u,onChange:async w=>{!w||!i||h||await x(t)}}),m=lr({count:d.length,getScrollElement:()=>r.current,estimateSize:g.useCallback(()=>o?120:280,[o]),overscan:5}),j=m.getVirtualItems(),T=g.useCallback(w=>w===c?nn(m.measureElement,b):m.measureElement,[c,m.measureElement,b]);return e.jsxs(e.Fragment,{children:[e.jsx(an,{}),e.jsxs(Ge,{className:"entry-list",ref:a,children:[e.jsx(rn,{}),i&&e.jsx("div",{ref:r,children:e.jsx("div",{style:{height:m.getTotalSize(),width:"100%",position:"relative"},children:j.map(w=>e.jsx("div",{"data-index":w.index,ref:T(w.index),style:{position:"absolute",top:0,left:0,width:"100%",transform:`translateY(${w.start}px)`},children:e.jsx(sn,{entry:d[w.index],handleEntryClick:s,mini:o,children:e.jsx(ln,{color:"var(--color-text-4)",duration:1e3})})},w.key))})}),e.jsx(cn,{getEntries:t})]})]})}),un=()=>{je(t=>t.map(s=>({...s,status:"read"})))},hn=({info:t,refreshArticleList:s,markAllAsRead:r})=>{const{isArticleListReady:a}=p(A),{showStatus:n}=p(I),{polyglot:l}=p(V),{fetchAppData:o}=it(),i=async()=>{try{await r(),un(),await o(),v.success(l.t("article_list.mark_all_as_read_success"))}catch{v.error(l.t("article_list.mark_all_as_read_error"))}},u=d=>{B({showStatus:d})};return g.useEffect(()=>{Me("title"),De("")},[n]),e.jsxs("div",{className:"entry-panel",children:[e.jsx(Rt,{focusLock:!0,onOk:i,title:l.t("article_list.mark_all_as_read_confirm"),children:e.jsx(F,{icon:e.jsx(Nt,{}),shape:"circle",style:{visibility:["starred","history"].includes(t.from)?"hidden":"visible"}})}),e.jsx(dr.Group,{onChange:u,options:[{label:l.t("article_list.filter_status_all"),value:"all"},{label:l.t("article_list.filter_status_unread"),value:"unread"}],style:{visibility:t.from==="history"?"hidden":"visible"},type:"button",value:n}),e.jsx(F,{icon:e.jsx(Ae,{}),loading:!a,shape:"circle",onClick:s})]})},fe=({info:t,getEntries:s,markAllAsRead:r})=>{const{activeContent:a,isArticleFocused:n,isArticleListReady:l}=p(A),{isAppDataReady:o}=p(O),{orderBy:i,orderDirection:u,showAllFeeds:d,showStatus:c}=p(I),h=p(_e),x=p(rt),{polyglot:b}=p(V),{handleFetchContent:m,handleSaveToThirdPartyServices:j,handleToggleStarred:T,handleToggleStatus:w,handleEntryStatusUpdate:M}=ot(),{fetchAppData:S}=it(),{fetchArticleList:$}=Wa(t,s),[D,K]=g.useState(!1),Q=g.useRef(null),te=g.useRef(null),J=g.useRef(null);g.useEffect(()=>{xa(t.from),a&&X(null),pe(s)},[t]),g.useEffect(()=>{["starred","history"].includes(t.from)||pe(s)},[i]),g.useEffect(()=>{x.length===0||["starred","history"].includes(t.from)||pe(s)},[d]),g.useEffect(()=>{pe(s)},[u,c]);const f=async G=>{K(!0),X({...G,status:"read"}),setTimeout(()=>{const le=J.current;if(le){const se=le.querySelector(".simplebar-content-wrapper");se&&se.scroll({top:0}),le.focus()}K(!1),G.status==="unread"&&(M(G,"read"),$e([G.id],"read").catch(()=>{v.error(b.t("content.mark_as_read_error")),X({...G,status:"unread"}),M(G,"unread")}))},200)},{exitDetailView:y,fetchOriginalArticle:k,navigateToNextArticle:N,navigateToPreviousArticle:L,openLinkExternally:Z,openPhotoSlider:ie,saveToThirdPartyServices:be,toggleReadStatus:me,toggleStarStatus:ht}=fs(f,Q);g.useEffect(()=>{const G={ArrowLeft:()=>L(),ArrowRight:()=>N(),Escape:()=>y(),a:()=>be(j),b:Z,d:()=>k(m),m:()=>me(()=>w(a)),s:()=>ht(()=>T(a)),v:ie},le=se=>{const ft=G[se.key];ft&&(se.key==="ArrowLeft"?L(se.ctrlKey):se.key==="ArrowRight"?N(se.ctrlKey):ft())};if(n)return document.addEventListener("keydown",le),()=>{document.removeEventListener("keydown",le)}},[a,h,n]);const pe=async G=>{Ve(0),o?await $(G):await S()};return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"entry-col",children:[e.jsx(Be,{in:l,timeout:200,nodeRef:te,classNames:"fade",children:e.jsx(dn,{cardsRef:te,getEntries:s,handleEntryClick:f,ref:Q})}),e.jsx(hn,{info:t,refreshArticleList:()=>pe(s),markAllAsRead:r})]}),a?e.jsxs("div",{className:"article-container",children:[e.jsx(Be,{in:!D,timeout:200,nodeRef:J,classNames:"fade",unmountOnExit:!0,children:e.jsx(Ja,{ref:J})}),e.jsx(Be,{in:!D,timeout:200,unmountOnExit:!0,children:e.jsx(Ya,{handleEntryClick:f,entryListRef:Q})})]}):e.jsxs("div",{className:"content-empty",children:[e.jsx(ur,{style:{fontSize:"64px"}}),e.jsx(_.Title,{heading:6,style:{color:"var(--color-text-3)",marginTop:"10px"},children:"ReactFlux"})]})]})},fn=()=>e.jsx(fe,{info:{from:"all",id:""},getEntries:Gr,markAllAsRead:oa}),mn=()=>{const{id:t}=Ot(),s=U("orderBy"),r=U("pageSize"),a=U("showAllFeeds"),n=async(l=0,o=null)=>{const i={baseUrl:`/v1/categories/${t}/entries`,orderField:s,offset:l,limit:r,status:o},u={globally_visible:!a};return C.get(he(i,u))};return e.jsx(fe,{info:{from:"category",id:t},getEntries:n,markAllAsRead:()=>zr(t)})},pn=()=>{const t=oe(),s=hr();return console.error(s),g.useEffect(()=>{ct()},[]),e.jsx("div",{id:"error-page",style:{top:"30%",position:"relative"},children:e.jsx(fr,{status:"404",subTitle:s.statusText||s.message,extra:[e.jsx(F,{type:"primary",onClick:()=>t("/"),children:"Back to Home"},"back")]})})},gn=()=>{const{id:t}=Ot(),s=U("orderBy"),r=U("pageSize"),a=async(n=0,l=null)=>{const o={baseUrl:`/v1/feeds/${t}/entries`,orderField:s,offset:n,limit:r,status:l};return C.get(he(o))};return e.jsx(fe,{info:{from:"feed",id:t},getEntries:a,markAllAsRead:()=>sa(t)})},xn=()=>e.jsx(fe,{info:{from:"history",id:""},getEntries:Yr}),yn=t=>{const s=t.getFieldsValue();let r=!0;for(const[a,n]of Object.entries(s))if(a!=="password"){const l=n==null?void 0:n.trim();t.setFieldValue(a,l),l||(r=!1)}else n||(r=!1);return r},ke=(t,s)=>{t.key==="Enter"&&s.submit()},_n=()=>{Ut(),ls();const t=p(Ue),{homePage:s}=p(I),{polyglot:r}=p(V),[a]=mr(),[n,l]=g.useState(!1),[o,i]=g.useState("token"),u=oe(),d=async()=>{l(!0);const{server:h,token:x,username:b,password:m}=a.getFieldsValue();try{(await Et.raw("v1/me",{baseURL:h,headers:x?{"X-Auth-Token":x}:{Authorization:`Basic ${btoa(`${b}:${m}`)}`}})).status===200&&(v.success(r.t("login.success")),Bt({server:h,token:x,username:b,password:m}),u("/"))}catch(j){console.error(j),v.error(j.message)}l(!1)},c=async()=>{const h=a.getFieldsValue();if(!Le(h)){v.error(r.t("login.auth_error"));return}await d()};return g.useEffect(()=>{ct()},[]),Le(t)?e.jsx(Je,{to:`/${s}`}):r&&e.jsxs("div",{className:"page-layout",children:[e.jsx("div",{className:"form-panel",children:e.jsxs("div",{className:"login-form",children:[e.jsx(_.Title,{heading:3,children:r.t("login.login_to_your_server")}),e.jsxs(P,{autoComplete:"off",form:a,layout:"vertical",onSubmit:async()=>{yn(a)?await c():v.error(r.t("login.submit_error"))},children:[e.jsx(P.Item,{field:"server",label:r.t("login.server_label"),rules:[{required:!0}],onKeyDown:h=>{ke(h,a)},children:e.jsx(q,{disabled:n,placeholder:r.t("login.server_placeholder"),prefix:e.jsx(pr,{})})}),o==="token"&&e.jsx(P.Item,{field:"token",label:r.t("login.token_label"),rules:[{required:!0}],onKeyDown:h=>{ke(h,a)},children:e.jsx(q.Password,{disabled:n,placeholder:r.t("login.token_placeholder"),prefix:e.jsx(yt,{})})}),o==="user"&&e.jsxs(e.Fragment,{children:[e.jsx(P.Item,{field:"username",label:r.t("login.username_label"),rules:[{required:!0}],onKeyDown:h=>{ke(h,a)},children:e.jsx(q,{disabled:n,placeholder:r.t("login.username_placeholder"),prefix:e.jsx(Lt,{})})}),e.jsx(P.Item,{field:"password",label:r.t("login.password_label"),rules:[{required:!0}],onKeyDown:h=>{ke(h,a)},children:e.jsx(q.Password,{disabled:n,placeholder:r.t("login.password_placeholder"),prefix:e.jsx(yt,{})})})]})]}),e.jsx(F,{loading:n,type:"primary",long:!0,onClick:()=>a.submit(),style:{marginTop:"20px"},children:r.t("login.login_button")}),e.jsx(H,{orientation:"center",children:r.t("login.another_login_method")}),e.jsx(F,{type:"secondary",long:!0,onClick:()=>i(o==="token"?"user":"token"),style:{marginTop:"20px"},children:o==="token"?r.t("login.another_login_button"):r.t("login.token_label")}),e.jsxs("div",{style:{display:"flex",marginTop:"40px"},children:[e.jsx(_.Text,{disabled:!0,children:r.t("login.need_help")}),e.jsx(gr,{href:"https://miniflux.app/docs/api.html#authentication",style:{fontWeight:"500"},children:r.t("login.miniflux_official_website")})]})]})}),e.jsx("div",{className:"background"})]})},jn=({children:t})=>{const s=p(Ue);return Le(s)?e.jsx(e.Fragment,{children:t}):e.jsx(Je,{to:"/login"})},bn=()=>e.jsx(fe,{info:{from:"starred",id:""},getEntries:Wt}),vn=()=>{const t=async()=>{const s=await Te(0,"unread"),r=s.total;let a=s.entries;r>a.length&&(a=Te(0,"unread",r).then(l=>l.entries));const n=a.map(l=>l.id);return $e(n,"read")};return e.jsx(fe,{info:{from:"today",id:""},getEntries:Te,markAllAsRead:t})},wn=U("homePage"),Sn=[{path:"/all",element:e.jsx(fn,{})},{path:"/today",element:e.jsx(vn,{})},{path:"/starred",element:e.jsx(bn,{})},{path:"/history",element:e.jsx(xn,{})},{path:"/category/:id",element:e.jsx(mn,{})},{path:"/feed/:id",element:e.jsx(gn,{})}],ms=xr([{path:"/",element:e.jsx(jn,{children:e.jsx(Ha,{})}),errorElement:e.jsx(pn,{}),children:[...Sn,{index:!0,element:e.jsx(Je,{to:`/${wn}`,replace:!0})}]},{path:"/login",element:e.jsx(_n,{})}]),Cn={"zh-CN":vr,"es-ES":wr},kn=()=>Cn[Tr()]||br;yr.createRoot(document.getElementById("root")).render(e.jsx(_r,{locale:kn(),children:e.jsx(jr,{router:ms})}));
