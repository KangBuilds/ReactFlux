import{p as wt,m as ue,u as p,r as g,d as $,P as fs,i as ps,o as St,a as gs,b as xs,c as ys,e as J,M as v,C as _s,j as e,f as Z,g as Be,h as ie,A as Ct,I as js,T as _,S as Te,k as He,l as it,n as bs,q as vs,s as qe,t as ws,v as Ss,w as Re,B as F,x as Cs,D as ks,y as Ie,z as de,E as kt,F as Ts,G as Is,H as Fs,J as lt,K as Tt,L as Es,N as Fe,O as Ns,Q as It,R as re,U as As,V as Ls,W as Rs,X as Ms,Y as Ps,Z as q,_ as ee,$ as C,a0 as ct,a1 as P,a2 as pe,a3 as K,a4 as We,a5 as dt,a6 as Ft,a7 as Ds,a8 as Et,a9 as Nt,aa as Vs,ab as ce,ac as Os,ad as zs,ae as Us,af as $s,ag as Bs,ah as Hs,ai as qs,aj as Ws,ak as At,al as Lt,am as Ke,an as Ks,ao as Gs,ap as Ys,aq as Xs,ar as Js,as as Qs,at as Zs,au as er,av as tr,aw as Me,ax as sr,ay as rr,az as nr,aA as Ee,aB as ar,aC as or,aD as ir,aE as lr,aF as cr,aG as ut,aH as Rt,aI as dr,aJ as ur,aK as hr,aL as Ge,aM as mr,aN as ht,aO as fr,aP as pr,aQ as gr,aR as xr,aS as yr,aT as _r,aU as jr,aV as br}from"./vendor-BH4bf0WS.js";(function(){const s=document.createElement("link").relList;if(s&&s.supports&&s.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))n(o);new MutationObserver(o=>{for(const i of o)if(i.type==="childList")for(const a of i.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&n(a)}).observe(document,{childList:!0,subtree:!0});function r(o){const i={};return o.integrity&&(i.integrity=o.integrity),o.referrerPolicy&&(i.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?i.credentials="include":o.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function n(o){if(o.ep)return;o.ep=!0;const i=r(o);fetch(o.href,i)}})();const vr="modulepreload",wr=function(t){return"/"+t},mt={},je=function(s,r,n){let o=Promise.resolve();if(r&&r.length>0){document.getElementsByTagName("link");const a=document.querySelector("meta[property=csp-nonce]"),l=(a==null?void 0:a.nonce)||(a==null?void 0:a.getAttribute("nonce"));o=Promise.allSettled(r.map(c=>{if(c=wr(c),c in mt)return;mt[c]=!0;const d=c.endsWith(".css"),u=d?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${c}"]${u}`))return;const h=document.createElement("link");if(h.rel=d?"stylesheet":vr,d||(h.as="script"),h.crossOrigin="",h.href=c,l&&h.setAttribute("nonce",l),document.head.appendChild(h),d)return new Promise((y,j)=>{h.addEventListener("load",y),h.addEventListener("error",()=>j(new Error(`Unable to preload CSS for ${c}`)))})}))}function i(a){const l=new Event("vite:preloadError",{cancelable:!0});if(l.payload=a,window.dispatchEvent(l),!l.defaultPrevented)throw a}return o.then(a=>{for(const l of a||[])l.status==="rejected"&&i(l.reason);return s().catch(i)})},Sr=(t,s,r)=>{const n=t[s];return n?typeof n=="function"?n():Promise.resolve(n):new Promise((o,i)=>{(typeof queueMicrotask=="function"?queueMicrotask:setTimeout)(i.bind(null,new Error("Unknown variable dynamic import: "+s+(s.split("/").length!==r?". Note that variables only represent file names one level deep.":""))))})},Cr=()=>{const{language:t}=E.get(),s=Ye();return t||s},Ye=()=>{const t=navigator.language;return t==="zh-Hans-CN"?"zh-CN":t},Mt={articleWidth:90,fontSize:1.05,homePage:"all",language:Ye(),layout:"large",markReadOnScroll:!1,orderBy:"created_at",orderDirection:"desc",pageSize:100,removeDuplicates:"none",showAllFeeds:!1,showDetailedRelativeTime:!1,showFeedIcon:!0,showStatus:"unread",theme:"light",themeColor:"Blue",fontFamily:"system-ui"},E=wt("settings",Mt,{encode:JSON.stringify,decode:JSON.parse}),B=t=>E.get()[t],W=t=>E.set({...E.get(),...t}),kr=()=>E.set(Mt),A=(t,s=null)=>r=>{const n=t.get();if(typeof n=="object"&&n!==null){if(s===null)return;typeof r=="function"?t.set({...n,[s]:r(n[s])}):t.set({...n,[s]:r})}else typeof r=="function"?t.set(r(n)):t.set(r)},V=ue({polyglot:null}),Tr=A(V,"polyglot"),Ir=async(t,s)=>{let r,n=t;try{r=await Sr(Object.assign({"../locales/en-US.json":()=>je(()=>import("./en-US-CokktAlF.js"),[]),"../locales/es-ES.json":()=>je(()=>import("./es-ES-DbdslXW-.js"),[]),"../locales/zh-CN.json":()=>je(()=>import("./zh-CN-BbP81c1t.js"),[])}),`../locales/${t}.json`,3)}catch{r=await je(()=>import("./en-US-CokktAlF.js"),[]),n="en-US"}{const o=new fs({phrases:r.default,locale:n});Tr(o)}},Pt=()=>{const{language:t}=p(E);g.useEffect(()=>{t?(Ir(t),t==="zh-CN"?$.locale("zh-cn"):t==="es"||t.startsWith("es-")?$.locale("es"):$.locale("en")):W({language:Ye()})},[t])},Xe=ue({addFeedModalVisible:!1,settingsModalVisible:!1}),Fr=A(Xe,"addFeedModalVisible"),Er=A(Xe,"settingsModalVisible"),Je=()=>{const{addFeedModalVisible:t,settingsModalVisible:s}=p(Xe);return{addFeedModalVisible:t,setAddFeedModalVisible:Fr,settingsModalVisible:s,setSettingsModalVisible:Er}},ge=()=>{const[t,s]=g.useState(window.innerWidth),r=t<=768,n=t<=992;return g.useEffect(()=>{const o=()=>s(window.innerWidth);return window.addEventListener("resize",o),()=>window.removeEventListener("resize",o)},[]),{width:t,isBelowMedium:r,isBelowLarge:n}},Dt={server:"",token:"",username:"",password:""},Pe=wt("auth",Dt,{encode:JSON.stringify,decode:JSON.parse}),Vt=t=>Pe.set(t),Nr=()=>Vt(Dt),Ar=t=>{try{const s=new URL(t),{hostname:r,port:n}=s;return!!r&&!!n}catch{return!1}},Ne=t=>{const{server:s,token:r,username:n,password:o}=t;return!s||!ps(s,{require_protocol:!0})&&!Ar(s)?!1:r||n&&o},Lr=()=>St.create({retry:3,onRequest({_request:t,options:s}){const r=Pe.get();if(!Ne(r))throw new Error("Invalid auth");const{server:n,token:o,username:i,password:a}=r;s.baseURL=n,s.headers=o?{"X-Auth-Token":o}:{Authorization:`Basic ${btoa(`${i}:${a}`)}`}},onRequestError({_request:t,_options:s,error:r}){console.error("Request error: ",r)},async onResponseError({_request:t,response:s,_options:r}){var i;s.status===401&&(localStorage.removeItem("auth"),await ms.navigate("/login"));const o=((i=s._data)==null?void 0:i.error_message)??s.statusText;throw console.error("Response error: ",o),new Error(o)}}),S=Lr();S.get=t=>S(t,{method:"GET"});S.post=(t,s)=>S(t,{method:"POST",body:s});S.put=(t,s)=>S(t,{method:"PUT",body:s});const Rr=async()=>S.get("/v1/categories"),Mr=async t=>S.post("/v1/categories",{title:t}),Pr=async t=>S.raw(`/v1/categories/${t}`,{method:"DELETE"}),Dr=async(t,s,r=!1)=>{const n={title:s,hide_globally:r?"on":void 0};return S.put(`/v1/categories/${t}`,n)},Vr=async t=>S.put(`/v1/categories/${t}/mark-all-as-read`);$.extend(gs);$.extend(xs);$.extend(ys);const Or=t=>$(t).isAfter($().subtract(24,"hour")),zr=()=>$().subtract(24,"hour").unix(),Ur=()=>$().utc().format("YYYY-MM-DDTHH:mm:ss.SSSSSSZ"),$r=t=>$(t).format("dddd, MMMM D, YYYY h:mm A"),Ot=(t,s)=>{const{polyglot:r}=V.get();if(!s){const f=$(),b=$(t),k=b.from(f),w=$.duration(f.diff(b)).asSeconds();return w>=0&&w<60?r.t("date.just_now"):k}const n=$(),i=$(t).diff(n),a=$.duration(Math.abs(i)),l=a.years(),c=a.months(),d=a.days(),u=a.hours(),h=a.minutes(),y=[];if(l>0&&y.push(r.t("date.years",l)),c>0&&y.push(r.t("date.months",c)),d>0&&y.push(r.t("date.days",d)),u>0&&y.push(r.t("date.hours",u)),h>0&&y.push(r.t("date.minutes",h)),y.length===0)return r.t("date.just_now");const j=y.join(" ");return i>0?r.t("date.in_time",{time:j}):r.t("date.time_ago",{time:j})},zt=t=>{const{polyglot:s}=V.get(),r=s.t("date.minutes",t);return s.t("article_card.reading_time",{time:r})},De=async(t,s)=>S.put("/v1/entries",{entry_ids:t,status:s}),Br=async t=>S.put(`/v1/entries/${t}/bookmark`),Hr=async t=>S.get(`/v1/entries/${t}/fetch-content`),qr=async t=>S.raw(`/v1/entries/${t}/save`,{method:"POST"}),he=(t,s={})=>{const{baseUrl:r,orderField:n,offset:o,limit:i,status:a}=t,l=B("orderDirection"),c=new URLSearchParams({order:n,direction:l,offset:o,limit:i,...s});return a&&c.append("status",a),`${r}?${c}`},Wr=async(t=0,s=null)=>{const r=B("orderBy"),n=B("pageSize"),o=B("showAllFeeds"),i={baseUrl:"/v1/entries",orderField:r,offset:t,limit:n,status:s},a={globally_visible:!o};return S.get(he(i,a))},Ce=async(t=0,s=null,r=null)=>{const n=B("orderBy"),o=r??B("pageSize"),i=B("showAllFeeds"),a=zr(),l={baseUrl:"/v1/entries",orderField:n,offset:t,limit:o,status:s},c={globally_visible:!i,published_after:a};return S.get(he(l,c))},Ut=async(t=0,s=null)=>{const r=B("pageSize"),n={baseUrl:"/v1/entries",orderField:"changed_at",offset:t,limit:r,status:s},o={starred:"true"};return S.get(he(n,o))},$t=async(t=0)=>{const s=B("pageSize"),r={baseUrl:"/v1/entries",orderField:"changed_at",offset:t,limit:s,status:"read"};return S.get(he(r))},Kr=async()=>S.get("/v1/feeds"),Gr=async()=>S.get("/v1/feeds/counters"),Yr=async t=>S.raw(`/v1/feeds/${t}/refresh`,{method:"PUT"}),Xr=async()=>S.raw("/v1/feeds/refresh",{method:"PUT"}),Jr=async(t,s,r)=>S.post("/v1/feeds",{feed_url:t,category_id:s,crawler:r}),Qr=async t=>S.raw(`/v1/feeds/${t}`,{method:"DELETE"}),ft=async(t,s)=>{const{categoryId:r,title:n,siteUrl:o,feedUrl:i,hidden:a,disabled:l,isFullText:c}=s;return S.put(`/v1/feeds/${t}`,{category_id:r,title:n,site_url:o,feed_url:i,hide_globally:a,disabled:l,crawler:c})},Zr=async t=>S.put(`/v1/feeds/${t}/mark-all-as-read`),en=async()=>S.get("/v1/me"),tn=async t=>S.get(`/v1/icons/${t}`),sn=async()=>S.get("/v1/version"),rn=async()=>{const t=await en();return S.put(`/v1/users/${t.data.id}/mark-all-as-read`)},Bt={isAppDataReady:!1,unreadInfo:{},unreadTodayCount:0,starredCount:0,historyCount:0,feedsData:[],categoriesData:[],isVersionAtLeast2_2_0:!1},U=ue(Bt),Qe=J(U,t=>{const{unreadInfo:s,feedsData:r}=t;return r.map(o=>({...o,unreadCount:s[o.id]??0})).sort((o,i)=>o.title.localeCompare(i.title,"en"))}),xe=J([U,Qe],(t,s)=>{const{categoriesData:r}=t;return r.map(o=>{const i=s.filter(a=>a.category.id===o.id);return{...o,unreadCount:i.reduce((a,l)=>a+(l.unreadCount??0),0),feedCount:i.length}}).sort((o,i)=>o.title.localeCompare(i.title,"en"))}),Ht=J(xe,t=>t.filter(s=>s.hide_globally).map(s=>s.id)),Ze=J([Qe,Ht],(t,s)=>t.filter(r=>r.hide_globally||s.includes(r.category.id)).map(r=>r.id)),qt=J([Qe,Ze,E],(t,s,r)=>{const{showAllFeeds:n}=r;return t.filter(o=>n||!s.includes(o.id))}),nn=J([xe,Ht,E],(t,s,r)=>{const{showAllFeeds:n}=r;return t.filter(o=>n||!s.includes(o.id))}),Wt=J(qt,t=>t.reduce((s,r)=>{const{id:n}=r.category;return s[n]||(s[n]=[]),s[n].push(r),s},{})),an=J([U,qt],(t,s)=>{const{unreadInfo:r}=t;return Object.entries(r).reduce((n,[o,i])=>s.some(a=>a.id===Number(o))?n+i:n,0)}),ke=A(U,"categoriesData"),ae=A(U,"feedsData"),Ve=A(U,"historyCount"),pt=A(U,"isAppDataReady"),Oe=A(U,"starredCount"),Kt=A(U,"unreadInfo"),Gt=A(U,"unreadTodayCount"),on=A(U,"isVersionAtLeast2_2_0"),ln=()=>U.set(Bt),Yt=(t,s)=>{const r=s.map(n=>n.id);return t.map(n=>r.includes(n.id)&&s.find(i=>i.id===n.id)||n)},ze=(t,s)=>{const r={};let n=0;const o=t.filter(c=>c.status!==s);if(o.length===0)return;Ve(s==="read"?c=>c+o.length:c=>Math.max(0,c-o.length));for(const c of o){const d=c.feed.id,u=Or(c.published_at),h=s==="read"?-1:1;r[d]=(r[d]??0)+h,n+=u?h:0}Gt(c=>Math.max(0,c+n)),Kt(c=>{const d={...c};for(const[u,h]of Object.entries(r))d[u]=Math.max(0,(d[u]??0)+h);return d});const i=o.map(c=>({...c,status:s})),{activeContent:a}=L.get(),l=i.find(c=>c.id===(a==null?void 0:a.id));l&&X(l),ye(c=>Yt(c,i))},et=()=>{const{activeContent:t}=p(L),{polyglot:s}=p(V),r=(c,d)=>{ze([c],d)},n=(c,d)=>{d?(Oe(h=>h+1),_s({particleCount:100,angle:120,spread:70,origin:{x:1,y:1}})):Oe(h=>Math.max(0,h-1));const u={...c,starred:d};t&&X(u),ye(h=>Yt(h,[u]))};return{handleEntryStatusUpdate:r,handleFetchContent:async()=>{try{const c=await Hr(t.id);v.success(s.t("actions.fetched_content_success")),X({...t,content:c.content})}catch{v.error(s.t("actions.fetched_content_error"))}},handleSaveToThirdPartyServices:async()=>{try{(await qr(t.id)).status===202?v.success(s.t("actions.saved_to_third-party_services_success")):v.error(s.t("actions.saved_to_third-party_services_error"))}catch{v.error(s.t("actions.saved_to_third-party_services_error"))}},handleToggleStarred:async c=>{const d=!c.starred;n(c,d),Br(c.id).catch(()=>{v.error(d?s.t("actions.star_error"):s.t("actions.unstar_error")),n(c,!d)})},handleToggleStatus:async c=>{const d=c.status,u=d==="read"?"unread":"read";r(c,u),De([c.id],u).catch(()=>{v.error(u==="read"?s.t("actions.mark_as_read_error"):s.t("actions.mark_as_unread_error")),r(c,d)})}}},cn=(t,s)=>{const{polyglot:r}=V.get();if(t.length===0||s==="none")return t;const n=t.map((u,h)=>({id:u.id,index:h})),o=new Map,i=new Map,a=new Map,l=[],c=t.slice().sort((u,h)=>u.id-h.id).filter(u=>{const{hash:h,title:y,url:j,id:f}=u;switch(s){case"hash":if(o.has(h))return l.push(u),!1;o.set(h,f);break;case"title":if(i.has(y))return l.push(u),!1;i.set(y,f);break;case"url":if(a.has(j))return l.push(u),!1;a.set(j,f);break;default:return!0}return!0}),d=l.filter(u=>u.status==="unread").map(u=>u.id);return d.length>0&&(ze(l,"read"),De(d,"read").catch(()=>{v.error(r.t("deduplicate.mark_as_read_error")),ze(l,"unread")})),c.sort((u,h)=>{const y=n.find(f=>f.id===u.id).index,j=n.find(f=>f.id===h.id).index;return y-j})},dn=t=>{const s=new Array(t.length).fill(0);let r=0,n=1;for(;n<t.length;)t[n]===t[r]?(r++,s[n]=r,n++):r!==0?r=s[r-1]:(s[n]=0,n++);return s},be=(t,s,r=!0)=>{const n=r?t.toLowerCase():t,o=r?s.toLowerCase():s;if(o.length===0)return 0;const i=dn(o);let a=0,l=0;for(;a<n.length;)if(n[a]===o[l]?(a++,l++):l!==0?l=i[l-1]:a++,l===o.length)return a-l;return-1},un=t=>{const s=[],r=[];let n=[];const o=[],i=t.match(/([-+|]?)\s*"([^"]+)"/g);let a=t;i&&(n=i.map(c=>{const d=c.trim()[0],u=c.match(/"([^"]+)"/)[1];switch(d){case"-":r.push(u);break;case"+":s.push(u);break;case"|":o.push([u]);break;default:s.push(u);break}return u}),a=t.replace(/([-+|]?)\s*"([^"]+)"/g,""));const l=a.split(/\s+/);for(const c of l){const d=c.replace(/^-|\+|\|$/,"");if(c.startsWith("-")&&d)r.push(d);else if(c.startsWith("+")&&d)s.push(d);else if(c.includes("|")){const u=c.split("|").filter(h=>h);u.length>0&&o.push(u)}else d&&s.push(d)}return{includeTerms:s,excludeTerms:r,exactPhrases:n,orConditions:o}},hn=(t,s,r=[],n=!0)=>{const{includeTerms:o,excludeTerms:i,exactPhrases:a,orConditions:l}=un(s);return t.filter(c=>r.some(d=>{const u=c[d];if(typeof u!="string")return!1;const h=n?u.toLowerCase():u;if(i.some(f=>be(h,f,n)!==-1)||a.length>0&&!a.some(f=>be(h,f,n)!==-1))return!1;const y=o.every(f=>be(h,f,n)!==-1),j=l.length===0||l.some(f=>f.some(b=>be(h,b,n)!==-1));return y&&j}))},Xt=(t,s,r=[],n=!0)=>{try{if(!Array.isArray(t)||t.length===0)throw new Error("Invalid data input");if(typeof s!="string"||s.trim().length===0)throw new Error("Invalid query input");return hn(t,s,r,n)}catch(o){return console.error(o.message),[]}},mn=(t,s)=>t.toLowerCase().includes(s.toLowerCase()),fn=(t,s,r)=>r?Xt(t,r,[s]):t,Jt={activeContent:null,entries:[],filterString:"",filterType:"Title",infoFrom:B("homePage"),isArticleFocused:!1,isArticleListReady:!1,loadMoreVisible:!1,offset:0,total:0},L=ue(Jt),tt=J([L,U,Ze,E],(t,s,r,n)=>{const{entries:o,filterString:i,filterType:a,infoFrom:l}=t,c=fn(o,a,i),{isVersionAtLeast2_2_0:d}=s,{removeDuplicates:u,showAllFeeds:h}=n,y=!["starred","history"].includes(l),j=b=>d||h||!r.includes(b.feed.id),f=y?c.filter(j):c;return u==="none"||["starred","history"].includes(l)?f:cn(f,u)}),X=A(L,"activeContent"),ye=A(L,"entries"),Ae=A(L,"filterString"),Le=A(L,"filterType"),pn=A(L,"infoFrom"),oe=A(L,"isArticleFocused"),gt=A(L,"isArticleListReady"),Qt=A(L,"loadMoreVisible"),Zt=A(L,"offset"),gn=A(L,"total"),xn=()=>L.set(Jt),xt=ue(),ve=new Set,yn=t=>{const s=p(xt);return g.useEffect(()=>{s[t]||ve.has(t)||(ve.add(t),tn(t).then(r=>{const n=`data:${r.data}`;xt.setKey(t,n),ve.delete(t)}).catch(()=>{ve.delete(t)}))},[t,s]),s[t]},_n=t=>{const s=/^(?:http|https):\/\/((?!(\d+\.){3}\d+)([^/?#]+))/,r=t.match(s);return r?r[1]:null},yt=t=>{const s=_n(t);if(s){const r=s.split(".");if(r.length>=2)return r.slice(-2).join(".")}return null},jn=t=>`https://icons.duckduckgo.com/ip3/${yt(t.site_url)??yt(t.feed_url)}.ico`,es=({feed:t,className:s="feed-icon"})=>{const{icon_id:r}=t.icon,n=jn(t);if(r===0)return e.jsx("img",{className:s,src:n,alt:""});const[o,i]=g.useState(n),a=yn(r);return g.useEffect(()=>{a&&i(a)},[a]),e.jsx("img",{className:s,src:o,alt:"",onError:()=>i(n)})},ts=Z.Item,bn=({category:t,path:s})=>{var a;const n=(a=p(Wt)[t.id])==null?void 0:a.reduce((l,c)=>l+c.unreadCount,0),o=ie(),i=()=>{o(`/category/${t.id}`),X(null)};return e.jsxs("div",{className:Re("category-title",{"active-subMenu":s===`/category/${t.id}`,"inactive-subMenu":s!==`/category/${t.id}`}),onClick:i,onKeyDown:l=>{(l.key==="Enter"||l.key===" ")&&i()},tabIndex:0,role:"button",style:{cursor:"pointer"},children:[e.jsx(_.Ellipsis,{expandable:!1,showTooltip:!0,style:{width:n?"80%":"100%",fontWeight:500},children:t.title}),n>0&&e.jsx(_.Ellipsis,{className:"unread-count",expandable:!1,style:{fontWeight:500},children:n})]})},vn=({count:t})=>e.jsx(_.Ellipsis,{className:"item-count",expandable:!1,children:t||""}),we=({path:t,Icon:s,label:r,count:n})=>{const o=Be(),i=ie(),a=o.pathname===t,l=()=>{i(t),X(null)};return e.jsx(ts,{onClick:l,className:Re("arco-menu-item",{"arco-menu-selected":a}),children:e.jsxs("div",{className:"custom-menu-item",children:[e.jsxs("span",{children:[e.jsx(s,{}),r]}),e.jsx(vn,{count:n})]})},t)},ss=()=>{const{homePage:t,showFeedIcon:s}=p(E),{historyCount:r,isAppDataReady:n,starredCount:o,unreadTodayCount:i}=p(U),a=p(Wt),l=p(nn),c=p(an),{polyglot:d}=p(V),u=Be(),h=ie(),[y,j]=g.useState([`/${t}`]),f=u.pathname;g.useEffect(()=>{j([f])},[f]);const b=()=>e.jsxs(e.Fragment,{children:[e.jsx(we,{path:"/all",Icon:bs,label:d.t("sidebar.all"),count:c}),e.jsx(we,{path:"/today",Icon:vs,label:d.t("sidebar.today"),count:i}),e.jsx(we,{path:"/starred",Icon:qe,label:d.t("sidebar.starred"),count:o}),e.jsx(we,{path:"/history",Icon:ws,label:d.t("sidebar.history"),count:r})]}),k=R=>{var T;return(T=a[R])==null?void 0:T.map(M=>e.jsx(ts,{style:{position:"relative",overflow:"hidden"},onClick:H=>{H.stopPropagation(),h(`/feed/${M.id}`),X(null)},children:e.jsxs("div",{className:"custom-menu-item",children:[e.jsxs(_.Ellipsis,{expandable:!1,showTooltip:!0,style:{width:M.unreadCount?"80%":"100%",paddingLeft:"20px",boxSizing:"border-box"},children:[s&&e.jsx(es,{feed:M,className:"feed-icon-sidebar"}),M.title]}),M.unreadCount!==0&&e.jsx(_.Ellipsis,{className:"item-count",expandable:!1,children:M.unreadCount})]})},`/feed/${M.id}`))},w=()=>l.map(R=>e.jsx(it.Item,{name:`/category/${R.id}`,style:{position:"relative",overflow:"hidden"},header:e.jsx(bn,{category:R,path:f}),expandIcon:e.jsx(Ss,{}),children:k(R.id)},R.id));return e.jsxs("div",{className:"sidebar-container",children:[e.jsxs(Z,{hasCollapseButton:!1,selectedKeys:y,children:[e.jsxs("div",{className:"menu-header",children:[e.jsx(Ct,{className:"avatar",size:32,children:e.jsx(js,{style:{color:"var(--color-bg-1)"}})}),e.jsx(_.Title,{heading:6,style:{margin:0},children:"ReactFlux"})]}),e.jsx(_.Title,{className:"section-title",heading:6,style:{paddingLeft:"12px"},children:d.t("sidebar.articles")}),e.jsx(Te,{loading:!n,animation:!0,text:{rows:3}}),n&&b(),e.jsx(_.Title,{className:"section-title",heading:6,style:{paddingLeft:"12px"},children:d.t("sidebar.feeds")})]}),e.jsx("div",{className:"feeds-menu-wrapper",children:e.jsx(He,{style:{maxHeight:"100%"},autoHide:!0,children:e.jsxs(Z,{autoScrollIntoView:!0,hasCollapseButton:!1,selectedKeys:y,children:[e.jsx(Te,{loading:!n,animation:!0,text:{rows:6}}),n&&e.jsx(it,{triggerRegion:"icon",bordered:!1,children:w()})]})})})]})},wn=()=>{const{showAllFeeds:t,theme:s}=p(E),{polyglot:r}=p(V),n=[{label:r.t("header.theme_option_light"),value:"light"},{label:r.t("header.theme_option_dark"),value:"dark"},{label:r.t("header.theme_option_system"),value:"system"}],o=ie(),i=Be().pathname,{setAddFeedModalVisible:a,setSettingsModalVisible:l}=Je(),{isBelowLarge:c}=ge(),[d,u]=g.useState(!1),[h,y]=g.useState(!1),[j,f]=g.useState(!1);g.useEffect(()=>{c||u(!1)},[c]),g.useEffect(()=>{i&&u(!1)},[i]);const b=()=>{W({showAllFeeds:!t})},k=()=>{W({theme:s==="light"?"dark":"light"})},w=()=>{kr(),y(!1)},R=()=>{Nr(),xn(),ln(),o("/login"),v.success(r.t("header.logout_success"))},T=()=>s==="dark"?e.jsx(As,{}):s==="system"?e.jsx(Ls,{}):e.jsx(Rs,{});return e.jsxs("div",{className:"header",children:[e.jsx("div",{className:"brand",children:e.jsx(F,{className:"trigger",onClick:()=>u(!d),shape:"circle",size:"small",children:e.jsx(Cs,{})})}),e.jsx(ks,{className:"sidebar-drawer",visible:d,title:null,footer:null,closable:!1,onCancel:()=>u(!1),placement:"left",width:240,children:e.jsx(ss,{})}),e.jsx("div",{className:"button-group",children:e.jsxs(Ie,{size:16,children:[e.jsx(de,{content:r.t("header.add_feed"),mini:!0,children:e.jsx(F,{shape:"circle",size:"small",type:"primary",icon:e.jsx(kt,{}),onClick:()=>a(!0)})}),e.jsx(de,{content:t?r.t("header.hide_some_feeds"):r.t("header.show_all_feeds"),mini:!0,children:e.jsx(F,{shape:"circle",size:"small",icon:t?e.jsx(Ts,{}):e.jsx(Is,{}),onClick:b})}),e.jsx(F,{shape:"circle",size:"small",icon:e.jsx(Fs,{}),onClick:()=>window.open("https://github.com/electh/ReactFlux","_blank")}),e.jsx(lt,{droplist:e.jsx(Z,{defaultSelectedKeys:[s],className:"theme-menu",children:n.map(({label:M,value:H})=>e.jsxs(Z.Item,{className:"theme-menu-item",onClick:()=>W({theme:H}),children:[M,s===H&&e.jsx(Tt,{style:{marginLeft:8}})]},H))}),trigger:"hover",position:"bottom",children:e.jsx(F,{icon:T(),shape:"circle",size:"small",onClick:k})}),e.jsx(lt,{droplist:e.jsxs(Z,{children:[e.jsxs(Z.Item,{onClick:()=>l(!0),children:[e.jsx(Es,{className:"icon-right"}),r.t("header.settings")]},"0"),e.jsxs(Z.Item,{onClick:()=>y(!0),children:[e.jsx(Fe,{className:"icon-right"}),r.t("header.reset_settings")]},"1"),e.jsxs(Z.Item,{onClick:()=>f(!0),children:[e.jsx(Ns,{className:"icon-right"}),r.t("header.logout")]},"2")]}),trigger:"click",position:"br",children:e.jsx(Ct,{size:28,style:{cursor:"pointer"},children:e.jsx(It,{})})})]})}),e.jsx(re,{title:r.t("header.settings_reset_confirm"),visible:h,onOk:w,onCancel:()=>y(!1),children:e.jsx("p",{children:r.t("header.settings_reset_description")})}),e.jsx(re,{title:r.t("header.logout_confirm"),visible:j,onOk:R,onCancel:()=>f(!1),children:e.jsx("p",{children:r.t("header.logout_description")})})]})},Sn=(t,s)=>{const r=t.split("."),n=s.split(".");for(let o=0;o<Math.max(r.length,n.length);o++){const i=r[o]||"0",a=n[o]||"0",l=i.localeCompare(a,void 0,{numeric:!0});if(l!==0)return l}return 0},st=()=>{const t=g.useRef(!1);return{fetchAppData:async()=>{if(!t.current){t.current=!0,pt(!1);try{const r=await Promise.all([Gr(),Ce(0,"unread"),Ut(),$t(),Kr(),Rr(),sn()]),[n,o,i,a,l,c,d]=r,u=l.reduce((h,y)=>(h[y.id]=n.unreads[y.id]??0,h),{});Kt(u),Gt(o.total??0),Oe(i.total??0),Ve(a.total??0),ae(l),ke(c),on(Sn(d.version,"2.2.0")>=0),pt(!0)}catch(r){console.error("Error fetching app data: ",r)}finally{t.current=!1}}}}},Ue={Red:{light:"#F53F3F",dark:"#F76965"},Orange:{light:"#F77234",dark:"#F9925A"},Gold:{light:"#F7BA1E",dark:"#F9CC44"},Green:{light:"#00B42A",dark:"#27C346"},Cyan:{light:"#14C9C9",dark:"#3FD4CF"},Blue:{light:"#165DFF",dark:"#3C7EFF"},Purple:{light:"#722ED1",dark:"#8E51DA"},Magenta:{light:"#F5319D",dark:"#F756A9"}},$e=t=>{const s=Ue[t]||Ue.Blue,r=window.matchMedia("(prefers-color-scheme: dark)").matches,n=B("theme");return(n==="system"?r:n==="dark")?s.dark:s.light},rs=t=>{Ms($e(t),{list:!0}).map(Ps).forEach((r,n)=>{document.body.style.setProperty(`--primary-${n+1}`,r)})},Cn=()=>{const{articleWidth:t,fontSize:s,fontFamily:r,layout:n,showDetailedRelativeTime:o,showFeedIcon:i,themeColor:a}=p(E),{polyglot:l}=p(V),c=d=>{W(d),d.themeColor&&rs(d.themeColor)};return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"setting-row",children:[e.jsxs("div",{children:[e.jsx(_.Title,{heading:6,style:{marginTop:0},children:l.t("appearance.theme_color_label")}),e.jsx(_.Text,{type:"secondary",children:l.t("appearance.theme_color_description")})]}),e.jsx("div",{style:{display:"flex"},children:Object.keys(Ue).map(d=>e.jsx("div",{style:{width:"18px",height:"18px",borderRadius:"50%",margin:"2px",backgroundColor:$e(d),cursor:"pointer",border:"3px solid var(--color-bg-3)",outline:d===a?`1px solid ${$e(d)}`:"none"},onClick:()=>c({themeColor:d}),onKeyDown:u=>{(u.key==="Enter"||u.key===" ")&&c({themeColor:d})},"aria-label":l.t("appearance.theme_color_aria_label",{color:d})},d))})]}),e.jsx(q,{}),e.jsxs("div",{className:"setting-row",children:[e.jsxs("div",{children:[e.jsx(_.Title,{heading:6,style:{marginTop:0},children:l.t("appearance.compact_article_list_label")}),e.jsx(_.Text,{type:"secondary",children:l.t("appearance.compact_article_list_description")})]}),e.jsx("div",{children:e.jsx(ee,{checked:n==="small",onChange:d=>c({layout:d?"small":"large"})})})]}),e.jsx(q,{}),e.jsxs("div",{className:"setting-row",children:[e.jsxs("div",{children:[e.jsx(_.Title,{heading:6,style:{marginTop:0},children:l.t("appearance.show_detailed_relative_time_label")}),e.jsx(_.Text,{type:"secondary",children:l.t("appearance.show_detailed_relative_time_description")})]}),e.jsx("div",{children:e.jsx(ee,{checked:o,onChange:d=>c({showDetailedRelativeTime:d})})})]}),e.jsx(q,{}),e.jsxs("div",{className:"setting-row",children:[e.jsxs("div",{children:[e.jsx(_.Title,{heading:6,style:{marginTop:0},children:l.t("appearance.show_feed_icon_label")}),e.jsx(_.Text,{type:"secondary",children:l.t("appearance.show_feed_icon_description")})]}),e.jsx("div",{children:e.jsx(ee,{checked:i,onChange:d=>c({showFeedIcon:d})})})]}),e.jsx(q,{}),e.jsxs("div",{className:"setting-row",children:[e.jsxs("div",{children:[e.jsx(_.Title,{heading:6,style:{marginTop:0},children:l.t("appearance.font_family_label")}),e.jsx(_.Text,{type:"secondary",children:l.t("appearance.font_family_description")})]}),e.jsx("div",{children:e.jsxs(C,{style:{width:200},value:r,onChange:d=>c({fontFamily:d}),children:[e.jsx(C.Option,{value:"system-ui",children:l.t("appearance.font_family_system")}),e.jsx(C.Option,{value:"'Noto Serif SC', serif",children:l.t("appearance.font_family_noto_serif")}),e.jsx(C.Option,{value:"'Noto Sans SC', sans-serif",children:l.t("appearance.font_family_noto_sans")})]})})]}),e.jsx(q,{}),e.jsxs("div",{className:"setting-row",children:[e.jsxs("div",{children:[e.jsx(_.Title,{heading:6,style:{marginTop:0},children:l.t("appearance.font_size_label")}),e.jsx(_.Text,{type:"secondary",children:l.t("appearance.font_size_description")})]}),e.jsx("div",{children:e.jsxs(Ie,{children:[e.jsx(_.Text,{style:{fontSize:"0.75rem"},children:"A"}),e.jsx(ct,{formatTooltip:d=>`${d}rem`,max:1.25,min:.75,showTicks:!0,step:.05,style:{width:200},value:s,onChange:d=>c({fontSize:d})}),e.jsx(_.Text,{style:{fontSize:"1.25rem"},children:"A"})]})})]}),e.jsx(q,{}),e.jsxs("div",{className:"setting-row",children:[e.jsxs("div",{children:[e.jsx(_.Title,{heading:6,style:{marginTop:0},children:l.t("appearance.article_width_label")}),e.jsx(_.Text,{type:"secondary",children:l.t("appearance.article_width_description")})]}),e.jsx("div",{children:e.jsxs(Ie,{children:[e.jsx(_.Text,{children:"60%"}),e.jsx(ct,{formatTooltip:d=>`${d}%`,max:90,min:60,showTicks:!0,step:10,style:{width:160},value:t,onChange:d=>c({articleWidth:d})}),e.jsx(_.Text,{children:"90%"})]})})]})]})},kn=()=>{const t=p(xe),{polyglot:s}=p(V),[r]=P.useForm(),[n,o]=g.useState(!1),[i,a]=g.useState(""),[l,c]=g.useState({}),[d,u]=g.useState(!1),h=async()=>{if(i.trim()){try{const f=await Mr(i);ke(b=>[...b,{...f}]),v.success(s.t("category_list.add_category_success"))}catch(f){console.error(`${s.t("category_list.add_category_error")}: `,f),v.error(s.t("category_list.add_category_error"))}a(""),u(!1)}},y=async(f,b,k)=>{try{const w=await Dr(f,b,k);ae(R=>R.map(T=>T.category.id===f?{...T,category:{...T.category,title:b,hide_globally:k}}:T)),ke(R=>R.map(T=>T.id===f?{...T,...w}:T)),v.success(s.t("category_list.update_category_success"))}catch{v.error(s.t("category_list.update_category_error"))}o(!1),r.resetFields()},j=async f=>{try{(await Pr(f.id)).status===204?(ke(k=>k.filter(w=>w.id!==f.id)),v.success(s.t("category_list.remove_category_success",{title:f.title}))):v.error(s.t("category_list.remove_category_error",{title:f.title}))}catch(b){console.error(s.t("category_list.remove_category_error",{title:f.title}),b),v.error(s.t("category_list.remove_category_error",{title:f.title}))}};return e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[t.map(f=>e.jsx(pe,{className:"tag-style",closable:f.feedCount===0,size:"medium",onClick:()=>{c(f),o(!0),r.setFieldsValue({title:f.title})},onClose:async b=>{b.stopPropagation(),await j(f)},children:f.title},f.id)),d?e.jsx(K,{autoFocus:!0,className:"input-style",onBlur:h,onChange:a,onPressEnter:h,size:"small",value:i}):e.jsx(pe,{className:"add-category-tag",icon:e.jsx(kt,{}),onClick:()=>u(!0),size:"medium",tabIndex:0})]}),l&&e.jsx(re,{className:"modal-style",onOk:r.submit,title:"Edit Category",unmountOnExit:!0,visible:n,onCancel:()=>{o(!1),r.resetFields()},children:e.jsxs(P,{form:r,layout:"vertical",onSubmit:f=>y(l.id,f.title,f.hidden),labelCol:{style:{flexBasis:90}},wrapperCol:{style:{flexBasis:"calc(100% - 90px)"}},children:[e.jsx(P.Item,{label:"Title",field:"title",rules:[{required:!0}],children:e.jsx(K,{placeholder:"Please input category title"})}),e.jsx(P.Item,{label:"Hidden",field:"hidden",initialValue:l.hide_globally,triggerPropName:"checked",rules:[{type:"boolean"}],children:e.jsx(ee,{})})]})})]})},Tn=t=>new Promise(s=>setTimeout(s,t)),In=(t,s,r=!1)=>{let n;return function(...o){const i=()=>{n=null,r||t.apply(this,o)},a=r&&!n;clearTimeout(n),n=setTimeout(i,s),a&&t.apply(this,o)}},ns=We(""),_t=A(ns),rt=We("title"),Fn=A(rt),as=J([U,ns,rt],(t,s,r)=>{const{feedsData:n}=t,o=[...n].sort((i,a)=>i.disabled&&!a.disabled?1:!i.disabled&&a.disabled?-1:0).sort((i,a)=>a.parsing_error_count-i.parsing_error_count);return s?Xt(o,s,[r]):o}),En=J(as,t=>t.map(s=>({category:s.category,checked_at:s.checked_at,crawler:s.crawler,disabled:s.disabled,feed_url:s.feed_url,hidden:s.hide_globally,key:s.id,parsing_error_count:s.parsing_error_count,site_url:s.site_url,title:s.title}))),jt=(t,s,r=null)=>r===null||r===t.id?{...t,parsing_error_count:s?0:t.parsing_error_count+1,checked_at:Ur()}:t,Nn=()=>{const t=p(xe),{isAppDataReady:s}=p(U),{showDetailedRelativeTime:r}=p(E),n=p(as),o=p(rt),i=p(En),{polyglot:a}=p(V),l=a.t("search.tooltip").split(`
`),[c,d]=g.useState(!1),[u]=P.useForm(),[h,y]=g.useState(!1),[j,f]=g.useState(""),[b,k]=g.useState(null),{isBelowMedium:w}=ge();g.useEffect(()=>{_t("")},[]);const R=m=>{k(m),y(!0),u.setFieldsValue({category:m.category.id,title:m.title,siteUrl:m.site_url,feedUrl:m.feed_url,hidden:m.hidden,disabled:m.disabled,crawler:m.crawler})},T=async(m,x,I=!0)=>{try{const D=(await m()).status===204;return I&&(D?v.success(a.t("feed_table.refresh_success")):v.error(a.t("feed_table.refresh_error"))),ae(ne=>ne.map(le=>x(le,D))),D}catch{return I&&v.error(a.t("feed_table.refresh_error")),ae(D=>D.map(ne=>x(ne,!1))),!1}},M=async(m,x=!0)=>{const I=m.id||m.key;return T(()=>Yr(I),(z,D)=>jt(z,D,I),x)},H=async()=>{try{const m=await Promise.all(n.map(async x=>{const I=new URL(x.feed_url).hostname;if(I===j)return x;const z=x.feed_url.replace(I,j),D=await ft(x.id,{feedUrl:z});return{...x,...D}}));ae(x=>x.map(I=>m.find(z=>z.id===I.id)||I)),v.success(a.t("feed_table.bulk_update_success")),d(!1)}catch{v.error(a.t("feed_table.bulk_update_error"))}},te=()=>{const[m,x]=g.useState(!1),I=async()=>{x(!1),await T(Xr,jt)},z=async()=>{x(!1);const ne=n.filter(Q=>Q.parsing_error_count>0);v.success(a.t("feed_table.bulk_refresh_error_feeds_message"));let le=0,_e=0;for(const Q of ne)await M(Q,!1)?le++:_e++,await Tn(500);v.success(a.t("feed_table.bulk_refresh_error_feeds_result",{success:le,failure:_e}))},D=()=>x(!1);return e.jsxs(e.Fragment,{children:[e.jsx(F,{icon:e.jsx(Fe,{}),shape:"circle",size:"small",onClick:()=>x(!0)}),e.jsx(re,{className:"edit-modal",onCancel:D,title:a.t("feed_table.refresh_feeds_title"),visible:m,footer:[e.jsx(F,{onClick:D,children:a.t("feed_table.refresh_feeds_cancel")},"cancel"),e.jsx(F,{type:"outline",onClick:z,children:a.t("feed_table.refresh_feeds_error")},"error"),e.jsx(F,{type:"primary",onClick:I,children:a.t("feed_table.refresh_feeds_all")},"all")],children:e.jsx("p",{children:a.t("feed_table.refresh_feeds_description")})})]})},N=async m=>{try{(await Qr(m.key)).status===204?(ae(I=>I.filter(z=>z.id!==m.key)),v.success(a.t("feed_table.remove_feed_success",{title:m.title}))):v.error(a.t("feed_table.remove_feed_error",{title:m.title}))}catch(x){console.error(`Failed to unfollow feed: ${m.title}`,x),v.error(a.t("feed_table.remove_feed_error",{title:m.title}))}},O=[{title:a.t("feed_table.table_title"),dataIndex:"title",sorter:(m,x)=>m.title.localeCompare(x.title,"en"),render:(m,x)=>{const I=x.parsing_error_count;let z=x.disabled?`🚫 ${m}`:m;I>0&&(z=`⚠️ ${m}`);const D=e.jsxs("div",{children:[m,I>0&&e.jsxs(e.Fragment,{children:[e.jsx("br",{}),"⚠️ Parsing error count: ",I]})]});return e.jsx(_.Ellipsis,{expandable:!1,children:e.jsx(de,{mini:!0,content:D,children:z})})}},!w&&{title:a.t("feed_table.table_url"),dataIndex:"feed_url",sorter:(m,x)=>m.feed_url.localeCompare(x.feed_url,"en"),render:m=>e.jsx(_.Ellipsis,{expandable:!1,showTooltip:!0,children:m})},{title:a.t("feed_table.table_category"),dataIndex:"category.title",sorter:(m,x)=>m.category.title.localeCompare(x.category.title,"en"),render:m=>e.jsx(_.Ellipsis,{expandable:!1,showTooltip:!0,children:e.jsx(pe,{children:m})})},!w&&{title:a.t("feed_table.table_checked_at"),dataIndex:"checked_at",sorter:(m,x)=>m.checked_at.localeCompare(x.checked_at,"en"),render:m=>e.jsx(_.Ellipsis,{expandable:!1,children:Ot(m,r)})},{title:a.t("feed_table.table_actions"),dataIndex:"op",fixed:"right",width:100,render:(m,x)=>e.jsxs(Ie,{children:[e.jsx("button",{"aria-label":a.t("feed_table.table_feed_edit_label"),className:"list-item-action",onClick:()=>R(x),type:"button",children:e.jsx(dt,{})}),e.jsx("button",{"aria-label":a.t("feed_table.table_feed_refresh_label"),className:"list-item-action",onClick:()=>M(x),type:"button",children:e.jsx(Fe,{})}),e.jsx(Ft,{focusLock:!0,position:"left",title:a.t("feed_table.table_feed_remove_confirm"),onOk:()=>N(x),children:e.jsx("span",{className:"list-item-action",children:e.jsx(Ds,{})})})]})}].filter(Boolean),G=async(m,x)=>{try{const I=await ft(m,x);ae(z=>z.map(D=>D.id===m?{...D,...I}:D)),v.success(a.t("feed_table.update_feed_success")),y(!1),u.resetFields()}catch{v.error(a.t("feed_table.update_feed_error"))}};return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"feed-table-action-bar",children:[e.jsx("div",{style:{display:"flex",flex:1,justifyContent:"center",minWidth:0},children:e.jsx(K.Search,{allowClear:!0,className:"search-input",onChange:_t,placeholder:a.t("search.placeholder"),addBefore:e.jsxs(C,{onChange:Fn,style:{width:126},value:o,children:[e.jsx(C.Option,{value:"title",children:a.t("search.type_title")}),e.jsx(C.Option,{value:"feed_url",children:a.t("search.type_feed_url")}),e.jsx(C.Option,{value:"site_url",children:a.t("search.type_site_url")})]})})}),e.jsxs("div",{className:"button-group",children:[e.jsx(de,{mini:!0,position:"bottom",content:e.jsx("div",{children:l.map((m,x)=>e.jsxs(g.Fragment,{children:[m,x<l.length-1&&e.jsx("br",{})]},`line-${x}-${m.length}`))}),children:e.jsx(F,{shape:"circle",size:"small",icon:e.jsx(Et,{})})}),e.jsx(F,{icon:e.jsx(dt,{}),shape:"circle",size:"small",onClick:()=>d(!0)}),e.jsxs(re,{className:"edit-modal",onOk:H,title:a.t("feed_table.modal_bulk_update_title"),visible:c,onCancel:()=>{d(!1),f("")},children:[e.jsx("p",{children:a.t("feed_table.modal_bulk_update_description")}),e.jsx(K,{placeholder:"rsshub.app",value:j,onChange:m=>f(m)})]}),e.jsx(te,{})]})]}),e.jsx(Nt,{borderCell:!0,className:"feed-table",columns:O,data:i,loading:!s,pagePosition:"bottomCenter",scroll:{x:!0},size:"small"}),b&&e.jsx(re,{className:"edit-modal",onOk:u.submit,title:a.t("feed_table.modal_edit_feed_title"),unmountOnExit:!0,visible:h,onCancel:()=>{y(!1),u.resetFields()},children:e.jsxs(P,{form:u,labelCol:{span:7},layout:"vertical",wrapperCol:{span:17},onSubmit:async m=>{const x={categoryId:m.category,title:m.title,siteUrl:m.siteUrl.trim(),feedUrl:m.feedUrl.trim(),hidden:m.hidden,disabled:m.disabled,isFullText:m.crawler};x.feedUrl?await G(b.key,x):v.error(a.t("feed_table.modal_edit_feed_submit_error"))},children:[e.jsx(P.Item,{label:a.t("feed_table.modal_edit_feed_category_label"),required:!0,field:"category",rules:[{required:!0}],children:e.jsx(C,{children:t.map(m=>e.jsx(C.Option,{value:m.id,children:m.title},m.id))})}),e.jsx(P.Item,{label:a.t("feed_table.modal_edit_feed_title_label"),field:"title",rules:[{required:!0}],children:e.jsx(K,{placeholder:a.t("feed_table.modal_edit_feed_title_placeholder")})}),e.jsx(P.Item,{label:a.t("feed_table.modal_edit_feed_site_url_label"),field:"siteUrl",rules:[{required:!0}],children:e.jsx(K,{placeholder:a.t("feed_table.modal_edit_feed_site_url_placeholder")})}),e.jsx(P.Item,{label:a.t("feed_table.modal_edit_feed_feed_url_label"),field:"feedUrl",rules:[{required:!0}],children:e.jsx(K,{placeholder:a.t("feed_table.modal_edit_feed_feed_url_placeholder")})}),e.jsx(P.Item,{label:a.t("feed_table.modal_edit_feed_hidden_label"),field:"hidden",initialValue:b.hidden,triggerPropName:"checked",rules:[{type:"boolean"}],children:e.jsx(ee,{})}),e.jsx(P.Item,{label:a.t("feed_table.modal_edit_feed_disabled_label"),field:"disabled",initialValue:b.disabled,triggerPropName:"checked",rules:[{type:"boolean"}],children:e.jsx(ee,{})}),e.jsx(P.Item,{label:a.t("feed_table.modal_edit_feed_crawler_label"),field:"crawler",tooltip:e.jsx("div",{children:a.t("feed_table.modal_edit_feed_crawler_tooltip")}),triggerPropName:"checked",rules:[{type:"boolean"}],children:e.jsx(ee,{})})]})})]})},An=[{label:"English",value:"en-US"},{label:"Español",value:"es-ES"},{label:"简体中文",value:"zh-CN"}],Ln=()=>{const{homePage:t,language:s,markReadOnScroll:r,orderBy:n,pageSize:o,removeDuplicates:i}=p(E),{polyglot:a}=p(V);return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"setting-row",children:[e.jsxs("div",{children:[e.jsx(_.Title,{heading:6,style:{marginTop:0},children:a.t("appearance.language_label")}),e.jsx(_.Text,{type:"secondary",children:a.t("appearance.language_description")})]}),e.jsx("div",{children:e.jsx(C,{className:"input-select",onChange:l=>W({language:l}),value:s,children:An.map(({label:l,value:c})=>e.jsx(C.Option,{value:c,children:l},c))})})]}),e.jsx(q,{}),e.jsxs("div",{className:"setting-row",children:[e.jsxs("div",{children:[e.jsx(_.Title,{heading:6,style:{marginTop:0},children:a.t("settings.default_home_page_label")}),e.jsx(_.Text,{type:"secondary",children:a.t("settings.default_home_page_description")})]}),e.jsx("div",{children:e.jsxs(C,{className:"input-select",onChange:l=>W({homePage:l}),value:t,children:[e.jsx(C.Option,{value:"all",children:a.t("settings.default_home_page_option_all")}),e.jsx(C.Option,{value:"today",children:a.t("settings.default_home_page_option_today")}),e.jsx(C.Option,{value:"starred",children:a.t("settings.default_home_page_option_starred")}),e.jsx(C.Option,{value:"history",children:a.t("settings.default_home_page_option_history")})]})})]}),e.jsx(q,{}),e.jsxs("div",{className:"setting-row",children:[e.jsxs("div",{children:[e.jsx(_.Title,{heading:6,style:{marginTop:0},children:a.t("settings.entries_order_label")}),e.jsx(_.Text,{type:"secondary",children:a.t("settings.entries_order_description")})]}),e.jsx("div",{children:e.jsxs(C,{className:"input-select",onChange:l=>W({orderBy:l}),value:n,children:[e.jsx(C.Option,{value:"published_at",children:a.t("settings.entries_order_option_published_at")}),e.jsx(C.Option,{value:"created_at",children:a.t("settings.entries_order_option_created_at")})]})})]}),e.jsx(q,{}),e.jsxs("div",{className:"setting-row",children:[e.jsxs("div",{children:[e.jsx(_.Title,{heading:6,style:{marginTop:0},children:a.t("settings.entries_per_page_label")}),e.jsx(_.Text,{type:"secondary",children:a.t("settings.entries_per_page_description")})]}),e.jsx("div",{children:e.jsx(Vs,{className:"input-select",defaultValue:o,min:1,mode:"button",onChange:l=>W({pageSize:l}),size:"small"})})]}),e.jsx(q,{}),e.jsxs("div",{className:"setting-row",children:[e.jsxs("div",{children:[e.jsx(_.Title,{heading:6,style:{marginTop:0},children:a.t("settings.remove_duplicates_label")}),e.jsx(_.Text,{type:"secondary",children:a.t("settings.remove_duplicates_description")})]}),e.jsx("div",{children:e.jsxs(C,{className:"input-select",onChange:l=>W({removeDuplicates:l}),value:i,children:[e.jsx(C.Option,{value:"none",children:a.t("settings.remove_duplicates_option_none")}),e.jsx(C.Option,{value:"hash",children:a.t("settings.remove_duplicates_option_hash")}),e.jsx(C.Option,{value:"title",children:a.t("settings.remove_duplicates_option_title")}),e.jsx(C.Option,{value:"url",children:a.t("settings.remove_duplicates_option_url")})]})})]}),e.jsx(q,{}),e.jsxs("div",{className:"setting-row",children:[e.jsxs("div",{children:[e.jsx(_.Title,{heading:6,style:{marginTop:0},children:a.t("settings.mark_read_on_scroll_label")}),e.jsx(_.Text,{type:"secondary",children:a.t("settings.mark_read_on_scroll_description")})]}),e.jsx("div",{children:e.jsx(ee,{checked:r,onChange:l=>W({markReadOnScroll:l})})})]})]})},Rn=()=>{const{polyglot:t}=p(V),s=[{title:t.t("hotkeys.key"),dataIndex:"keyName",render:n=>e.jsx(pe,{children:n})},{title:t.t("hotkeys.function"),dataIndex:"description"}],r=[{key:"1",keyName:"Esc",description:t.t("hotkeys.esc")},{key:"2",keyName:"←",description:t.t("hotkeys.left")},{key:"3",keyName:"Ctrl + ←",description:t.t("hotkeys.ctrl_left")},{key:"4",keyName:"→",description:t.t("hotkeys.right")},{key:"5",keyName:"Ctrl + →",description:t.t("hotkeys.ctrl_right")},{key:"6",keyName:"A",description:t.t("hotkeys.a")},{key:"7",keyName:"B",description:t.t("hotkeys.b")},{key:"8",keyName:"D",description:t.t("hotkeys.d")},{key:"9",keyName:"M",description:t.t("hotkeys.m")},{key:"10",keyName:"S",description:t.t("hotkeys.s")},{key:"11",keyName:"V",description:t.t("hotkeys.v")}];return e.jsx(Nt,{borderCell:!0,columns:s,data:r,pagination:!1,size:"small",style:{margin:"0 auto",width:"90%"}})},Mn=()=>{const{polyglot:t}=p(V),s=(r,n)=>e.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center"},children:[r,e.jsx("div",{style:{fontSize:"12px"},children:n})]});return e.jsxs(ce,{className:"custom-tabs",defaultActiveTab:"1",tabPosition:"top",animation:!0,children:[e.jsx(ce.TabPane,{title:s(e.jsx(Os,{style:{fontSize:"20px"}}),t.t("settings.feeds")),children:e.jsx(Nn,{})},"1"),e.jsx(ce.TabPane,{title:s(e.jsx(zs,{style:{fontSize:"20px"}}),t.t("settings.categories")),children:e.jsx(kn,{})},"2"),e.jsx(ce.TabPane,{title:s(e.jsx(Us,{style:{fontSize:"20px"}}),t.t("settings.general")),children:e.jsx(Ln,{})},"3"),e.jsx(ce.TabPane,{title:s(e.jsx($s,{style:{fontSize:"20px"}}),t.t("settings.appearance")),children:e.jsx(Cn,{})},"4"),e.jsx(ce.TabPane,{title:s(e.jsx(Bs,{style:{fontSize:"20px"}}),t.t("settings.hotkeys")),children:e.jsx(Rn,{})},"5")]})},Pn=[{required:!0}],Dn=[{required:!0}],Vn=[{type:"boolean"}],On=()=>{const{setSettingsModalVisible:t,settingsModalVisible:s}=Je();return e.jsx(re,{alignCenter:!1,autoFocus:!1,className:"settings-modal",focusLock:!0,footer:null,onCancel:()=>t(!1),title:null,unmountOnExit:!0,visible:s,children:e.jsx(Mn,{})})},zn=()=>{const t=p(xe),{polyglot:s}=p(V),{addFeedModalVisible:r,setAddFeedModalVisible:n}=Je(),[o,i]=g.useState(!1),[a]=P.useForm(),{fetchAppData:l}=st(),c=async(d,u,h)=>{i(!0);try{await Jr(d,u,h),await l(),v.success(s.t("main.add_feed_success")),n(!1),a.resetFields()}catch{v.error(s.t("main.add_feed_error"))}finally{i(!1)}};return e.jsx(re,{title:s.t("main.add_feed_modal_title"),visible:r,unmountOnExit:!0,style:{width:"400px"},onOk:a.submit,confirmLoading:o,onCancel:()=>{n(!1),a.resetFields()},children:e.jsxs(P,{form:a,labelCol:{span:7},layout:"vertical",wrapperCol:{span:17},onSubmit:async d=>{const u=d.url.trim();u?await c(u,d.category,d.crawler):v.error(s.t("main.add_feed_url_empty"))},children:[e.jsx(P.Item,{label:s.t("main.add_feed_modal_feed_url_label"),field:"url",rules:Pn,children:e.jsx(K,{placeholder:s.t("main.add_feed_modal_feed_url_placeholder")})}),e.jsx(P.Item,{field:"category",label:s.t("main.add_feed_modal_category_label"),required:!0,rules:Dn,children:e.jsx(C,{placeholder:s.t("main.add_feed_modal_category_placeholder"),showSearch:!0,filterOption:(d,u)=>mn(u.props.children,d),children:t.map(d=>e.jsx(C.Option,{value:d.id,children:d.title},d.id))})}),e.jsx(P.Item,{field:"crawler",initialValue:!1,label:s.t("main.add_feed_modal_crawler_label"),rules:Vn,style:{marginBottom:0},triggerPropName:"checked",children:e.jsx(ee,{})})]})})},Un=()=>e.jsxs("div",{className:"main",children:[e.jsx(Hs,{}),e.jsx(On,{}),e.jsx(zn,{})]}),os=()=>{const{theme:t,themeColor:s}=p(E),[r,n]=g.useState(window.matchMedia("(prefers-color-scheme: dark)").matches);g.useEffect(()=>{const o=window.matchMedia("(prefers-color-scheme: dark)"),i=a=>n(a.matches);return o.addEventListener("change",i),()=>o.removeEventListener("change",i)},[]),g.useEffect(()=>{const o=i=>{const a=i?"dark":"light";document.body.setAttribute("arco-theme",a),document.body.style.colorScheme=a};rs(s),o(t==="system"?r:t==="dark")},[r,t,s])},is=()=>{const t=document.querySelector(".spinner");t&&(t.style.display="none")},$n=()=>{Pt(),os();const{isBelowLarge:t}=ge(),{polyglot:s}=p(V);return g.useEffect(()=>{is()},[]),s&&e.jsxs("div",{className:"app",children:[t?null:e.jsx(qs.Sider,{breakpoint:"lg",className:"sidebar",collapsible:!1,trigger:null,width:240,children:e.jsx(ss,{})}),e.jsx(wn,{}),e.jsx(Un,{})]})},ls=t=>{const r=new DOMParser().parseFromString(t,"text/html").querySelectorAll("img");return Array.from(r).map(n=>n.getAttribute("src"))},cs=t=>{var o;const n=(o=new DOMParser().parseFromString(t.content,"text/html").querySelector("img"))==null?void 0:o.getAttribute("src");return{...t,imgSrc:n}},Bn=t=>{if((t==null?void 0:t.total)>=0){const s=t.entries.map(cs);ye(s),gn(t.total),Qt(s.length<t.total)}},Hn=t=>{const{isAppDataReady:s}=p(U),{showStatus:r}=p(E),n=g.useRef(!1),o=async i=>{if(!n.current){n.current=!0,gt(!1);try{const a=r==="unread"?await i(0,"unread"):await i();gt(!0),oe(!0),Bn(a)}catch(a){console.error("Error fetching articles: ",a),oe(!1)}finally{n.current=!1}}};return g.useEffect(()=>{s&&o(t)},[s]),{fetchArticleList:o}},ds=We(!1),bt=A(ds),nt=()=>{const{offset:t}=p(L),{pageSize:s,showStatus:r}=p(E),n=p(ds),o=a=>{const l=(c,d)=>d.filter(u=>!c.some(h=>h.id===u.id));ye(c=>[...c,...l(c,a)]),Zt(c=>c+s)};return{handleLoadMore:async a=>{var l;bt(!0);try{const c=r==="unread"?await a(t+s,"unread"):await a(t+s);if(((l=c==null?void 0:c.entries)==null?void 0:l.length)>0){const d=c.entries.map(cs);o(d)}else Qt(!1)}catch(c){console.error("Error fetching more articles: ",c)}finally{bt(!1)}},loadingMore:n}},at=ue({isPhotoSliderVisible:!1,selectedIndex:0}),qn=A(at,"isPhotoSliderVisible"),Wn=A(at,"selectedIndex"),us=()=>{const{isPhotoSliderVisible:t,selectedIndex:s}=p(at);return{isPhotoSliderVisible:t,setIsPhotoSliderVisible:qn,selectedIndex:s,setSelectedIndex:Wn}},hs=(t,s)=>{const{activeContent:r,loadMoreVisible:n}=p(L),o=p(tt),{isPhotoSliderVisible:i,setIsPhotoSliderVisible:a,setSelectedIndex:l}=us(),{loadingMore:c}=nt(),[d,u]=g.useState(!1),[h,y]=g.useState(!1);g.useEffect(()=>{h&&!c&&(u(!1),y(!1),k())},[c,h]),g.useEffect(()=>{var N;r&&((N=document.querySelector(".card-custom-selected-style"))==null||N.scrollIntoView({behavior:"smooth",block:"nearest"}))},[r]);const j=N=>(...O)=>{if(r)return N(...O)},f=j(()=>{X(null),s.current&&s.current.contentWrapperEl.focus()}),b=(N=!1)=>{const O=o.findIndex(G=>G.id===(r==null?void 0:r.id));if(O>0){const G=N?o.slice(0,O).toReversed().find(m=>m.status==="unread"):o[O-1];G&&t(G)}},k=(N=!1)=>{if(d)return;const O=o.findIndex(x=>x.id===(r==null?void 0:r.id));if(O===o.length-1&&n){u(!0),y(!0);return}if(O===-1){s.current.contentWrapperEl.scrollTo({top:0,left:0,behavior:"smooth"});return}const m=N?o.slice(O+1).find(x=>x.status==="unread"):o[O+1];m&&(t(m),y(!1))},w=j(()=>{window.open(r.url,"_blank")}),R=j(N=>{N()}),T=j(N=>{N()}),M=j(N=>{N()}),H=j(N=>{N()}),te=j(()=>{!ls(r.content).length||i||(l(0),a(!0),oe(!1))});return{exitDetailView:f,fetchOriginalArticle:R,navigateToNextArticle:k,navigateToPreviousArticle:b,openLinkExternally:w,openPhotoSlider:te,saveToThirdPartyServices:T,toggleReadStatus:M,toggleStarStatus:H}},Kn=({handleEntryClick:t,entryListRef:s})=>{const{activeContent:r}=p(L),{handleFetchContent:n,handleSaveToThirdPartyServices:o,handleToggleStarred:i,handleToggleStatus:a}=et(),{exitDetailView:l,navigateToNextArticle:c,navigateToPreviousArticle:d}=hs(t,s);if(!r)return null;const u=r.status==="unread",h=r.starred;return e.jsxs(F.Group,{className:"action-buttons",children:[e.jsx(F,{icon:e.jsx(Ws,{}),onClick:()=>l(),shape:"round",type:"primary"}),e.jsx(F,{icon:u?e.jsx(At,{}):e.jsx(Lt,{}),onClick:()=>a(r),type:"primary"}),e.jsx(F,{icon:h?e.jsx(Ke,{style:{color:"#ffcd00"}}):e.jsx(qe,{}),onClick:()=>i(r),type:"primary"}),e.jsx(F,{icon:e.jsx(Ks,{}),onClick:o,type:"primary"}),e.jsx(F,{icon:e.jsx(Gs,{}),onClick:()=>d(),type:"primary"}),e.jsx(F,{icon:e.jsx(Ys,{}),onClick:()=>c(),type:"primary"}),e.jsx(F,{icon:e.jsx(Xs,{}),onClick:n,shape:"round",type:"primary"})]})},Gn=({url:t,text:s})=>{const[r,n]=g.useState(!1),o=()=>n(!r);return e.jsx(er,{to:t,style:{color:"inherit",textDecoration:r?"underline":"none"},onMouseEnter:o,onMouseLeave:o,children:s})},vt=({node:t,index:s,togglePhotoSlider:r,isLinkWrapper:n=!1})=>{var f;const{fontSize:o}=p(E),[i,a]=g.useState(!1),[l,c]=g.useState(!1),{isBelowMedium:d}=ge();g.useEffect(()=>{const k=(n?t.children[0]:t).attribs.src,w=new Image;w.src=k,w.onload=()=>c(w.width<=100&&w.height<=100)},[t,n]);const u=n?t.children[0]:t,h=()=>e.jsx("img",{...u.attribs,alt:u.attribs.alt??"image",style:l?{display:"inline-block",width:"auto",height:`${o}rem`,margin:0}:{}});if(l)return n?e.jsxs("a",{...t.attribs,children:[h(),(f=t.children[1])==null?void 0:f.data]}):h();const y=()=>a(!0),j=()=>a(!1);return e.jsx("div",{style:{textAlign:"center",position:"relative"},children:e.jsxs("div",{style:{display:"inline-block",position:"relative"},onMouseEnter:y,onMouseLeave:j,children:[n?e.jsx("a",{...t.attribs,children:h()}):h(),e.jsx(F,{icon:e.jsx(tr,{}),shape:"circle",style:{position:"absolute",top:30,right:10,color:"white",backgroundColor:"rgba(0, 0, 0, 0.5)",opacity:d||i?1:0,transition:"opacity 0.3s"},onClick:b=>{b.preventDefault(),r(s)}})]})})},Yn=(t,s)=>({replace:r=>{if(r.type==="tag"&&r.name==="a"&&r.children.length>0){const n=r.children[0];if(n.type==="tag"&&n.name==="img"){const o=t.findIndex(i=>i===n.attribs.src);return e.jsx(vt,{node:r,index:o,togglePhotoSlider:s,isLinkWrapper:!0})}}else if(r.type==="tag"&&r.name==="img"){const n=t.findIndex(o=>o===r.attribs.src);return e.jsx(vt,{node:r,index:n,togglePhotoSlider:s})}return r}}),Xn=g.forwardRef(({handleEntryClick:t,entryListRef:s},r)=>{const n=ie(),{activeContent:o}=p(L),{articleWidth:i,fontSize:a,fontFamily:l}=p(E),{isPhotoSliderVisible:c,setIsPhotoSliderVisible:d,selectedIndex:u,setSelectedIndex:h}=us(),y=()=>{Le("author"),Ae(o.author)},j=T=>{h(T),d(M=>!M),oe(M=>!M)};if(!o)return e.jsxs("div",{ref:r,className:"content-empty",children:[e.jsx(Js,{style:{fontSize:"64px"}}),e.jsx(_.Title,{heading:6,style:{color:"var(--color-text-3)",marginTop:"10px"},children:"ReactFlux"})]});const f=ls(o.content),b=Yn(f,j),k=Qs(o.content,b),{id:w,title:R}=o.feed.category;return e.jsxs("article",{className:"article-content",onBlur:()=>oe(!1),onFocus:()=>oe(!0),ref:r,tabIndex:-1,children:[e.jsxs(He,{className:"scroll-container",children:[e.jsxs("div",{className:"article-header",style:{width:`${i}%`},children:[e.jsx(_.Title,{className:"article-title",heading:3,children:e.jsx("a",{href:o.url,target:"_blank",rel:"noopener noreferrer",children:o.title})}),e.jsxs("div",{className:"article-meta",children:[e.jsx(_.Text,{children:e.jsx(Gn,{url:`/feed/${o.feed.id}`,text:o.feed.title})}),e.jsx(_.Text,{onClick:y,style:{cursor:"pointer"},children:` - ${o.author}`}),e.jsx(_.Text,{children:e.jsx(pe,{size:"small",style:{marginLeft:"10px",cursor:"pointer"},onClick:()=>n(`/category/${w}`),children:R})})]}),e.jsx(_.Text,{className:"article-date",children:$r(o.published_at)}),e.jsx("br",{}),e.jsx(_.Text,{className:"article-date",children:zt(o.reading_time)}),e.jsx(q,{})]}),e.jsxs("div",{className:"article-body",style:{fontSize:`${a}rem`,width:`${i}%`,fontFamily:l},children:[k,e.jsx(Zs,{images:f.map(T=>({src:T,key:T})),loop:!1,visible:c,onClose:()=>{d(!1),oe(!0)},index:u,onIndexChange:h})]},o.id)]}),e.jsx(Kn,{handleEntryClick:t,entryListRef:s})]})}),Jn=({alt:t,borderRadius:s,height:r,src:n,status:o,width:i})=>{const[a,l]=g.useState(!1),{ref:c}=Me({triggerOnce:!0,onChange:(d,u)=>{if(d&&!a){const h=new Image;h.onload=()=>l(!0),h.onerror=()=>{u.target.style.display="none"},h.src=n}}});return e.jsx("div",{className:"image-container",ref:c,children:e.jsx("div",{className:"img-placeholder",style:{width:"100%",height:"100%",backgroundColor:"var(--color-fill-2)",position:"absolute",left:0,top:0},children:a?e.jsx("img",{className:o==="unread"?"":"read",src:n,alt:t,style:{width:i,height:r,objectFit:"cover",borderRadius:s}}):e.jsx("div",{className:"skeleton-container",children:e.jsx(Te,{text:{rows:0},image:{style:{width:i,height:r,margin:"0",borderRadius:s}},animation:!0})})})})},Qn=({entry:t,isThumbnail:s})=>{if(!t.imgSrc)return null;const r=s?{width:"80px",height:"80px"}:{width:"100%",height:"160px"};return e.jsx("div",{className:s?"thumbnail":"cover-image",children:e.jsx(Jn,{alt:t.id,borderRadius:s?"2px":void 0,src:t.imgSrc,status:t.status,width:r.width,height:r.height})})},Zn=({entry:t,showFeedIcon:s,mini:r,children:n})=>{const{showDetailedRelativeTime:o}=p(E),i=Re({"article-card-mini-content":r,"article-card-mini-content-padding":r&&s});return e.jsxs("div",{className:i,style:{width:"100%",boxSizing:"border-box",opacity:t.status==="unread"?1:.5},children:[e.jsx("div",{style:{padding:t.imgSrc?r?"0 10px 0 0":"0 0 10px 0":"0"},children:e.jsx(Qn,{entry:t,isThumbnail:r})}),e.jsxs("div",{className:r?"article-card-mini-content-text":"",children:[e.jsx(_.Text,{className:"article-card-title",children:t.title}),e.jsxs(_.Text,{className:"article-card-info",children:[e.jsx("br",{}),s&&e.jsx(es,{feed:t.feed,className:r?"feed-icon-mini":"feed-icon"}),t.feed.title,e.jsx("br",{}),Ot(t.published_at,o),e.jsx("br",{}),zt(t.reading_time)]}),t.starred&&e.jsx(Ke,{className:"icon-starred"})]}),e.jsx("div",{children:n})]})},ea=({entry:t,handleEntryClick:s,mini:r,children:n})=>{const{markReadOnScroll:o,showFeedIcon:i}=p(E),{activeContent:a}=p(L),{polyglot:l}=p(V),c=a&&t.id===a.id,{handleToggleStarred:d,handleToggleStatus:u}=et(),[h,y]=g.useState(0),j=100,f=.5,b=t.starred,k=t.status==="unread",w=sr({preventScrollOnSwipe:!0,delta:j/2,onSwiping:m=>{const x=Math.min(Math.abs(m.deltaX*f),j)*Math.sign(m.deltaX);y(x)},onSwiped:async m=>{try{m.deltaX>j?(await d(t),v.success(b?l.t("article_card.unmarked_as_starred"):l.t("article_card.marked_as_starred"))):m.deltaX<-j&&(await u(t),v.success(k?l.t("article_card.marked_as_read"):l.t("article_card.marked_as_unread")))}catch{v.error(l.t("article_card.update_failed"))}y(0)}}),[R,T]=g.useState(!1),[M,H]=g.useState(!1),te=()=>u(t),N=20,{ref:O}=Me({skip:M,onChange:async(m,x)=>{if(!(!o||!k)){if(m)T(!0);else if(R){const{top:I}=x.boundingClientRect;I<N&&(await te(),H(!0))}}}}),G=rr({x:h});return g.createElement("div",{...w,className:"article-card",key:t.id},e.jsxs("div",{ref:O,children:[e.jsx(nr.div,{className:"swipe-card",style:G,children:e.jsx(Ee,{className:Re("swipe-content","card-custom-style","card-custom-hover-style",{"card-custom-selected-style":c}),"data-entry-id":t.id,hoverable:!0,onClick:()=>s(t),bordered:!1,children:e.jsx(Ee.Meta,{description:e.jsx(Zn,{entry:t,showFeedIcon:i,mini:r,children:n})})})}),e.jsxs("div",{className:"swipe-actions",children:[e.jsx("div",{className:"swipe-action left",children:b?e.jsx(Ke,{style:{color:"#ffcd00",fontSize:"24px"}}):e.jsx(qe,{style:{color:"#ffffff",fontSize:"24px"}})}),e.jsx("div",{className:"swipe-action right",children:k?e.jsx(At,{style:{color:"#ffffff",fontSize:"24px"}}):e.jsx(Lt,{style:{color:"#ffffff",fontSize:"24px"}})})]})]}))},ta=()=>{const{layout:t}=p(E),{isArticleListReady:s}=p(L),r=t==="large"?2:4,n=o=>e.jsx(Ee,{className:"card-style",cover:t==="large"?e.jsx("div",{className:"card-cover-style"}):null,children:e.jsx(Ee.Meta,{description:e.jsx(Te,{loading:!s,animation:!0,text:{rows:3,width:150}})})},o);return!s&&Array.from({length:r},(o,i)=>n(i))},sa=()=>{const{orderDirection:t}=p(E),{filterType:s}=p(L),{polyglot:r}=p(V),n=r.t("search.tooltip").split(`
`),[o,i]=g.useState(""),a=g.useCallback(In(d=>Ae(d),500),[]),{isBelowMedium:l}=ge(),c=()=>{W({orderDirection:t==="desc"?"asc":"desc"})};return g.useEffect(()=>{Le("title")},[]),g.useEffect(()=>{o===""?Ae(o):a(o)},[o,a]),e.jsxs("div",{className:"search-and-sort-bar",children:[e.jsx(K.Search,{allowClear:!0,onChange:i,placeholder:r.t("search.placeholder"),style:{width:l?"100%":272,marginLeft:8},addBefore:e.jsxs(C,{onChange:Le,style:{width:100},value:s,children:[e.jsx(C.Option,{value:"title",children:r.t("search.type_title")}),e.jsx(C.Option,{value:"content",children:r.t("search.type_content")}),e.jsx(C.Option,{value:"author",children:r.t("search.type_author")})]})}),e.jsxs("div",{className:"button-group",children:[e.jsx(de,{mini:!0,content:e.jsx("div",{children:n.map((d,u)=>e.jsxs(g.Fragment,{children:[d,u<n.length-1&&e.jsx("br",{})]},`line-${u}-${d.length}`))}),children:e.jsx(F,{shape:"circle",size:"small",icon:e.jsx(Et,{})})}),e.jsx(de,{mini:!0,content:t==="desc"?r.t("article_list.sort_direction_desc"):r.t("article_list.sort_direction_asc"),children:e.jsx(F,{shape:"circle",size:"small",icon:t==="desc"?e.jsx(ar,{}):e.jsx(or,{}),onClick:c})})]})]})},ra=(...t)=>s=>{for(const r of t)typeof r=="function"?r(s):r&&typeof r=="object"&&(r.current=s)},na=(t,s,r)=>{g.useLayoutEffect(()=>{let n=null;return t>0&&(clearTimeout(n),n=setTimeout(()=>{r(),clearTimeout(n)},s*4)),()=>clearTimeout(n)},[t,s,r])},aa=({duration:t,color:s})=>{const[r,n]=g.useState([]);na(r.length,t,()=>{n([])});const o=i=>{const a=i.currentTarget.getBoundingClientRect(),l=a.width>a.height?a.width:a.height,c=i.pageX-a.x-l/2,d=i.pageY-a.y-l/2,u={x:c,y:d,size:l,id:`${new Date().getTime()}-${c}-${d}`};n([...r,u])};return e.jsx("div",{className:"ripple-container",onMouseDown:o,children:r.length>0&&r.map(i=>e.jsx("span",{className:"ripple-span",style:{top:i.y,left:i.x,width:i.size,height:i.size,backgroundColor:s,animationDuration:`${t}ms`}},i.id))})},oa=({getEntries:t})=>{const{isArticleListReady:s,loadMoreVisible:r}=p(L),{loadingMore:n,handleLoadMore:o}=nt(),{ref:i,inView:a}=Me(),l=g.useCallback(async()=>{r&&a&&s&&!n&&await o(t)},[r,a,s,n,o,t]);return g.useEffect(()=>{const c=setInterval(l,500);return()=>clearInterval(c)},[l]),s&&r&&e.jsxs("div",{className:"load-more-container",ref:i,children:[e.jsx(lr,{loading:n,style:{paddingRight:"10px"}}),"Loading more ..."]})},ia=g.forwardRef(({getEntries:t,handleEntryClick:s,cardsRef:r},n)=>{const{layout:o,pageSize:i}=p(E),a=o==="small",{isArticleListReady:l,loadMoreVisible:c}=p(L),d=p(tt),u=d.length-Math.ceil(i*.2)-1,{loadingMore:h,handleLoadMore:y}=nt(),{ref:j}=Me({skip:!c,onChange:async w=>{!w||!l||h||await y(t)}}),f=ir({count:d.length,getScrollElement:()=>r.current,estimateSize:g.useCallback(()=>a?120:280,[a]),overscan:5}),b=f.getVirtualItems(),k=g.useCallback(w=>w===u?ra(f.measureElement,j):f.measureElement,[u,f.measureElement,j]);return e.jsxs(e.Fragment,{children:[e.jsx(sa,{}),e.jsxs(He,{className:"entry-list",ref:n,children:[e.jsx(ta,{}),l&&e.jsx("div",{ref:r,children:e.jsx("div",{style:{height:f.getTotalSize(),width:"100%",position:"relative"},children:b.map(w=>e.jsx("div",{"data-index":w.index,ref:k(w.index),style:{position:"absolute",top:0,left:0,width:"100%",transform:`translateY(${w.start}px)`},children:e.jsx(ea,{entry:d[w.index],handleEntryClick:s,mini:a,children:e.jsx(aa,{color:"var(--color-text-4)",duration:1e3})})},w.key))})}),e.jsx(oa,{getEntries:t})]})]})}),la=()=>{ye(t=>t.map(s=>({...s,status:"read"})))},ca=({info:t,refreshArticleList:s,markAllAsRead:r})=>{const{isArticleListReady:n}=p(L),{showStatus:o}=p(E),{polyglot:i}=p(V),{fetchAppData:a}=st(),l=async()=>{try{await r(),la(),await a(),v.success(i.t("article_list.mark_all_as_read_success"))}catch{v.error(i.t("article_list.mark_all_as_read_error"))}},c=d=>{W({showStatus:d})};return g.useEffect(()=>{Le("title"),Ae("")},[o]),e.jsxs("div",{className:"entry-panel",children:[e.jsx(Ft,{focusLock:!0,onOk:l,title:i.t("article_list.mark_all_as_read_confirm"),children:e.jsx(F,{icon:e.jsx(Tt,{}),shape:"circle",style:{visibility:["starred","history"].includes(t.from)?"hidden":"visible"}})}),e.jsx(cr.Group,{onChange:c,options:[{label:i.t("article_list.filter_status_all"),value:"all"},{label:i.t("article_list.filter_status_unread"),value:"unread"}],style:{visibility:t.from==="history"?"hidden":"visible"},type:"button",value:o}),e.jsx(F,{icon:e.jsx(Fe,{}),loading:!n,shape:"circle",onClick:s})]})},me=({info:t,getEntries:s,markAllAsRead:r})=>{const{activeContent:n,isArticleFocused:o,isArticleListReady:i}=p(L),{isAppDataReady:a}=p(U),{orderBy:l,orderDirection:c,showAllFeeds:d,showStatus:u}=p(E),h=p(tt),y=p(Ze),{polyglot:j}=p(V),{handleFetchContent:f,handleSaveToThirdPartyServices:b,handleToggleStarred:k,handleToggleStatus:w,handleEntryStatusUpdate:R}=et(),{fetchAppData:T}=st(),{fetchArticleList:M}=Hn(s),H=g.useRef(null),te=g.useRef(null),N=g.useRef(null);g.useEffect(()=>{pn(t.from),n&&X(null),Q(s)},[t]),g.useEffect(()=>{["starred","history"].includes(t.from)||Q(s)},[l]),g.useEffect(()=>{y.length===0||["starred","history"].includes(t.from)||Q(s)},[d]),g.useEffect(()=>{Q(s)},[c,u]);const O=async Y=>{if(X(null),Y.status!=="unread"){setTimeout(()=>{X({...Y,status:"read"}),setTimeout(()=>{var se;(se=N.current)==null||se.focus()},200)},200);return}try{setTimeout(()=>{X({...Y,status:"read"}),setTimeout(()=>{var se;(se=N.current)==null||se.focus()},200),R(Y,"read")},200),await De([Y.id],"read")}catch{v.error(j.t("content.mark_as_read_error")),R(Y,"unread")}},{exitDetailView:G,fetchOriginalArticle:m,navigateToNextArticle:x,navigateToPreviousArticle:I,openLinkExternally:z,openPhotoSlider:D,saveToThirdPartyServices:ne,toggleReadStatus:le,toggleStarStatus:_e}=hs(O,H);g.useEffect(()=>{const Y={ArrowLeft:()=>I(),ArrowRight:()=>x(),Escape:()=>G(),a:()=>ne(b),b:z,d:()=>m(f),m:()=>le(()=>w(n)),s:()=>_e(()=>k(n)),v:D},se=fe=>{const ot=Y[fe.key];ot&&(fe.key==="ArrowLeft"?I(fe.ctrlKey):fe.key==="ArrowRight"?x(fe.ctrlKey):ot())};if(o)return document.addEventListener("keydown",se),()=>{document.removeEventListener("keydown",se)}},[n,h,o]);const Q=async Y=>{Zt(0),a?await M(Y):await T()};return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"entry-col",children:[e.jsx(ut,{in:i,timeout:200,nodeRef:te,classNames:"fade",children:e.jsx(ia,{cardsRef:te,getEntries:s,handleEntryClick:O,ref:H})}),e.jsx(ca,{info:t,refreshArticleList:()=>Q(s),markAllAsRead:r})]}),e.jsx(ut,{in:n!==null,timeout:200,nodeRef:N,classNames:"fade",unmountOnExit:!0,children:e.jsx(Xn,{handleEntryClick:O,entryListRef:H,ref:N})})]})},da=()=>e.jsx(me,{info:{from:"all",id:""},getEntries:Wr,markAllAsRead:rn}),ua=()=>{const{id:t}=Rt(),s=B("orderBy"),r=B("pageSize"),n=B("showAllFeeds"),o=async(i=0,a=null)=>{const l={baseUrl:`/v1/categories/${t}/entries`,orderField:s,offset:i,limit:r,status:a},c={globally_visible:!n};return S.get(he(l,c))};return e.jsx(me,{info:{from:"category",id:t},getEntries:o,markAllAsRead:()=>Vr(t)})},ha=()=>{const t=ie(),s=dr();return console.error(s),e.jsx("div",{id:"error-page",style:{top:"30%",position:"relative"},children:e.jsx(ur,{status:"404",subTitle:s.statusText||s.message,extra:[e.jsx(F,{type:"primary",onClick:()=>t("/"),children:"Back to Home"},"back")]})})},ma=()=>{const{id:t}=Rt(),s=B("orderBy"),r=B("pageSize"),n=async(o=0,i=null)=>{const a={baseUrl:`/v1/feeds/${t}/entries`,orderField:s,offset:o,limit:r,status:i};return S.get(he(a))};return e.jsx(me,{info:{from:"feed",id:t},getEntries:n,markAllAsRead:()=>Zr(t)})},fa=()=>e.jsx(me,{info:{from:"history",id:""},getEntries:$t}),pa=t=>{const s=t.getFieldsValue();let r=!0;for(const[n,o]of Object.entries(s))if(n!=="password"){const i=o==null?void 0:o.trim();t.setFieldValue(n,i),i||(r=!1)}else o||(r=!1);return r},Se=(t,s)=>{t.key==="Enter"&&s.submit()},ga=()=>{Pt(),os();const t=p(Pe),{homePage:s}=p(E),{polyglot:r}=p(V),[n]=hr(),[o,i]=g.useState(!1),[a,l]=g.useState("token"),c=ie(),d=async()=>{i(!0);const{server:h,token:y,username:j,password:f}=n.getFieldsValue();try{(await St.raw("v1/me",{baseURL:h,headers:y?{"X-Auth-Token":y}:{Authorization:`Basic ${btoa(`${j}:${f}`)}`}})).status===200&&(v.success(r.t("login.success")),Vt({server:h,token:y,username:j,password:f}),c("/"))}catch(b){console.error(b),v.error(b.message)}i(!1)},u=async()=>{const h=n.getFieldsValue();if(!Ne(h)){v.error(r.t("login.auth_error"));return}await d()};return g.useEffect(()=>{is()},[]),Ne(t)?e.jsx(Ge,{to:`/${s}`}):r&&e.jsxs("div",{className:"page-layout",children:[e.jsx("div",{className:"form-panel",children:e.jsxs("div",{className:"login-form",children:[e.jsx(_.Title,{heading:3,children:r.t("login.login_to_your_server")}),e.jsxs(P,{autoComplete:"off",form:n,layout:"vertical",onSubmit:async()=>{pa(n)?await u():v.error(r.t("login.submit_error"))},children:[e.jsx(P.Item,{field:"server",label:r.t("login.server_label"),rules:[{required:!0}],onKeyDown:h=>{Se(h,n)},children:e.jsx(K,{disabled:o,placeholder:r.t("login.server_placeholder"),prefix:e.jsx(mr,{})})}),a==="token"&&e.jsx(P.Item,{field:"token",label:r.t("login.token_label"),rules:[{required:!0}],onKeyDown:h=>{Se(h,n)},children:e.jsx(K.Password,{disabled:o,placeholder:r.t("login.token_placeholder"),prefix:e.jsx(ht,{})})}),a==="user"&&e.jsxs(e.Fragment,{children:[e.jsx(P.Item,{field:"username",label:r.t("login.username_label"),rules:[{required:!0}],onKeyDown:h=>{Se(h,n)},children:e.jsx(K,{disabled:o,placeholder:r.t("login.username_placeholder"),prefix:e.jsx(It,{})})}),e.jsx(P.Item,{field:"password",label:r.t("login.password_label"),rules:[{required:!0}],onKeyDown:h=>{Se(h,n)},children:e.jsx(K.Password,{disabled:o,placeholder:r.t("login.password_placeholder"),prefix:e.jsx(ht,{})})})]})]}),e.jsx(F,{loading:o,type:"primary",long:!0,onClick:()=>n.submit(),style:{marginTop:"20px"},children:r.t("login.login_button")}),e.jsx(q,{orientation:"center",children:r.t("login.another_login_method")}),e.jsx(F,{type:"secondary",long:!0,onClick:()=>l(a==="token"?"user":"token"),style:{marginTop:"20px"},children:a==="token"?r.t("login.another_login_button"):r.t("login.token_label")}),e.jsxs("div",{style:{display:"flex",marginTop:"40px"},children:[e.jsx(_.Text,{disabled:!0,children:r.t("login.need_help")}),e.jsx(fr,{href:"https://miniflux.app/docs/api.html#authentication",style:{fontWeight:"500"},children:r.t("login.miniflux_official_website")})]})]})}),e.jsx("div",{className:"background"})]})},xa=({children:t})=>{const s=p(Pe);return Ne(s)?e.jsx(e.Fragment,{children:t}):e.jsx(Ge,{to:"/login"})},ya=()=>e.jsx(me,{info:{from:"starred",id:""},getEntries:Ut}),_a=()=>{const t=async()=>{const s=await Ce(0,"unread"),r=s.total;let n=s.entries;r>n.length&&(n=Ce(0,"unread",r).then(i=>i.entries));const o=n.map(i=>i.id);return De(o,"read")};return e.jsx(me,{info:{from:"today",id:""},getEntries:Ce,markAllAsRead:t})},ja=B("homePage"),ba=[{path:"/all",element:e.jsx(da,{})},{path:"/today",element:e.jsx(_a,{})},{path:"/starred",element:e.jsx(ya,{})},{path:"/history",element:e.jsx(fa,{})},{path:"/category/:id",element:e.jsx(ua,{})},{path:"/feed/:id",element:e.jsx(ma,{})}],ms=pr([{path:"/",element:e.jsx(xa,{children:e.jsx($n,{})}),errorElement:e.jsx(ha,{}),children:[...ba,{index:!0,element:e.jsx(Ge,{to:`/${ja}`,replace:!0})}]},{path:"/login",element:e.jsx(ga,{})}]),va={"zh-CN":jr,"es-ES":br},wa=()=>va[Cr()]||_r;gr.createRoot(document.getElementById("root")).render(e.jsx(xr,{locale:wa(),children:e.jsx(yr,{router:ms})}));
