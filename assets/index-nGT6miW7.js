import{p as nt,m as ie,u as f,r as m,d as M,P as Ks,i as Ws,o as $t,a as Gs,b as Ys,c as Js,e as q,M as j,C as Xs,j as e,f as Z,g as ye,S as rt,A as Qs,I as Zs,T,h as Ne,k as zt,l as en,n as Bt,q as at,s as tn,t as sn,v as ee,w as je,x as ze,B as w,y as nn,D as rn,z as xe,E as ot,F as an,G as on,H as ln,J as Tt,K as Ht,L as cn,N as dn,O as be,Q as z,R as un,U as qt,V as se,W as hn,X as pn,Y as fn,Z as mn,_ as gn,$ as G,a0 as F,a1 as It,a2 as P,a3 as re,a4 as K,a5 as xn,a6 as it,a7 as Et,a8 as Kt,a9 as _n,aa as lt,ab as Wt,ac as yn,ad as oe,ae as jn,af as bn,ag as vn,ah as wn,ai as Sn,aj as Cn,ak as kn,al as Tn,am as In,an as En,ao as Gt,ap as Yt,aq as ct,ar as An,as as Fn,at as dt,au as Jt,av as R,aw as Ln,ax as Pn,ay as Nn,az as Rn,aA as Dn,aB as Be,aC as Xt,aD as Re,aE as Mn,aF as On,aG as Un,aH as Vn,aI as $n,aJ as zn,aK as Bn,aL as Hn,aM as Qt,aN as qn,aO as Kn,aP as Wn,aQ as ut,aR as Gn,aS as At,aT as Yn,aU as Jn,aV as Xn,aW as Qn,aX as Zn,aY as er,aZ as tr,a_ as sr}from"./vendor-CwLsKHTJ.js";(function(){const s=document.createElement("link").relList;if(s&&s.supports&&s.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))r(a);new MutationObserver(a=>{for(const o of a)if(o.type==="childList")for(const i of o.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&r(i)}).observe(document,{childList:!0,subtree:!0});function n(a){const o={};return a.integrity&&(o.integrity=a.integrity),a.referrerPolicy&&(o.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?o.credentials="include":a.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function r(a){if(a.ep)return;a.ep=!0;const o=n(a);fetch(a.href,o)}})();const nr="modulepreload",rr=function(t){return"/"+t},Ft={},fe=function(s,n,r){let a=Promise.resolve();if(n&&n.length>0){document.getElementsByTagName("link");const i=document.querySelector("meta[property=csp-nonce]"),l=(i==null?void 0:i.nonce)||(i==null?void 0:i.getAttribute("nonce"));a=Promise.allSettled(n.map(c=>{if(c=rr(c),c in Ft)return;Ft[c]=!0;const u=c.endsWith(".css"),h=u?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${c}"]${h}`))return;const d=document.createElement("link");if(d.rel=u?"stylesheet":nr,u||(d.as="script"),d.crossOrigin="",d.href=c,l&&d.setAttribute("nonce",l),document.head.appendChild(d),u)return new Promise((p,x)=>{d.addEventListener("load",p),d.addEventListener("error",()=>x(new Error(`Unable to preload CSS for ${c}`)))})}))}function o(i){const l=new Event("vite:preloadError",{cancelable:!0});if(l.payload=i,window.dispatchEvent(l),!l.defaultPrevented)throw i}return a.then(i=>{for(const l of i||[])l.status==="rejected"&&o(l.reason);return s().catch(o)})},ar=(t,s,n)=>{const r=t[s];return r?typeof r=="function"?r():Promise.resolve(r):new Promise((a,o)=>{(typeof queueMicrotask=="function"?queueMicrotask:setTimeout)(o.bind(null,new Error("Unknown variable dynamic import: "+s+(s.split("/").length!==n?". Note that variables only represent file names one level deep.":""))))})},or=()=>{const{language:t}=S.get(),s=ht();return t||s},ht=()=>{const t=navigator.language;return t==="zh-Hans-CN"?"zh-CN":t},Qe={articleWidth:90,fontFamily:"system-ui",fontSize:1.05,highlightTheme:"OneDark",homePage:"all",language:ht(),layout:"large",markReadOnScroll:!1,orderBy:"created_at",orderDirection:"desc",pageSize:100,removeDuplicates:"none",showAllFeeds:!1,showUnreadFeedsOnly:!1,showDetailedRelativeTime:!1,showEstimatedReadingTime:!1,showFeedIcon:!0,showStatus:"unread",theme:"light",themeColor:"Blue"},S=nt("settings",Qe,{encode:JSON.stringify,decode:t=>{const s=JSON.parse(t);return{...Qe,...s}}}),V=t=>S.get()[t],H=t=>S.set({...S.get(),...t}),ir=()=>S.set(Qe),I=(t,s=null)=>n=>{const r=t.get();if(typeof r=="object"&&r!==null){if(s===null)return;typeof n=="function"?t.set({...r,[s]:n(r[s])}):t.set({...r,[s]:n})}else typeof n=="function"?t.set(n(r)):t.set(n)},E=ie({polyglot:null}),lr=I(E,"polyglot"),cr=async(t,s)=>{let n,r=t;try{n=await ar(Object.assign({"../locales/en-US.json":()=>fe(()=>import("./en-US-hUWOZquR.js"),[]),"../locales/es-ES.json":()=>fe(()=>import("./es-ES-jyWntrD8.js"),[]),"../locales/zh-CN.json":()=>fe(()=>import("./zh-CN-BmzNQis_.js"),[])}),`../locales/${t}.json`,3)}catch(a){console.error("Failed to load language: ",a),n=await fe(()=>import("./en-US-hUWOZquR.js"),[]),r="en-US"}{const a=new Ks({phrases:n.default,locale:r});lr(a)}},Zt=()=>{const{language:t}=f(S);m.useEffect(()=>{t?(cr(t),t==="zh-CN"?M.locale("zh-cn"):t==="es"||t.startsWith("es-")?M.locale("es"):M.locale("en")):H({language:ht()})},[t])},He=ie({addFeedModalVisible:!1,settingsModalVisible:!1,settingsTabsActiveTab:"1"}),dr=I(He,"addFeedModalVisible"),ur=I(He,"settingsModalVisible"),hr=I(He,"settingsTabsActiveTab"),qe=()=>{const{addFeedModalVisible:t,settingsModalVisible:s,settingsTabsActiveTab:n}=f(He);return{addFeedModalVisible:t,setAddFeedModalVisible:dr,settingsModalVisible:s,setSettingsModalVisible:ur,settingsTabsActiveTab:n,setSettingsTabsActiveTab:hr}},ne=()=>{const[t,s]=m.useState(window.innerWidth),n=t<=768,r=t<=992;return m.useEffect(()=>{const a=()=>s(window.innerWidth);return window.addEventListener("resize",a),()=>window.removeEventListener("resize",a)},[]),{width:t,isBelowMedium:n,isBelowLarge:r}},Ze={server:"",token:"",username:"",password:""},ve=nt("auth",Ze,{encode:JSON.stringify,decode:t=>{const s=JSON.parse(t);return{...Ze,...s}}}),es=t=>ve.set(t),pr=()=>es(Ze),fr=t=>{try{const s=new URL(t),{hostname:n,port:r}=s;return!!n&&!!r}catch{return!1}},De=t=>{const{server:s,token:n,username:r,password:a}=t;return!s||!Ws(s,{require_protocol:!0})&&!fr(s)?!1:n||r&&a},mr=()=>$t.create({retry:3,onRequest({_request:t,options:s}){const n=ve.get();if(!De(n))throw new Error("Invalid auth");const{server:r,token:a,username:o,password:i}=n;s.baseURL=r,s.headers=a?{"X-Auth-Token":a}:{Authorization:`Basic ${btoa(`${o}:${i}`)}`}},onRequestError({_request:t,_options:s,error:n}){console.error("Request error: ",n)},async onResponseError({_request:t,response:s,_options:n}){var o;s.status===401&&(localStorage.removeItem("auth"),await Rs.navigate("/login"));const a=((o=s._data)==null?void 0:o.error_message)??s.statusText;throw console.error("Response error: ",a),new Error(a)}}),C=mr();C.get=t=>C(t,{method:"GET"});C.post=(t,s)=>C(t,{method:"POST",body:s});C.put=(t,s)=>C(t,{method:"PUT",body:s});const gr=async()=>C.get("/v1/categories"),xr=async t=>C.post("/v1/categories",{title:t}),_r=async t=>C.raw(`/v1/categories/${t}`,{method:"DELETE"}),yr=async(t,s,n=!1)=>{const r={title:s,hide_globally:n?"on":void 0};return C.put(`/v1/categories/${t}`,r)},jr=async t=>C.put(`/v1/categories/${t}/mark-all-as-read`);M.extend(Gs);M.extend(Ys);M.extend(Js);const br=t=>M(t).isAfter(M().subtract(24,"hour")),vr=()=>M().subtract(24,"hour").unix(),wr=t=>M(t).unix(),Sr=()=>M().startOf("day"),Cr=t=>M(t).endOf("day").unix(),kr=()=>M().utc().format("YYYY-MM-DDTHH:mm:ss.SSSSSSZ"),Tr=t=>M(t).format("dddd, MMMM D, YYYY h:mm A"),ts=(t,s)=>{const{polyglot:n}=E.get();if(!s){const g=M(),y=M(t),v=y.from(g),k=M.duration(g.diff(y)).asSeconds();return k>=0&&k<60?n.t("date.just_now"):v}const r=M(),o=M(t).diff(r),i=M.duration(Math.abs(o)),l=i.years(),c=i.months(),u=i.days(),h=i.hours(),d=i.minutes(),p=[];if(l>0&&p.push(n.t("date.years",l)),c>0&&p.push(n.t("date.months",c)),u>0&&p.push(n.t("date.days",u)),h>0&&p.push(n.t("date.hours",h)),d>0&&p.push(n.t("date.minutes",d)),p.length===0)return n.t("date.just_now");const x=p.join(" ");return o>0?n.t("date.in_time",{time:x}):n.t("date.time_ago",{time:x})},ss=t=>{const{polyglot:s}=E.get(),n=s.t("date.minutes",t);return s.t("article_card.reading_time",{time:n})},Ke=async(t,s)=>C.put("/v1/entries",{entry_ids:t,status:s}),Ir=async t=>C.put(`/v1/entries/${t}/bookmark`),Er=async t=>C.get(`/v1/entries/${t}/fetch-content`),Ar=async t=>C.raw(`/v1/entries/${t}/save`,{method:"POST"}),le=(t,s={})=>{const{baseUrl:n,orderField:r,offset:a,limit:o,status:i}=t,{filterDate:l}=A.get(),c=V("orderDirection"),u=new URLSearchParams({order:r,direction:c,offset:a,limit:o,...s});return i&&u.append("status",i),l&&(u.append("published_after",wr(l)),u.append("published_before",Cr(l))),`${n}?${u}`},Fr=async(t=0,s=null)=>{const n=V("orderBy"),r=V("pageSize"),a=V("showAllFeeds"),o={baseUrl:"/v1/entries",orderField:n,offset:t,limit:r,status:s},i={globally_visible:!a};return C.get(le(o,i))},Le=async(t=0,s=null,n=null)=>{const r=V("orderBy"),a=n??V("pageSize"),o=V("showAllFeeds"),i=vr(),l={baseUrl:"/v1/entries",orderField:r,offset:t,limit:a,status:s},c={globally_visible:!o,published_after:i};return C.get(le(l,c))},ns=async(t=0,s=null)=>{const n=V("pageSize"),r={baseUrl:"/v1/entries",orderField:"changed_at",offset:t,limit:n,status:s},a={starred:"true"};return C.get(le(r,a))},Lr=async(t=0)=>{const s=V("pageSize"),n={baseUrl:"/v1/entries",orderField:"changed_at",offset:t,limit:s,status:"read"};return C.get(le(n))},Pr=async()=>C.get("/v1/feeds"),Nr=async()=>C.get("/v1/feeds/counters"),Rr=async t=>C.raw(`/v1/feeds/${t}/refresh`,{method:"PUT"}),Dr=async()=>C.raw("/v1/feeds/refresh",{method:"PUT"}),Mr=async(t,s,n)=>C.post("/v1/feeds",{feed_url:t,category_id:s,crawler:n}),Or=async t=>C.raw(`/v1/feeds/${t}`,{method:"DELETE"}),rs=async(t,s)=>{const{categoryId:n,title:r,siteUrl:a,feedUrl:o,hidden:i,disabled:l,isFullText:c}=s;return C.put(`/v1/feeds/${t}`,{category_id:n,title:r,site_url:a,feed_url:o,hide_globally:i,disabled:l,crawler:c})},Ur=async t=>C.put(`/v1/feeds/${t}/mark-all-as-read`),Vr=async()=>C.get("/v1/me"),$r=async t=>C.get(`/v1/icons/${t}`),zr=async()=>C.get("/v1/version"),Br=async()=>{const t=await Vr();return C.put(`/v1/users/${t.id}/mark-all-as-read`)},as={isAppDataReady:!1,unreadInfo:{},unreadTodayCount:0,starredCount:0,historyCount:0,feedsData:[],categoriesData:[],isVersionAtLeast2_2_0:!1},O=ie(as),We=q(O,t=>{const{unreadInfo:s,feedsData:n}=t;return n.map(a=>({...a,unreadCount:s[a.id]??0})).sort((a,o)=>a.title.localeCompare(o.title,"en"))}),we=q([O,We],(t,s)=>{const{categoriesData:n}=t;return n.map(a=>{const o=s.filter(i=>i.category.id===a.id);return{...a,unreadCount:o.reduce((i,l)=>i+(l.unreadCount??0),0),feedCount:o.length}}).sort((a,o)=>a.title.localeCompare(o.title,"en"))}),os=q(we,t=>t.filter(s=>s.hide_globally).map(s=>s.id)),pt=q([We,os],(t,s)=>t.filter(n=>n.hide_globally||s.includes(n.category.id)).map(n=>n.id)),is=q([We,pt,S],(t,s,n)=>{const{showAllFeeds:r}=n;return t.filter(a=>r||!s.includes(a.id))}),Hr=q([we,os,S],(t,s,n)=>{const{showAllFeeds:r}=n;return t.filter(a=>r||!s.includes(a.id))}),ls=q(is,t=>t.reduce((s,n)=>{const{id:r}=n.category;return s[r]||(s[r]=[]),s[r].push(n),s},{})),qr=q([O,is],(t,s)=>{const{unreadInfo:n}=t;return Object.entries(n).reduce((r,[a,o])=>s.some(i=>i.id===Number(a))?r+o:r,0)}),Pe=I(O,"categoriesData"),ae=I(O,"feedsData"),Me=I(O,"historyCount"),Lt=I(O,"isAppDataReady"),Oe=I(O,"starredCount"),ft=I(O,"unreadInfo"),mt=I(O,"unreadTodayCount"),Kr=I(O,"isVersionAtLeast2_2_0"),Wr=()=>O.set(as),cs=(t,s)=>{const n=s.map(r=>r.id);return t.map(r=>n.includes(r.id)&&s.find(o=>o.id===r.id)||r)},et=(t,s)=>{const n={};let r=0;const a=t.filter(u=>u.status!==s);if(a.length===0)return;const{showStatus:o}=S.get();s==="read"?(Me(u=>u+a.length),o==="unread"&&$e(u=>u-a.length)):(Me(u=>Math.max(0,u-a.length)),o==="unread"&&$e(u=>u+a.length));for(const u of a){const h=u.feed.id,d=br(u.published_at),p=s==="read"?-1:1;n[h]=(n[h]??0)+p,r+=d?p:0}mt(u=>Math.max(0,u+r)),ft(u=>{const h={...u};for(const[d,p]of Object.entries(n))h[d]=Math.max(0,(h[d]??0)+p);return h});const i=a.map(u=>({...u,status:s})),{activeContent:l}=A.get(),c=i.find(u=>u.id===(l==null?void 0:l.id));c&&Y(c),Ce(u=>cs(u,i))},Ge=()=>{const{activeContent:t}=f(A),{polyglot:s}=f(E),n=(c,u)=>{et([c],u)},r=(c,u)=>{u?(Oe(d=>d+1),Xs({particleCount:100,angle:120,spread:70,origin:{x:1,y:1}})):Oe(d=>Math.max(0,d-1));const h={...c,starred:u};t&&Y(h),Ce(d=>cs(d,[h]))};return{handleEntryStatusUpdate:n,handleFetchContent:async()=>{try{const c=await Er(t.id);j.success(s.t("actions.fetched_content_success")),Y({...t,content:c.content})}catch(c){console.error("Failed to fetch content: ",c),j.error(s.t("actions.fetched_content_error"))}},handleSaveToThirdPartyServices:async()=>{try{(await Ar(t.id)).status===202?j.success(s.t("actions.saved_to_third-party_services_success")):j.error(s.t("actions.saved_to_third-party_services_error"))}catch(c){console.error("Failed to save to third-party services: ",c),j.error(s.t("actions.saved_to_third-party_services_error"))}},handleToggleStarred:async c=>{const u=!c.starred;r(c,u),Ir(c.id).catch(()=>{j.error(u?s.t("actions.star_error"):s.t("actions.unstar_error")),r(c,!u)})},handleToggleStatus:async c=>{const u=c.status,h=u==="read"?"unread":"read";n(c,h),Ke([c.id],h).catch(()=>{j.error(h==="read"?s.t("actions.mark_as_read_error"):s.t("actions.mark_as_unread_error")),n(c,u)})}}},Gr=(t,s)=>{const{polyglot:n}=E.get();if(t.length===0||s==="none")return t;const r=t.map((h,d)=>({id:h.id,index:d})),a=new Map,o=new Map,i=new Map,l=[],c=t.slice().sort((h,d)=>h.id-d.id).filter(h=>{const{hash:d,title:p,url:x,id:g}=h;switch(s){case"hash":if(a.has(d))return l.push(h),!1;a.set(d,g);break;case"title":if(o.has(p))return l.push(h),!1;o.set(p,g);break;case"url":if(i.has(x))return l.push(h),!1;i.set(x,g);break;default:return!0}return!0}),u=l.filter(h=>h.status==="unread").map(h=>h.id);return u.length>0&&(et(l,"read"),Ke(u,"read").catch(()=>{j.error(n.t("deduplicate.mark_as_read_error")),et(l,"unread")})),c.sort((h,d)=>{const p=r.find(g=>g.id===h.id).index,x=r.find(g=>g.id===d.id).index;return p-x})},Yr=t=>{const s=new Array(t.length).fill(0);let n=0,r=1;for(;r<t.length;)t[r]===t[n]?(n++,s[r]=n,r++):n!==0?n=s[n-1]:(s[r]=0,r++);return s},Te=(t,s,n=!0)=>{const r=n?t.toLowerCase():t,a=n?s.toLowerCase():s;if(a.length===0)return 0;const o=Yr(a);let i=0,l=0;for(;i<r.length;)if(r[i]===a[l]?(i++,l++):l!==0?l=o[l-1]:i++,l===a.length)return i-l;return-1},Jr=t=>{const s=[],n=[];let r=[];const a=[],o=t.match(/([-+|]?)\s*"([^"]+)"/g);let i=t;o&&(r=o.map(c=>{const u=c.trim()[0],h=c.match(/"([^"]+)"/)[1];switch(u){case"-":n.push(h);break;case"+":s.push(h);break;case"|":a.push([h]);break;default:s.push(h);break}return h}),i=t.replace(/([-+|]?)\s*"([^"]+)"/g,""));const l=i.split(/\s+/);for(const c of l){const u=c.replace(/^[-+|]/,"");if(c.startsWith("-")&&u)n.push(u);else if(c.startsWith("+")&&u)s.push(u);else if(c.includes("|")){const h=c.split("|").filter(d=>d);h.length>0&&a.push(h)}else u&&s.push(u)}return{includeTerms:s,excludeTerms:n,exactPhrases:r,orConditions:a}},Xr=(t,s,n=[],r=!0)=>{const{includeTerms:a,excludeTerms:o,exactPhrases:i,orConditions:l}=Jr(s),c=u=>{if(o.some(p=>Te(u,p,r)!==-1)||i.length>0&&!i.some(p=>Te(u,p,r)!==-1))return!1;const h=a.every(p=>Te(u,p,r)!==-1),d=l.length===0||l.some(p=>p.some(x=>Te(u,x,r)!==-1));return h&&d};return t.filter(u=>n.some(h=>{const d=u[h];return typeof d=="string"&&c(r?d.toLowerCase():d)}))},ds=(t,s,n=[],r=!0)=>!Array.isArray(t)||t.length===0?(console.error("Invalid data input:",{receivedData:t,type:typeof t,isArray:Array.isArray(t),length:Array.isArray(t)?t.length:"N/A"}),[]):typeof s!="string"||s.trim().length===0?(console.error("Invalid query input:",{receivedQuery:s,type:typeof s,trimmedLength:typeof s=="string"?s.trim().length:"N/A"}),[]):Xr(t,s,n,r),Qr=(t,s)=>t.toLowerCase().includes(s.toLowerCase()),Zr=(t,s,n)=>n?ds(t,n,[s]):t,us={activeContent:null,entries:[],filterDate:null,filterString:"",filterType:"Title",infoFrom:V("homePage"),isArticleListReady:!1,isArticleLoading:!1,loadMoreVisible:!1,offset:0,total:0},A=ie(us),Se=q([A,O,pt,S],(t,s,n,r)=>{const{entries:a,filterString:o,filterType:i,infoFrom:l}=t,c=Zr(a,i,o),{isVersionAtLeast2_2_0:u}=s,{removeDuplicates:h,showAllFeeds:d}=r,p=!["starred","history"].includes(l),x=y=>u||d||!n.includes(y.feed.id),g=p?c.filter(x):c;return h==="none"||["starred","history"].includes(l)?g:Gr(g,h)}),gt=q([A,Se],(t,s)=>{const{activeContent:n}=t;return n?s.findIndex(r=>r.id===n.id):-1}),hs=q([gt,Se],(t,s)=>s[t-1]),ps=q([gt,Se],(t,s)=>s[t+1]),Y=I(A,"activeContent"),Ce=I(A,"entries"),me=I(A,"filterDate"),Ue=I(A,"filterString"),Ve=I(A,"filterType"),ea=I(A,"infoFrom"),Pt=I(A,"isArticleListReady"),Nt=I(A,"isArticleLoading"),fs=I(A,"loadMoreVisible"),$e=I(A,"offset"),ta=I(A,"total"),sa=()=>A.set(us),Rt=ie(),Ie=new Set,na=t=>{const s=f(Rt);return m.useEffect(()=>{s[t]||Ie.has(t)||(Ie.add(t),$r(t).then(n=>{const r=`data:${n.data}`;Rt.setKey(t,r),Ie.delete(t)}).catch(()=>{Ie.delete(t)}))},[t,s]),s[t]},ra=t=>{const s=/^(?:http|https):\/\/((?!(\d+\.){3}\d+)([^/?#]+))/,n=t.match(s);return n?n[1]:null},Dt=t=>{const s=ra(t);if(s){const n=s.split(".");if(n.length>=2)return n.slice(-2).join(".")}return null},aa=t=>`https://icons.duckduckgo.com/ip3/${Dt(t.site_url)??Dt(t.feed_url)}.ico`,ms=({feed:t,className:s="feed-icon"})=>{const{icon_id:n}=t.icon,r=aa(t),[a,o]=m.useState(r),i=na(n);return m.useEffect(()=>{i&&o(i)},[i]),n===0?e.jsx("img",{className:s,src:r,alt:"",style:{borderRadius:"20%"}}):e.jsx("img",{className:s,src:a,alt:"",onError:()=>o(r),style:{borderRadius:"20%"}})},gs=Z.Item,oa=({category:t,path:s})=>{var i;const r=(i=f(ls)[t.id])==null?void 0:i.reduce((l,c)=>l+c.unreadCount,0),a=ee(),o=()=>{a(`/category/${t.id}`),Y(null)};return e.jsxs("div",{className:je("category-title",{"submenu-active":s===`/category/${t.id}`,"submenu-inactive":s!==`/category/${t.id}`}),onClick:o,onKeyDown:l=>{(l.key==="Enter"||l.key===" ")&&o()},tabIndex:0,role:"button",style:{cursor:"pointer"},children:[e.jsx(T.Ellipsis,{expandable:!1,showTooltip:!0,style:{width:r?"80%":"100%",fontWeight:500},children:t.title}),r>0&&e.jsx(T.Ellipsis,{className:"unread-count",expandable:!1,style:{fontWeight:500},children:r})]})},ia=({count:t})=>e.jsx(T.Ellipsis,{className:"item-count",expandable:!1,children:t||""}),Ee=({path:t,Icon:s,label:n,count:r})=>{const a=ye(),o=ee(),i=a.pathname===t,l=()=>{o(t),Y(null)};return e.jsx(gs,{onClick:l,className:je("arco-menu-item",{"arco-menu-selected":i}),children:e.jsxs("div",{className:"custom-menu-item",children:[e.jsxs("span",{children:[e.jsx(s,{}),n]}),e.jsx(ia,{count:r})]})},t)},la=()=>{const{historyCount:t,starredCount:s,unreadTodayCount:n}=f(O),{polyglot:r}=f(E),a=f(qr);return e.jsxs(e.Fragment,{children:[e.jsx(Ee,{path:"/all",Icon:en,label:r.t("sidebar.all"),count:a}),e.jsx(Ee,{path:"/today",Icon:Bt,label:r.t("sidebar.today"),count:n}),e.jsx(Ee,{path:"/starred",Icon:at,label:r.t("sidebar.starred"),count:s}),e.jsx(Ee,{path:"/history",Icon:tn,label:r.t("sidebar.history"),count:t})]})},ca=({feed:t})=>{const{showFeedIcon:s}=f(S),n=ee(),a=ye().pathname===`/feed/${t.id}`;return e.jsx(gs,{className:je({"arco-menu-selected":a}),style:{position:"relative",overflow:"hidden"},onClick:o=>{o.stopPropagation(),n(`/feed/${t.id}`),Y(null)},children:e.jsxs("div",{className:"custom-menu-item",children:[e.jsxs(T.Ellipsis,{expandable:!1,showTooltip:!0,style:{width:t.unreadCount?"80%":"100%",paddingLeft:"20px",boxSizing:"border-box"},children:[s&&e.jsx(ms,{feed:t,className:"feed-icon-sidebar"}),t.title]}),t.unreadCount!==0&&e.jsx(T.Ellipsis,{className:"item-count",expandable:!1,children:t.unreadCount})]})},`/feed/${t.id}`)},da=({categoryId:t})=>{var r;const{showUnreadFeedsOnly:s}=f(S),n=f(ls);return e.jsx(e.Fragment,{children:(r=n[t])==null?void 0:r.filter(a=>!s||a.unreadCount>0).map(a=>e.jsx(ca,{feed:a},`/feed/${a.id}`))})},ua=()=>{const{showUnreadFeedsOnly:t}=f(S),s=f(Hr),r=ye().pathname;return s.filter(a=>!t||a.unreadCount>0).map(a=>e.jsx(zt.Item,{name:`/category/${a.id}`,style:{position:"relative",overflow:"hidden"},header:e.jsx(oa,{category:a,path:r}),expandIcon:e.jsx(sn,{}),children:e.jsx(da,{categoryId:a.id})},a.id))},xs=()=>{const{homePage:t}=f(S),{isAppDataReady:s}=f(O),{polyglot:n}=f(E),r=ye(),[a,o]=m.useState([`/${t}`]),i=r.pathname;return m.useEffect(()=>{o([i])},[i]),e.jsx("div",{className:"sidebar-container",children:e.jsx(rt,{style:{maxHeight:"100%"},children:e.jsxs(Z,{hasCollapseButton:!1,selectedKeys:a,children:[e.jsxs("div",{className:"menu-header",children:[e.jsx(Qs,{className:"avatar",size:32,children:e.jsx(Zs,{style:{color:"var(--color-bg-1)"}})}),e.jsx(T.Title,{heading:6,style:{margin:0},children:"ReactFlux"})]}),e.jsx(T.Title,{className:"section-title",heading:6,style:{paddingLeft:"12px"},children:n.t("sidebar.articles")}),e.jsx(Ne,{loading:!s,animation:!0,text:{rows:3}}),s&&e.jsx(la,{}),e.jsx(T.Title,{className:"section-title",heading:6,style:{paddingLeft:"12px"},children:n.t("sidebar.feeds")}),e.jsx(Ne,{loading:!s,animation:!0,text:{rows:6}}),s&&e.jsx(zt,{triggerRegion:"icon",bordered:!1,children:e.jsx(ua,{})})]})})})},D=({children:t,...s})=>{const{isBelowMedium:n}=ne(),[r,a]=m.useState(!1);return e.jsx(ze,{popupVisible:!n&&r,onVisibleChange:o=>a(o),...s,children:t})},ha=()=>{const{server:t}=f(ve),{showAllFeeds:s,theme:n}=f(S),{polyglot:r}=f(E),a=[{label:r.t("header.theme_option_light"),value:"light"},{label:r.t("header.theme_option_dark"),value:"dark"},{label:r.t("header.theme_option_system"),value:"system"}],o=ee(),i=ye().pathname,{setAddFeedModalVisible:l,setSettingsModalVisible:c}=qe(),{isBelowLarge:u}=ne(),[h,d]=m.useState(!1),[p,x]=m.useState(!1),[g,y]=m.useState(!1);m.useEffect(()=>{u||d(!1)},[u]),m.useEffect(()=>{i&&d(!1)},[i]);const v=()=>{H({showAllFeeds:!s})},k=()=>{H({theme:n==="light"?"dark":"light"})},$=()=>{ir(),x(!1)},L=()=>{pr(),sa(),Wr(),o("/login"),j.success(r.t("header.logout_success"))},_=()=>n==="dark"?e.jsx(hn,{}):n==="system"?e.jsx(pn,{}):e.jsx(fn,{});return e.jsxs("div",{className:"header",children:[e.jsx("div",{className:"brand",children:e.jsx(w,{className:"trigger",onClick:()=>d(!h),shape:"circle",size:"small",children:e.jsx(nn,{})})}),e.jsx(rn,{className:"sidebar-drawer",visible:h,title:null,footer:null,closable:!1,onCancel:()=>d(!1),placement:"left",width:240,children:e.jsx(xs,{})}),e.jsx("div",{className:"button-group",children:e.jsxs(xe,{size:16,children:[e.jsx(D,{content:r.t("header.add_feed"),mini:!0,children:e.jsx(w,{shape:"circle",size:"small",type:"primary",icon:e.jsx(ot,{}),onClick:()=>l(!0)})}),e.jsx(D,{mini:!0,content:s?r.t("header.hide_some_feeds"):r.t("header.show_all_feeds"),children:e.jsx(w,{shape:"circle",size:"small",icon:s?e.jsx(an,{}):e.jsx(on,{}),onClick:v})}),e.jsx(w,{shape:"circle",size:"small",icon:e.jsx(ln,{}),onClick:()=>window.open("https://github.com/electh/ReactFlux","_blank")}),e.jsx(Tt,{position:"bottom",droplist:e.jsx(Z,{defaultSelectedKeys:[n],className:"theme-menu",children:a.map(({label:b,value:U})=>e.jsxs(Z.Item,{className:"theme-menu-item",onClick:()=>H({theme:U}),children:[b,n===U&&e.jsx(Ht,{})]},U))}),children:e.jsx(w,{icon:_(),shape:"circle",size:"small",onClick:k})}),e.jsx(Tt,{position:"br",trigger:"click",droplist:e.jsxs(Z,{children:[e.jsxs(Z.Item,{onClick:()=>c(!0),children:[e.jsx(cn,{className:"icon-right"}),r.t("header.settings")]},"0"),e.jsxs(Z.Item,{onClick:()=>window.open(`${t}/settings`,"_blank"),children:[e.jsx(dn,{className:"icon-right"}),r.t("header.miniflux_settings")]},"1"),e.jsxs(Z.Item,{onClick:()=>x(!0),children:[e.jsx(be,{className:"icon-right"}),r.t("header.reset_settings")]},"2"),e.jsx(z,{style:{margin:"4px 0"}}),e.jsxs(Z.Item,{onClick:()=>y(!0),children:[e.jsx(un,{className:"icon-right"}),r.t("header.logout")]},"3")]}),children:e.jsx(w,{icon:e.jsx(qt,{}),shape:"circle",size:"small"})})]})}),e.jsx(se,{onCancel:()=>x(!1),onOk:$,title:r.t("header.settings_reset_confirm"),visible:p,children:e.jsx("p",{children:r.t("header.settings_reset_description")})}),e.jsx(se,{onCancel:()=>y(!1),onOk:L,title:r.t("header.logout_confirm"),visible:g,children:e.jsx("p",{children:r.t("header.logout_description")})})]})},pa=(t,s)=>{const n=t.split("."),r=s.split(".");for(let a=0;a<Math.max(n.length,r.length);a++){const o=n[a]||"0",i=r[a]||"0",l=o.localeCompare(i,void 0,{numeric:!0});if(l!==0)return l}return 0},xt=()=>{const t=m.useRef(!1);return{fetchAppData:async()=>{if(!t.current){t.current=!0,Lt(!1);try{const n=await Promise.all([Nr(),Le(0,"unread"),ns(),Pr(),gr(),zr()]),[r,a,o,i,l,c]=n,u=i.reduce((d,p)=>(d[p.id]=r.unreads[p.id]??0,d),{}),h=Object.values(r.reads).reduce((d,p)=>d+p,0);ft(u),mt(a.total??0),Oe(o.total??0),Me(h),ae(i),Pe(l),Kr(pa(c.version,"2.2.0")>=0),Lt(!0)}catch(n){console.error("Error fetching app data: ",n)}finally{t.current=!1}}}}},_s=m.createContext(),fa=({children:t})=>{const s=f(E),[n,r]=m.useState(!1),a=m.useRef(null),o=m.useRef(null),{handleEntryStatusUpdate:i}=Ge(),l=m.useCallback(async h=>{Nt(!0),Y({...h,status:"read"}),setTimeout(()=>{const d=a.current;if(d){const p=d.querySelector(".simplebar-content-wrapper");p&&p.scroll({top:0}),d.focus()}Nt(!1),h.status==="unread"&&(i(h,"read"),Ke([h.id],"read").catch(()=>{j.error(s.t("content.mark_as_read_error")),Y({...h,status:"unread"}),i(h,"unread")}))},200)},[s,i]),c=m.useCallback(h=>{r(h)},[]),u=m.useMemo(()=>({entryDetailRef:a,entryListRef:o,handleEntryClick:l,isSwipingCodeBlock:n,setActiveContent:Y,setIsSwipingCodeBlock:c}),[l,n,c]);return e.jsx(_s.Provider,{value:u,children:t})},_t=()=>m.useContext(_s),tt={Red:{light:"#F53F3F",dark:"#F76965"},Orange:{light:"#F77234",dark:"#F9925A"},Gold:{light:"#F7BA1E",dark:"#F9CC44"},Green:{light:"#00B42A",dark:"#27C346"},Cyan:{light:"#14C9C9",dark:"#3FD4CF"},Blue:{light:"#165DFF",dark:"#3C7EFF"},Purple:{light:"#722ED1",dark:"#8E51DA"},Magenta:{light:"#F5319D",dark:"#F756A9"}},_e=t=>{const s=tt[t]||tt.Blue,n=window.matchMedia("(prefers-color-scheme: dark)").matches,r=V("theme");return(r==="system"?n:r==="dark")?s.dark:s.light},ys=t=>{mn(_e(t),{list:!0}).map(gn).forEach((n,r)=>{document.body.style.setProperty(`--primary-${r+1}`,n)})},B=({title:t,description:s,children:n})=>e.jsxs("section",{className:"setting-row",children:[e.jsxs("header",{children:[e.jsx(T.Title,{heading:6,style:{marginTop:0},children:t}),e.jsx(T.Text,{type:"secondary",children:s})]}),n]}),ma=()=>{const{articleWidth:t,fontSize:s,fontFamily:n,layout:r,showDetailedRelativeTime:a,showEstimatedReadingTime:o,showFeedIcon:i,themeColor:l}=f(S),{polyglot:c}=f(E),u=[{label:c.t("appearance.font_family_system"),value:"system-ui"},{label:"Sans-serif",value:"sans-serif"},{label:"Serif",value:"serif"},{label:"Fira Sans",value:"'Fira Sans', sans-serif"},{label:"Open Sans",value:"'Open Sans', sans-serif"},{label:"Source Sans Pro",value:"'Source Sans Pro', sans-serif"},{label:"Source Serif Pro",value:"'Source Serif Pro', serif"},{label:c.t("appearance.font_family_noto_sans"),value:"'Noto Sans SC', sans-serif"},{label:c.t("appearance.font_family_noto_serif"),value:"'Noto Serif SC', serif"},{label:c.t("appearance.font_family_lxgw_wenkai"),value:"'LXGW WenKai Screen', sans-serif"}],h=d=>{H(d),d.themeColor&&ys(d.themeColor)};return e.jsxs(e.Fragment,{children:[e.jsx(B,{title:c.t("appearance.theme_color_label"),description:c.t("appearance.theme_color_description"),children:e.jsx("div",{style:{display:"flex"},children:Object.keys(tt).map(d=>e.jsx("div",{style:{width:"18px",height:"18px",borderRadius:"50%",margin:"2px",backgroundColor:_e(d),cursor:"pointer",border:"3px solid var(--color-bg-3)",outline:d===l?`1px solid ${_e(d)}`:"none"},onClick:()=>h({themeColor:d}),onKeyDown:p=>{(p.key==="Enter"||p.key===" ")&&h({themeColor:d})},"aria-label":c.t("appearance.theme_color_aria_label",{color:d}),role:"button",tabIndex:0},d))})}),e.jsx(z,{}),e.jsx(B,{title:c.t("appearance.compact_article_card_label"),description:c.t("appearance.compact_article_card_description"),children:e.jsx(G,{checked:r==="small",onChange:d=>h({layout:d?"small":"large"})})}),e.jsx(z,{}),e.jsx(B,{title:c.t("appearance.show_detailed_relative_time_label"),description:c.t("appearance.show_detailed_relative_time_description"),children:e.jsx(G,{checked:a,onChange:d=>h({showDetailedRelativeTime:d})})}),e.jsx(z,{}),e.jsx(B,{title:c.t("appearance.show_estimated_reading_time_label"),description:c.t("appearance.show_estimated_reading_time_description"),children:e.jsx(G,{checked:o,onChange:d=>h({showEstimatedReadingTime:d})})}),e.jsx(z,{}),e.jsx(B,{title:c.t("appearance.show_feed_icon_label"),description:c.t("appearance.show_feed_icon_description"),children:e.jsx(G,{checked:i,onChange:d=>h({showFeedIcon:d})})}),e.jsx(z,{}),e.jsx(B,{title:c.t("appearance.font_family_label"),description:c.t("appearance.font_family_description"),children:e.jsx(F,{style:{width:166},value:n,onChange:d=>h({fontFamily:d}),children:u.map(({label:d,value:p})=>e.jsx(F.Option,{value:p,children:d},p))})}),e.jsx(z,{}),e.jsx(B,{title:c.t("appearance.font_size_label"),description:c.t("appearance.font_size_description"),children:e.jsxs(xe,{children:[e.jsx(T.Text,{style:{fontSize:"0.75rem"},children:"A"}),e.jsx(It,{formatTooltip:d=>`${d}rem`,max:1.25,min:.75,showTicks:!0,step:.05,style:{width:200},value:s,onChange:d=>h({fontSize:d})}),e.jsx(T.Text,{style:{fontSize:"1.25rem"},children:"A"})]})}),e.jsx(z,{}),e.jsx(B,{title:c.t("appearance.article_width_label"),description:c.t("appearance.article_width_description"),children:e.jsxs(xe,{children:[e.jsx(T.Text,{children:"60%"}),e.jsx(It,{formatTooltip:d=>`${d}%`,max:90,min:60,showTicks:!0,step:10,style:{width:160},value:t,onChange:d=>h({articleWidth:d})}),e.jsx(T.Text,{children:"90%"})]})})]})},ga=()=>{const t=f(we),{polyglot:s}=f(E),[n]=P.useForm(),[r,a]=m.useState(!1),[o,i]=m.useState(""),[l,c]=m.useState({}),[u,h]=m.useState(!1),d=async()=>{if(!o.trim()){h(!1);return}try{const g=await xr(o);Pe(y=>[...y,{...g}]),j.success(s.t("category_list.add_category_success"))}catch(g){console.error(`${s.t("category_list.add_category_error")}: `,g),j.error(s.t("category_list.add_category_error"))}i(""),h(!1)},p=async(g,y,v)=>{try{const k=await yr(g,y,v);ae($=>$.map(L=>L.category.id===g?{...L,category:{...L.category,title:y,hide_globally:v}}:L)),Pe($=>$.map(L=>L.id===g?{...L,...k}:L)),j.success(s.t("category_list.update_category_success"))}catch{j.error(s.t("category_list.update_category_error"))}a(!1),n.resetFields()},x=async g=>{try{(await _r(g.id)).status===204?(Pe(v=>v.filter(k=>k.id!==g.id)),j.success(s.t("category_list.remove_category_success",{title:g.title}))):j.error(s.t("category_list.remove_category_error",{title:g.title}))}catch(y){console.error(s.t("category_list.remove_category_error",{title:g.title}),y),j.error(s.t("category_list.remove_category_error",{title:g.title}))}};return e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[t.map(g=>e.jsx(re,{className:"tag-style",closable:g.feedCount===0,size:"medium",onClick:()=>{c(g),a(!0),n.setFieldsValue({title:g.title})},onClose:async y=>{y.stopPropagation(),await x(g)},children:g.title},g.id)),u?e.jsx(K,{autoFocus:!0,className:"input-style",onBlur:d,onChange:i,onPressEnter:d,size:"small",value:o}):e.jsx(re,{className:"add-category-tag",icon:e.jsx(ot,{}),onClick:()=>h(!0),size:"medium",tabIndex:0})]}),l&&e.jsx(se,{className:"modal-style",onOk:n.submit,title:s.t("category_list.edit_category_title"),unmountOnExit:!0,visible:r,onCancel:()=>{a(!1),n.resetFields()},children:e.jsxs(P,{form:n,layout:"vertical",onSubmit:g=>p(l.id,g.title,g.hidden),labelCol:{style:{flexBasis:90}},wrapperCol:{style:{flexBasis:"calc(100% - 90px)"}},children:[e.jsx(P.Item,{label:s.t("category_list.edit_category_title_label"),field:"title",rules:[{required:!0}],children:e.jsx(K,{placeholder:s.t("category_list.edit_category_title_placeholder")})}),e.jsx(P.Item,{label:s.t("category_list.edit_category_hidden_label"),field:"hidden",initialValue:l.hide_globally,triggerPropName:"checked",rules:[{type:"boolean"}],children:e.jsx(G,{})})]})})]})},xa=t=>new Promise(s=>setTimeout(s,t)),_a=(t,s,n=!1)=>{let r;return function(...a){const o=()=>{r=null,n||t.apply(this,a)},i=n&&!r;clearTimeout(r),r=setTimeout(o,s),i&&t.apply(this,a)}},js=({url:t,text:s,onMouseEnter:n=a=>a.target.dispatchEvent(new MouseEvent("mouseenter",{bubbles:!0})),onMouseLeave:r=a=>a.target.dispatchEvent(new MouseEvent("mouseleave",{bubbles:!0}))})=>{const[a,o]=m.useState(!1),i=c=>{o(!0),n(c)},l=c=>{o(!1),r(c)};return e.jsx(xn,{to:t,style:{color:"inherit",textDecoration:a?"underline":"none"},onMouseEnter:i,onMouseLeave:l,children:s})},bs=it(""),Mt=I(bs),yt=it("title"),ya=I(yt),jt=q([O,bs,yt],(t,s,n)=>{const{feedsData:r}=t,a=[...r].sort((o,i)=>o.disabled&&!i.disabled?1:!o.disabled&&i.disabled?-1:0).sort((o,i)=>i.parsing_error_count-o.parsing_error_count);return s?ds(a,s,[n]):a}),ja=q(jt,t=>t.map(s=>({category:s.category,checked_at:s.checked_at,crawler:s.crawler,disabled:s.disabled,feed_url:s.feed_url,hidden:s.hide_globally,key:s.id,parsing_error_count:s.parsing_error_count,site_url:s.site_url,title:s.title}))),vs=(t,s,n=null)=>n===null||n===t.id?{...t,parsing_error_count:s?0:t.parsing_error_count+1,checked_at:kr()}:t,ws=async(t,s,n=!0)=>{const{polyglot:r}=E.get();try{const o=(await t()).status===204;return n&&(o?j.success(r.t("feed_table.refresh_success")):j.error(r.t("feed_table.refresh_error"))),ae(i=>i.map(l=>s(l,o))),o}catch(a){return console.error("Failed to refresh feed: ",a),n&&j.error(r.t("feed_table.refresh_error")),ae(o=>o.map(i=>s(i,!1))),!1}},Ss=async(t,s=!0)=>{const n=t.id||t.key;return ws(()=>Rr(n),(r,a)=>vs(r,a,n),s)},ba=({visible:t,setVisible:s})=>{const{polyglot:n}=f(E),r=f(jt),a=async()=>{s(!1),await ws(Dr,vs)},o=async()=>{s(!1);const l=r.filter(h=>h.parsing_error_count>0);j.success(n.t("feed_table.bulk_refresh_error_feeds_message"));let c=0,u=0;for(const h of l)await Ss(h,!1)?c++:u++,await xa(500);j.success(n.t("feed_table.bulk_refresh_error_feeds_result",{success:c,failure:u}))},i=()=>s(!1);return e.jsxs(e.Fragment,{children:[e.jsx(D,{content:n.t("feed_table.refresh_feeds_tooltip"),mini:!0,children:e.jsx(w,{icon:e.jsx(be,{}),shape:"circle",size:"small",onClick:()=>s(!0)})}),e.jsx(se,{className:"edit-modal",onCancel:i,title:n.t("feed_table.refresh_feeds_title"),visible:t,footer:[e.jsx(w,{onClick:i,children:n.t("feed_table.refresh_feeds_cancel")},"cancel"),e.jsx(w,{type:"outline",onClick:o,children:n.t("feed_table.refresh_feeds_error")},"error"),e.jsx(w,{type:"primary",onClick:a,children:n.t("feed_table.refresh_feeds_all")},"all")],children:e.jsx("p",{children:n.t("feed_table.refresh_feeds_description")})})]})},va=({visible:t,setVisible:s})=>{const{polyglot:n}=f(E),r=f(jt),[a,o]=m.useState(""),i=async()=>{try{const l=await Promise.all(r.map(async u=>{const h=new URL(u.feed_url).hostname;if(h===a)return u;const d=u.feed_url.replace(h,a),p=await rs(u.id,{feedUrl:d});return{...u,...p}})),c=(u,h)=>h.find(p=>p.id===u.id)||u;ae(u=>u.map(h=>c(h,l))),j.success(n.t("feed_table.bulk_update_success")),s(!1)}catch(l){console.error("Failed to bulk update feeds: ",l),j.error(n.t("feed_table.bulk_update_error"))}};return e.jsx(se,{className:"edit-modal",onOk:i,title:n.t("feed_table.modal_bulk_update_title"),visible:t,onCancel:()=>{s(!1),o("")},children:e.jsx(K,{placeholder:"rsshub.app",prefix:e.jsx(ze,{content:n.t("feed_table.modal_bulk_update_description"),children:e.jsx(lt,{})}),value:a,onChange:l=>o(l)})})},wa=({visible:t,setVisible:s,feedForm:n,selectedFeed:r})=>{const{polyglot:a}=f(E),o=f(we),i=async(l,c)=>{try{const u=await rs(l,c);ae(h=>h.map(d=>d.id===l?{...d,...u}:d)),j.success(a.t("feed_table.update_feed_success")),s(!1),n.resetFields()}catch(u){console.error("Failed to update feed: ",u),j.error(a.t("feed_table.update_feed_error"))}};return e.jsx(se,{className:"edit-modal",onOk:n.submit,title:a.t("feed_table.modal_edit_feed_title"),unmountOnExit:!0,visible:t,onCancel:()=>{s(!1),n.resetFields()},children:e.jsxs(P,{form:n,labelCol:{span:7},layout:"vertical",wrapperCol:{span:17},onSubmit:async l=>{const c={categoryId:l.category,title:l.title,siteUrl:l.siteUrl.trim(),feedUrl:l.feedUrl.trim(),hidden:l.hidden,disabled:l.disabled,isFullText:l.crawler};c.feedUrl?await i(r.key,c):j.error(a.t("feed_table.modal_edit_feed_submit_error"))},children:[e.jsx(P.Item,{label:a.t("feed_table.modal_edit_feed_category_label"),required:!0,field:"category",rules:[{required:!0}],children:e.jsx(F,{children:o.map(l=>e.jsx(F.Option,{value:l.id,children:l.title},l.id))})}),e.jsx(P.Item,{label:a.t("feed_table.modal_edit_feed_title_label"),field:"title",rules:[{required:!0}],children:e.jsx(K,{placeholder:a.t("feed_table.modal_edit_feed_title_placeholder")})}),e.jsx(P.Item,{label:a.t("feed_table.modal_edit_feed_site_url_label"),field:"siteUrl",rules:[{required:!0}],children:e.jsx(K,{placeholder:a.t("feed_table.modal_edit_feed_site_url_placeholder")})}),e.jsx(P.Item,{label:a.t("feed_table.modal_edit_feed_feed_url_label"),field:"feedUrl",rules:[{required:!0}],children:e.jsx(K,{placeholder:a.t("feed_table.modal_edit_feed_feed_url_placeholder")})}),e.jsx(P.Item,{label:a.t("feed_table.modal_edit_feed_hidden_label"),field:"hidden",initialValue:r.hidden,triggerPropName:"checked",rules:[{type:"boolean"}],children:e.jsx(G,{})}),e.jsx(P.Item,{label:a.t("feed_table.modal_edit_feed_disabled_label"),field:"disabled",initialValue:r.disabled,triggerPropName:"checked",rules:[{type:"boolean"}],children:e.jsx(G,{})}),e.jsx(P.Item,{label:a.t("feed_table.modal_edit_feed_crawler_label"),field:"crawler",tooltip:e.jsx("div",{children:a.t("feed_table.modal_edit_feed_crawler_tooltip")}),triggerPropName:"checked",rules:[{type:"boolean"}],children:e.jsx(G,{})})]})})},Sa=()=>{const{isAppDataReady:t}=f(O),{showDetailedRelativeTime:s}=f(S),n=f(yt),r=f(ja),{polyglot:a}=f(E),o=a.t("search.tooltip").split(`
`),[i,l]=m.useState(!1),[c,u]=m.useState(!1),[h,d]=m.useState(!1),[p]=P.useForm(),[x,g]=m.useState(null),{isBelowMedium:y}=ne(),v=ee();m.useEffect(()=>{Mt("")},[]);const k=_=>{g(_),d(!0),p.setFieldsValue({category:_.category.id,title:_.title,siteUrl:_.site_url,feedUrl:_.feed_url,hidden:_.hidden,disabled:_.disabled,crawler:_.crawler})},$=async _=>{try{(await Or(_.key)).status===204?(ae(U=>U.filter(J=>J.id!==_.key)),j.success(a.t("feed_table.remove_feed_success",{title:_.title}))):j.error(a.t("feed_table.remove_feed_error",{title:_.title}))}catch(b){console.error(`Failed to unfollow feed: ${_.title}`,b),j.error(a.t("feed_table.remove_feed_error",{title:_.title}))}},L=[{title:a.t("feed_table.table_title"),dataIndex:"title",sorter:(_,b)=>_.title.localeCompare(b.title,"en"),render:(_,b)=>{const U=b.parsing_error_count;let J=b.disabled?`🚫 ${_}`:_;U>0&&(J=`⚠️ ${_}`);const X=e.jsxs("div",{children:[_,U>0&&e.jsxs(e.Fragment,{children:[e.jsx("br",{}),"⚠️ Parsing error count: ",U]})]});return e.jsx(T.Ellipsis,{expandable:!1,children:e.jsx(D,{content:X,mini:!0,children:e.jsx(js,{url:`/feed/${b.key}`,text:J})})})}},!y&&{title:a.t("feed_table.table_url"),dataIndex:"feed_url",sorter:(_,b)=>_.feed_url.localeCompare(b.feed_url,"en"),render:_=>e.jsx(T.Ellipsis,{expandable:!1,showTooltip:!0,children:_})},{title:a.t("feed_table.table_category"),dataIndex:"category.title",sorter:(_,b)=>_.category.title.localeCompare(b.category.title,"en"),render:(_,b)=>e.jsx(T.Ellipsis,{expandable:!1,showTooltip:!0,children:e.jsx(re,{size:"small",style:{cursor:"pointer"},onClick:()=>v(`/category/${b.category.id}`),children:_})})},!y&&{title:a.t("feed_table.table_checked_at"),dataIndex:"checked_at",sorter:(_,b)=>_.checked_at.localeCompare(b.checked_at,"en"),render:_=>e.jsx(T.Ellipsis,{expandable:!1,children:ts(_,s)})},{title:a.t("feed_table.table_actions"),dataIndex:"op",fixed:"right",width:100,render:(_,b)=>e.jsxs(xe,{style:{marginLeft:-10},children:[e.jsx(D,{content:a.t("feed_table.table_feed_edit_tooltip"),mini:!0,children:e.jsx(w,{icon:e.jsx(Et,{}),shape:"circle",size:"mini",onClick:()=>k(b)})}),e.jsx(D,{content:a.t("feed_table.table_feed_refresh_tooltip"),mini:!0,children:e.jsx(w,{icon:e.jsx(be,{}),shape:"circle",size:"mini",onClick:()=>Ss(b)})}),e.jsx(Kt,{focusLock:!0,position:"left",title:a.t("feed_table.table_feed_remove_confirm"),onOk:()=>$(b),children:e.jsx(D,{content:a.t("feed_table.table_feed_remove_tooltip"),mini:!0,children:e.jsx(w,{icon:e.jsx(_n,{}),shape:"circle",size:"mini"})})})]})}].filter(Boolean);return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"feed-table-action-bar",children:[e.jsx("div",{style:{display:"flex",flex:1,justifyContent:"left",minWidth:0},children:e.jsx(K.Search,{allowClear:!0,className:"search-input",onChange:Mt,placeholder:a.t("search.placeholder"),addBefore:e.jsxs(F,{onChange:ya,style:{width:80},triggerProps:{autoAlignPopupWidth:!1,autoAlignPopupMinWidth:!0,position:"bl"},value:n,children:[e.jsx(F.Option,{value:"title",children:a.t("search.type_title")}),e.jsx(F.Option,{value:"feed_url",children:a.t("search.type_feed_url")}),e.jsx(F.Option,{value:"site_url",children:a.t("search.type_site_url")})]}),prefix:e.jsx(ze,{mini:!0,position:"bottom",content:e.jsx("div",{children:o.map((_,b)=>e.jsxs(m.Fragment,{children:[_,b<o.length-1&&e.jsx("br",{})]},`line-${b}-${_.length}`))}),children:e.jsx(lt,{})})})}),e.jsxs("div",{className:"button-group",children:[e.jsx(D,{content:a.t("feed_table.table_feed_bulk_update_tooltip"),mini:!0,children:e.jsx(w,{icon:e.jsx(Et,{}),shape:"circle",size:"small",onClick:()=>l(!0)})}),e.jsx(va,{visible:i,setVisible:l}),e.jsx(ba,{visible:c,setVisible:u})]})]}),e.jsx(Wt,{borderCell:!0,className:"feed-table",columns:L,data:r,loading:!t,pagePosition:"bottomCenter",scroll:{x:!0},size:"small"}),x&&e.jsx(wa,{visible:h,setVisible:d,feedForm:p,selectedFeed:x})]})},Ca=[{label:"English",value:"en-US"},{label:"Español",value:"es-ES"},{label:"简体中文",value:"zh-CN"}],ka=()=>{const{homePage:t,language:s,markReadOnScroll:n,orderBy:r,pageSize:a,removeDuplicates:o,showUnreadFeedsOnly:i}=f(S),{polyglot:l}=f(E),c=[{label:l.t("settings.default_home_page_option_all"),value:"all"},{label:l.t("settings.default_home_page_option_today"),value:"today"},{label:l.t("settings.default_home_page_option_starred"),value:"starred"},{label:l.t("settings.default_home_page_option_history"),value:"history"}],u=[{label:l.t("settings.remove_duplicates_option_none"),value:"none"},{label:l.t("settings.remove_duplicates_option_hash"),value:"hash"},{label:l.t("settings.remove_duplicates_option_title"),value:"title"},{label:l.t("settings.remove_duplicates_option_url"),value:"url"}];return e.jsxs(e.Fragment,{children:[e.jsx(B,{title:l.t("appearance.language_label"),description:l.t("appearance.language_description"),children:e.jsx(F,{className:"input-select",onChange:h=>H({language:h}),value:s,children:Ca.map(({label:h,value:d})=>e.jsx(F.Option,{value:d,children:h},d))})}),e.jsx(z,{}),e.jsx(B,{title:l.t("settings.default_home_page_label"),description:l.t("settings.default_home_page_description"),children:e.jsx(F,{className:"input-select",onChange:h=>H({homePage:h}),value:t,children:c.map(({label:h,value:d})=>e.jsx(F.Option,{value:d,children:h},d))})}),e.jsx(z,{}),e.jsx(B,{title:l.t("settings.show_unread_feeds_only_label"),description:l.t("settings.show_unread_feeds_only_description"),children:e.jsx(G,{checked:i,onChange:h=>H({showUnreadFeedsOnly:h})})}),e.jsx(z,{}),e.jsx(B,{title:l.t("settings.entries_order_label"),description:l.t("settings.entries_order_description"),children:e.jsxs(F,{className:"input-select",onChange:h=>H({orderBy:h}),value:r,children:[e.jsx(F.Option,{value:"published_at",children:l.t("settings.entries_order_option_published_at")}),e.jsx(F.Option,{value:"created_at",children:l.t("settings.entries_order_option_created_at")})]})}),e.jsx(z,{}),e.jsx(B,{title:l.t("settings.entries_per_page_label"),description:l.t("settings.entries_per_page_description"),children:e.jsx(yn,{className:"input-select",defaultValue:a,min:1,mode:"button",onChange:h=>H({pageSize:h}),size:"small"})}),e.jsx(z,{}),e.jsx(B,{title:l.t("settings.remove_duplicates_label"),description:l.t("settings.remove_duplicates_description"),children:e.jsx(F,{className:"input-select",onChange:h=>H({removeDuplicates:h}),value:o,children:u.map(({label:h,value:d})=>e.jsx(F.Option,{value:d,children:h},d))})}),e.jsx(z,{}),e.jsx(B,{title:l.t("settings.mark_read_on_scroll_label"),description:l.t("settings.mark_read_on_scroll_description"),children:e.jsx(G,{checked:n,onChange:h=>H({markReadOnScroll:h})})})]})},st={exitDetailView:["esc"],fetchOriginalArticle:["d"],navigateToNextArticle:["n","j","right"],navigateToNextUnreadArticle:["shift+n","shift+j","ctrl+right"],navigateToPreviousArticle:["p","k","left"],navigateToPreviousUnreadArticle:["shift+p","shift+k","ctrl+left"],openLinkExternally:["v"],openPhotoSlider:["i"],saveToThirdPartyServices:["s"],showHotkeysSettings:["shift+?"],toggleReadStatus:["m"],toggleStarStatus:["f"]},Ye=nt("hotkeys",st,{encode:JSON.stringify,decode:t=>{const s=JSON.parse(t);return{...st,...s}}}),bt=q(Ye,t=>{const n=Object.values(t).flat().reduce((r,a)=>(r[a]=(r[a]||0)+1,r),{});return Object.entries(n).filter(([r,a])=>a>1).map(([r])=>r)}),ge=(t,s)=>{I(Ye,t)(s)},Ta=t=>ge(t,st[t]),Ia=({value:t,onChange:s,onRemove:n,editOnMount:r=!1})=>{const a=f(bt),[o,i]=m.useState(r),l=()=>{t===""&&n(),i(!1)},c=m.useCallback(u=>{if(o){u.preventDefault();const{key:h,ctrlKey:d,shiftKey:p,altKey:x,metaKey:g}=u;if(["Control","Shift","Alt","Meta","CapsLock"].includes(h))return;let y=h;switch(h){case"ArrowLeft":case"ArrowRight":case"ArrowUp":case"ArrowDown":y=h.replace("Arrow","").toLowerCase();break;case" ":y="space";break}const v=[];d&&v.push("ctrl"),p&&v.push("shift"),x&&v.push("alt"),g&&v.push("meta");const k=v.length>0?`${v.join("+")}+${y}`:y;s(k),i(!1)}},[o,s]);return m.useEffect(()=>(window.addEventListener("keydown",c),()=>{window.removeEventListener("keydown",c)}),[c]),o?e.jsx(K,{autoFocus:!0,onBlur:l,onChange:s,onPressEnter:l,size:"mini",status:a.includes(t)?"error":void 0,style:{width:80},value:t}):e.jsx(re,{closable:!!n,color:a.includes(t)?_e("Red"):void 0,onClick:()=>i(!0),onClose:u=>{u.stopPropagation(),n()},children:t})},Ot=t=>t.charAt(0).toUpperCase()+t.slice(1),Ea=t=>t.map(s=>{const n=s.replace("left","←").replace("right","→").replace("up","↑").replace("down","↓");return n.includes("+")?n.split("+").map(Ot).join(" + "):Ot(n)}).join(" / "),Aa=({keys:t,record:s})=>{const n=f(bt),[r,a]=m.useState(!1),o=m.useRef(null);return m.useEffect(()=>{const i=l=>{o.current&&!o.current.contains(l.target)&&a(!1)};return document.addEventListener("mousedown",i),()=>{document.removeEventListener("mousedown",i)}},[]),m.useEffect(()=>{if(!r){const i=t.filter(l=>l!=="");i.length!==t.length&&ge(s.action,i)}},[r]),e.jsx("div",{ref:o,children:r?e.jsxs(xe,{wrap:!0,style:{marginBottom:-8},children:[t.map((i,l)=>e.jsx(Ia,{value:i,editOnMount:i==="",onChange:c=>{const u=[...t];u[l]=c,ge(s.action,u)},onRemove:()=>{const c=t.filter((u,h)=>h!==l);ge(s.action,c)}},`${s.action}-${i}`)),e.jsx(re,{icon:e.jsx(ot,{}),style:{backgroundColor:"var(--color-fill-2)",border:"1px dashed var(--color-fill-3)",cursor:"pointer",width:"32px"},onClick:()=>{const i=[...t,""];ge(s.action,i)}}),e.jsx(w,{icon:e.jsx(be,{}),onClick:()=>Ta(s.action),shape:"circle",size:"mini"})]}):e.jsx(re,{color:t.some(i=>n.includes(i))?_e("Red"):void 0,onClick:()=>a(!0),style:{cursor:"pointer"},children:Ea(t)})})},Fa=()=>{const{polyglot:t}=f(E),s=f(Ye),n=["navigateToPreviousArticle","navigateToPreviousUnreadArticle","navigateToNextArticle","navigateToNextUnreadArticle","openLinkExternally","toggleReadStatus","fetchOriginalArticle","toggleStarStatus","saveToThirdPartyServices","openPhotoSlider","exitDetailView","showHotkeysSettings"],r=[{title:t.t("hotkeys.key"),dataIndex:"keys",fixed:"left",width:"50%",render:(o,i)=>e.jsx(Aa,{keys:o,record:i})},{title:t.t("hotkeys.function"),dataIndex:"description"}],a=n.map(o=>({action:o,key:o,keys:s[o],description:t.t(`hotkeys.${o}`)}));return e.jsx(Wt,{borderCell:!0,columns:r,data:a,pagination:!1,size:"small",style:{margin:"0 auto",width:"90%"}})},pe=({icon:t,title:s})=>e.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center"},children:[t,e.jsx("div",{style:{fontSize:"12px"},children:s})]}),La=({activeTab:t,onTabChange:s})=>{const{polyglot:n}=f(E),{isBelowMedium:r}=ne();return e.jsxs(oe,{activeTab:t,animation:!0,className:"custom-tabs",onChange:s,tabPosition:"top",children:[e.jsx(oe.TabPane,{title:e.jsx(pe,{icon:e.jsx(jn,{style:{fontSize:"20px"}}),title:n.t("settings.feeds")}),children:e.jsx(Sa,{})},"1"),e.jsx(oe.TabPane,{title:e.jsx(pe,{icon:e.jsx(bn,{style:{fontSize:"20px"}}),title:n.t("settings.categories")}),children:e.jsx(ga,{})},"2"),e.jsx(oe.TabPane,{title:e.jsx(pe,{icon:e.jsx(vn,{style:{fontSize:"20px"}}),title:n.t("settings.general")}),children:e.jsx(ka,{})},"3"),e.jsx(oe.TabPane,{title:e.jsx(pe,{icon:e.jsx(wn,{style:{fontSize:"20px"}}),title:n.t("settings.appearance")}),children:e.jsx(ma,{})},"4"),!r&&e.jsx(oe.TabPane,{title:e.jsx(pe,{icon:e.jsx(Sn,{style:{fontSize:"20px"}}),title:n.t("settings.hotkeys")}),children:e.jsx(Fa,{})},"5")]})},Pa=[{required:!0}],Na=[{required:!0}],Ra=[{type:"boolean"}],Da=()=>{const{setSettingsModalVisible:t,setSettingsTabsActiveTab:s,settingsModalVisible:n,settingsTabsActiveTab:r}=qe();return e.jsx(se,{autoFocus:!1,className:"settings-modal",focusLock:!0,footer:null,onCancel:()=>{t(!1),s("1")},title:null,unmountOnExit:!0,visible:n,children:e.jsx(La,{activeTab:r,onTabChange:s})})},Ma=()=>{const{polyglot:t}=f(E),s=f(we),n=f(We),[r,a]=m.useState(!1),[o]=P.useForm(),{fetchAppData:i}=xt(),{addFeedModalVisible:l,setAddFeedModalVisible:c}=qe(),u=ee(),h=async(d,p,x)=>{a(!0);try{if(n.some(y=>y.feed_url===d)){j.error(t.t("main.add_feed_error_duplicate"));return}const g=await Mr(d,p,x);i().then(()=>{j.success(t.t("main.add_feed_success")),c(!1),u(`/feed/${g.feed_id}`),o.resetFields()})}catch(g){console.error("Failed to add a feed: ",g),j.error(t.t("main.add_feed_error"))}finally{a(!1)}};return e.jsx(se,{title:t.t("main.add_feed_modal_title"),visible:l,unmountOnExit:!0,style:{width:"400px"},onOk:o.submit,confirmLoading:r,onCancel:()=>{c(!1),o.resetFields()},children:e.jsxs(P,{form:o,labelCol:{span:7},layout:"vertical",wrapperCol:{span:17},onSubmit:async d=>{const p=d.url.trim();p?await h(p,d.category,d.crawler):j.error(t.t("main.add_feed_url_empty"))},children:[e.jsx(P.Item,{label:t.t("main.add_feed_modal_feed_url_label"),field:"url",rules:Pa,children:e.jsx(K,{placeholder:t.t("main.add_feed_modal_feed_url_placeholder")})}),e.jsx(P.Item,{field:"category",label:t.t("main.add_feed_modal_category_label"),required:!0,rules:Na,children:e.jsx(F,{placeholder:t.t("main.add_feed_modal_category_placeholder"),showSearch:!0,filterOption:(d,p)=>Qr(p.props.children,d),children:s.map(d=>e.jsx(F.Option,{value:d.id,children:d.title},d.id))})}),e.jsx(P.Item,{field:"crawler",initialValue:!1,label:t.t("main.add_feed_modal_crawler_label"),rules:Ra,style:{marginBottom:0},triggerPropName:"checked",children:e.jsx(G,{})})]})})},Oa=()=>e.jsxs("div",{className:"main",children:[e.jsx(fa,{children:e.jsx(Cn,{})}),e.jsx(Da,{}),e.jsx(Ma,{})]}),Cs=()=>{const{theme:t,themeColor:s}=f(S),[n,r]=m.useState(window.matchMedia("(prefers-color-scheme: dark)").matches);m.useEffect(()=>{const a=window.matchMedia("(prefers-color-scheme: dark)"),o=i=>r(i.matches);return a.addEventListener("change",o),()=>a.removeEventListener("change",o)},[]),m.useEffect(()=>{const a=o=>{const i=o?"dark":"light";document.body.setAttribute("arco-theme",i),document.body.style.colorScheme=i};ys(s),a(t==="system"?n:t==="dark")},[n,t,s])},vt=()=>{const t=document.querySelector(".spinner");t&&(t.style.display="none")},Ua=()=>{Zt(),Cs();const{isBelowLarge:t}=ne(),{polyglot:s}=f(E);return m.useEffect(()=>{vt()},[]),s&&e.jsxs("div",{className:"app",children:[t?null:e.jsx(kn.Sider,{breakpoint:"lg",className:"sidebar",collapsible:!1,trigger:null,width:240,children:e.jsx(xs,{})}),e.jsx(ha,{}),e.jsx(Oa,{})]})},ks=t=>{const n=new DOMParser().parseFromString(t,"text/html").querySelectorAll("img");return Array.from(n).map(r=>r.getAttribute("src"))},Ts=t=>{var a;const r=(a=new DOMParser().parseFromString(t.content,"text/html").querySelector("img"))==null?void 0:a.getAttribute("src");return{...t,imgSrc:r}},Va=t=>{if((t==null?void 0:t.total)>=0){const s=t.entries.map(Ts);Ce(s),ta(t.total),fs(s.length<t.total)}},$a=(t,s)=>{const{filterDate:n}=f(A),{isAppDataReady:r}=f(O),{showStatus:a}=f(S),o=m.useRef(!1),i=async l=>{if(!o.current){o.current=!0,Pt(!1);try{const c=a==="unread"?await l(0,"unread"):await l();if(!n)switch(t.from){case"feed":a==="unread"&&ft(u=>({...u,[Number(t.id)]:c.total}));break;case"history":Me(c.total);break;case"starred":a!=="unread"&&Oe(c.total);break;case"today":a==="unread"&&mt(c.total);break}Va(c),Pt(!0)}catch(c){console.error("Error fetching articles: ",c)}finally{o.current=!1}}};return m.useEffect(()=>{r&&i(s)},[r]),{fetchArticleList:i}},wt=ie({isPhotoSliderVisible:!1,selectedIndex:0}),za=I(wt,"isPhotoSliderVisible"),Ba=I(wt,"selectedIndex"),Is=()=>{const{isPhotoSliderVisible:t,selectedIndex:s}=f(wt);return{isPhotoSliderVisible:t,setIsPhotoSliderVisible:za,selectedIndex:s,setSelectedIndex:Ba}},Es=()=>{const{activeContent:t}=f(A),s=f(gt),n=f(Se),r=f(hs),a=f(ps),{entryListRef:o,handleEntryClick:i}=_t(),l=()=>{if(o.current){const N=o.current.el.querySelector(".card-custom-selected-style");N&&N.scrollIntoView({behavior:"smooth",block:"nearest"})}},{isPhotoSliderVisible:c,setIsPhotoSliderVisible:u,setSelectedIndex:h}=Is(),{setSettingsModalVisible:d,setSettingsTabsActiveTab:p}=qe(),x=N=>(...te)=>{if(t)return N(...te)},g=x(()=>{Y(null),o.current&&o.current.contentWrapperEl.focus()}),y=()=>{r&&(i(r),setTimeout(()=>l(),200))},v=()=>{a&&(i(a),setTimeout(()=>l(),200))},k=(N,te,ke)=>(te==="prev"?ke.slice(0,N).toReversed():ke.slice(N+1)).find(Je=>Je.status==="unread"),$=N=>{const te=k(s,N,n);te&&(i(te),setTimeout(l,200))},L=()=>$("prev"),_=()=>$("next"),b=x(()=>{window.open(t.url,"_blank")}),U=x(N=>{N()}),J=x(N=>{N()}),X=()=>{console.log("showHotkeysSettings"),p("5"),d(!0)},W=x(N=>{N()}),Q=x(N=>{N()}),de=x(()=>{!ks(t.content).length||c||(h(0),u(!0))});return{exitDetailView:g,fetchOriginalArticle:U,navigateToNextArticle:v,navigateToNextUnreadArticle:_,navigateToPreviousArticle:y,navigateToPreviousUnreadArticle:L,openLinkExternally:b,openPhotoSlider:de,saveToThirdPartyServices:J,showHotkeysSettings:X,toggleReadStatus:W,toggleStarStatus:Q}},Ha=()=>{const{activeContent:t}=f(A),{polyglot:s}=f(E),n=f(ps),r=f(hs),[a,o]=m.useState(!1),{handleFetchContent:i,handleSaveToThirdPartyServices:l,handleToggleStarred:c,handleToggleStatus:u}=Ge(),{exitDetailView:h,navigateToNextArticle:d,navigateToPreviousArticle:p}=Es(),x=t.status==="unread",g=t.starred;return m.useEffect(()=>{o(!1)},[t]),e.jsxs("div",{className:"action-buttons",children:[e.jsxs("div",{className:"left-side",children:[e.jsx(D,{content:s.t("article_card.close_tooltip"),mini:!0,children:e.jsx(w,{icon:e.jsx(Tn,{}),onClick:()=>h(),shape:"circle"})}),e.jsx(D,{content:s.t("article_card.previous_tooltip"),mini:!0,children:e.jsx(w,{icon:e.jsx(In,{}),onClick:()=>p(),shape:"circle",disabled:!r})}),e.jsx(D,{content:s.t("article_card.next_tooltip"),mini:!0,children:e.jsx(w,{icon:e.jsx(En,{}),onClick:()=>d(),shape:"circle",disabled:!n})})]}),e.jsxs("div",{className:"right-side",children:[e.jsx(D,{mini:!0,content:x?s.t("article_card.mark_as_read_tooltip"):s.t("article_card.mark_as_unread_tooltip"),children:e.jsx(w,{icon:x?e.jsx(Gt,{}):e.jsx(Yt,{}),onClick:()=>u(t),shape:"circle"})}),e.jsx(D,{mini:!0,content:g?s.t("article_card.unstar_tooltip"):s.t("article_card.star_tooltip"),children:e.jsx(w,{icon:g?e.jsx(ct,{style:{color:"#ffcd00"}}):e.jsx(at,{}),onClick:()=>c(t),shape:"circle"})}),e.jsx(D,{content:s.t("article_card.fetch_original_tooltip"),mini:!0,children:e.jsx(w,{icon:e.jsx(An,{}),onClick:async()=>{await i(),o(!0)},shape:"circle",disabled:a})}),e.jsx(D,{mini:!0,content:s.t("article_card.save_to_third_party_services_tooltip"),children:e.jsx(w,{icon:e.jsx(Fn,{}),onClick:l,shape:"circle"})})]})]})},As=({children:t,duration:s=.2,y:n=20})=>e.jsx(dt.div,{initial:{opacity:0,y:n},animate:{opacity:1,y:0},exit:{opacity:0,y:0},transition:{duration:s},children:t}),St={bash:"Bash",c:"C",cpp:"C++",csharp:"C#",css:"CSS",dockerfile:"Dockerfile",go:"Go",html:"HTML",java:"Java",javascript:"JavaScript",json:"JSON",kotlin:"Kotlin",markdown:"Markdown",php:"PHP",powershell:"PowerShell",python:"Python",ruby:"Ruby",rust:"Rust",sql:"SQL",swift:"Swift",typescript:"TypeScript",xml:"XML",yaml:"YAML"},Fs=Object.keys(St),qa="markdown",Ka=t=>Fs.find(s=>t&&(t.includes(`language-${s}`)||t.includes(`lang-${s}`)||t.includes(s)));(typeof global<"u"?global:window).Prism=Jt;for(const t of Object.keys(St))fe(()=>import(`prismjs/components/prism-${t}`),[]).catch(s=>{console.warn(`Failed to load language: ${t}`,s)});const Ls={Dracula:R.dracula,DuotoneDark:R.duotoneDark,DuotoneLight:R.duotoneLight,GitHub:R.github,MaterialDark:R.gruvboxMaterialDark,MaterialLight:R.gruvboxMaterialLight,JettwaveDark:R.jettwaveDark,JettwaveLight:R.jettwaveLight,NightOwl:R.nightOwl,NightOwlLight:R.nightOwlLight,OceanicNext:R.oceanicNext,Okaidia:R.okaidia,OneDark:R.oneDark,OneLight:R.oneLight,Palenight:R.palenight,ShadesOfPurple:R.shadesOfPurple,Synthwave84:R.synthwave84,Ultramin:R.ultramin,VsDark:R.vsDark,VsLight:R.vsLight},Wa=({children:t,className:s})=>{const{highlightTheme:n}=f(S),{polyglot:r}=f(E),[a,o]=m.useState(()=>Ka(s)||qa),{isSwipingCodeBlock:i,setIsSwipingCodeBlock:l}=_t(),c=m.useCallback(()=>{navigator.clipboard.writeText(t.trim()).then(()=>j.success(r.t("actions.copied")))},[t,r]),u=t.trim(),h=u.split(`
`).length,d=Ga(h),p=`${d+1.5}em`,x=m.useCallback(()=>{i||l(!0)},[i,l]),g=m.useCallback(()=>{i&&l(!1)},[i,l]);return e.jsxs("div",{className:"code-block-container",onTouchStart:x,onTouchEnd:g,children:[e.jsx(Ya,{language:a,setLanguage:o}),e.jsx(Ja,{}),e.jsx(Xa,{onClick:c}),e.jsx(Za,{code:u,language:a,theme:Ls[n],lineNumberWidth:d,paddingLeft:p})]})},Ga=t=>t<10?1:t<100?2:t<1e3?3:Math.floor(Math.log10(t))+1,Ya=({language:t,setLanguage:s})=>e.jsx(F,{onChange:s,value:t,showSearch:!0,className:"language-selector",children:Fs.map(n=>e.jsx(F.Option,{value:n,children:St[n]||n},n))}),Ja=()=>{const{highlightTheme:t}=f(S);return e.jsx(F,{onChange:s=>H({highlightTheme:s}),value:t,showSearch:!0,className:"theme-selector",children:Object.keys(Ls).map(s=>e.jsx(F.Option,{value:s,children:s},s))})},Xa=({onClick:t})=>{const{polyglot:s}=f(E);return e.jsx(D,{content:s.t("actions.copy_to_clipboard_tooltip"),mini:!0,children:e.jsx(w,{icon:e.jsx(Ln,{}),onClick:t,className:"copy-button"})})},Qa=({number:t,width:s})=>e.jsx("span",{style:{position:"absolute",left:`-${s+1.5}em`,width:`${s+.5}em`,textAlign:"right",color:"rgba(255,255,255,0.4)",userSelect:"none",paddingRight:"0.5em"},children:t}),Za=({code:t,language:s,theme:n,lineNumberWidth:r,paddingLeft:a})=>e.jsx(Pn,{code:t,language:s,prism:Jt,theme:n,children:({className:o,style:i,tokens:l,getLineProps:c,getTokenProps:u})=>e.jsx("pre",{className:o,style:{...i,paddingTop:"50px",paddingLeft:l.length>1?a:"1.5em",position:"relative"},children:l.map((h,d)=>{var p;return e.jsxs("div",{...c({line:h,key:d}),style:{position:"relative"},children:[l.length>1&&e.jsx(Qa,{number:d+1,width:r}),h.map((x,g)=>e.jsx("span",{...u({token:x,key:g})},`token-${d}-${g}-${x.content.slice(0,5)}`))]},`line-${d}-${(p=h[0])==null?void 0:p.content.slice(0,5)}`)})})}),Ae=({imgNode:t,isIcon:s})=>{const{fontSize:n}=f(S);return e.jsx("img",{...t.attribs,alt:t.attribs.alt??"image",style:s?{display:"inline-block",width:"auto",height:`${n}rem`,margin:0}:{}})},Ut=({node:t,index:s,togglePhotoSlider:n,isLinkWrapper:r=!1})=>{var p;const[a,o]=m.useState(!1),[i,l]=m.useState(!1),{isBelowMedium:c}=ne();m.useEffect(()=>{const g=(r?t.children[0]:t).attribs.src,y=new Image;y.src=g,y.onload=()=>l(y.width<=100&&y.height<=100)},[t,r]);const u=r?t.children[0]:t;if(i)return r?e.jsxs("a",{...t.attribs,children:[e.jsx(Ae,{imgNode:u,isIcon:i}),(p=t.children[1])==null?void 0:p.data]}):e.jsx(Ae,{imgNode:u,isIcon:i});const h=()=>o(!0),d=()=>o(!1);return e.jsx("div",{style:{textAlign:"center",position:"relative"},children:e.jsxs("div",{style:{display:"inline-block",position:"relative"},onMouseEnter:h,onMouseLeave:d,children:[r?e.jsx("a",{...t.attribs,children:e.jsx(Ae,{imgNode:u,isIcon:i})}):e.jsx(Ae,{imgNode:u,isIcon:i}),e.jsx(w,{icon:e.jsx(Nn,{}),shape:"circle",style:{position:"absolute",top:30,right:10,color:"white",backgroundColor:"rgba(0, 0, 0, 0.5)",opacity:c||a?1:0,transition:"opacity 0.3s"},onClick:x=>{x.preventDefault(),n(s)}})]})})},eo=(t,s)=>({replace:n=>{var r,a;if(n.type==="tag"&&n.name==="a"&&n.children.length>0){const o=n.children[0];if(o.type==="tag"&&o.name==="img"){const i=t.findIndex(l=>l===o.attribs.src);return e.jsx(Ut,{node:n,index:i,togglePhotoSlider:s,isLinkWrapper:!0})}}else if(n.type==="tag"&&n.name==="img"){const o=t.findIndex(i=>i===n.attribs.src);return e.jsx(Ut,{node:n,index:o,togglePhotoSlider:s})}else if(n.type==="tag"&&n.name==="pre"){let o="",i="";if(((r=n.children[0])==null?void 0:r.name)==="code"){const l=n.children[0];i=l.attribs.class||"",o=((a=l.children[0])==null?void 0:a.data)||""}else i=n.attribs.class||"",o=n.children.map(l=>l.data||"").join("");return e.jsx(Wa,{className:i,children:o})}return n}}),to=m.forwardRef((t,s)=>{const n=ee(),{activeContent:r}=f(A),{articleWidth:a,fontFamily:o,fontSize:i}=f(S),{isPhotoSliderVisible:l,setIsPhotoSliderVisible:c,selectedIndex:u,setSelectedIndex:h}=Is(),d=()=>{Ve("author"),Ue(r.author)},p=_=>{h(_),c(b=>!b)},x=ks(r.content),g=eo(x,p),y=Rn(r.content,g),{id:v,title:k}=r.feed.category,{id:$,title:L}=r.feed;return e.jsx("article",{className:"article-content",ref:s,tabIndex:-1,children:e.jsx(rt,{className:"scroll-container",children:e.jsxs(As,{children:[e.jsxs("div",{className:"article-header",style:{width:`${a}%`},children:[e.jsx(T.Title,{className:"article-title",heading:3,children:e.jsx("a",{href:r.url,target:"_blank",rel:"noopener noreferrer",children:r.title})}),e.jsxs("div",{className:"article-meta",children:[e.jsx(T.Text,{children:e.jsx(js,{url:`/feed/${$}`,text:L})}),e.jsx(T.Text,{onClick:d,style:{cursor:"pointer"},children:` - ${r.author}`}),e.jsx(T.Text,{children:e.jsx(re,{size:"small",style:{marginLeft:"10px",cursor:"pointer"},onClick:()=>n(`/category/${v}`),children:k})})]}),e.jsx(T.Text,{className:"article-date",children:Tr(r.published_at)}),e.jsx("br",{}),e.jsx(T.Text,{className:"article-date",children:ss(r.reading_time)}),e.jsx(z,{})]}),e.jsxs("div",{className:"article-body",style:{fontSize:`${i}rem`,width:`${a}%`,fontFamily:o},children:[y,e.jsx(Dn,{images:x.map(_=>({src:_,key:_})),loop:!1,visible:l,onClose:()=>{c(!1)},index:u,onIndexChange:h})]},r.id)]})})})}),Ps=it(!1),Vt=I(Ps),so=(t,s)=>!s.some(n=>n.id===t.id),Ns=()=>{const{offset:t}=f(A),{pageSize:s,showStatus:n}=f(S),r=f(Ps),a=i=>{const l=(c,u)=>u.filter(h=>so(h,c));Ce(c=>[...c,...l(c,i)]),$e(c=>c+s)};return{handleLoadMore:async i=>{var l;Vt(!0);try{const c=n==="unread"?await i(t+s,"unread"):await i(t+s);if(((l=c==null?void 0:c.entries)==null?void 0:l.length)>0){const u=c.entries.map(Ts);a(u)}else fs(!1)}catch(c){console.error("Error fetching more articles: ",c)}finally{Vt(!1)}},loadingMore:r}},no=({alt:t,borderRadius:s,height:n,src:r,status:a,width:o})=>{const[i,l]=m.useState(!1),{ref:c}=Be({triggerOnce:!0,onChange:(u,h)=>{if(u&&!i){const d=new Image;d.onload=()=>l(!0),d.onerror=()=>{h.target.style.display="none"},d.src=r}}});return e.jsx("div",{className:"image-container",ref:c,children:e.jsx("div",{className:"img-placeholder",style:{width:"100%",height:"100%",backgroundColor:"var(--color-fill-2)",position:"absolute",left:0,top:0},children:i?e.jsx(dt.img,{className:a==="unread"?"":"read",src:r,alt:t,initial:{opacity:0},animate:{opacity:1},transition:{duration:.2},style:{width:o,height:n,objectFit:"cover",borderRadius:s}}):e.jsx("div",{className:"skeleton-container",children:e.jsx(Ne,{text:{rows:0},image:{style:{width:o,height:n,margin:"0",borderRadius:s}},animation:!0})})})})},ro=({entry:t,isThumbnail:s})=>{if(!t.imgSrc)return null;const n=s?{width:"80px",height:"80px"}:{width:"100%",height:"160px"};return e.jsx("div",{className:s?"thumbnail":"cover-image",children:e.jsx(no,{alt:t.id,borderRadius:s?"2px":void 0,src:t.imgSrc,status:t.status,width:n.width,height:n.height})})},ao=(t,s)=>t?s?"0 10px 0 0":"0 0 10px 0":"0",oo=({entry:t,showFeedIcon:s,mini:n,children:r})=>{const{showDetailedRelativeTime:a,showEstimatedReadingTime:o}=f(S),i=je({"article-card-mini-content":n,"article-card-mini-content-padding":n&&s});return e.jsxs("div",{className:i,style:{width:"100%",boxSizing:"border-box",opacity:t.status==="unread"?1:.5},children:[e.jsx("div",{style:{padding:ao(t.imgSrc,n)},children:e.jsx(ro,{entry:t,isThumbnail:n})}),e.jsxs("div",{className:n?"article-card-mini-content-text":"",children:[e.jsx(T.Ellipsis,{className:"article-card-title",rows:2,expandable:!1,children:t.title}),e.jsxs(T.Text,{className:"article-card-info",style:{lineHeight:"1em"},children:[s&&e.jsx(ms,{feed:t.feed,className:n?"feed-icon-mini":"feed-icon"}),t.feed.title,e.jsx("br",{}),ts(t.published_at,a),o&&e.jsxs(e.Fragment,{children:[e.jsx("br",{}),ss(t.reading_time)]})]}),t.starred&&e.jsx(ct,{className:"icon-starred"})]}),e.jsx("div",{children:r})]})},io=({entry:t,handleEntryClick:s,mini:n,children:r})=>{const{markReadOnScroll:a,showFeedIcon:o}=f(S),{activeContent:i}=f(A),{polyglot:l}=f(E),c=i&&t.id===i.id,{handleToggleStarred:u,handleToggleStatus:h}=Ge(),[d,p]=m.useState(0),x=60,g=.5,y=t.starred,v=t.status==="unread",k=Xt({preventScrollOnSwipe:!0,delta:x/2,onSwiping:W=>{const Q=Math.min(Math.abs(W.deltaX*g),x)*Math.sign(W.deltaX);p(Q)},onSwiped:async W=>{try{W.deltaX>x?(await u(t),j.success(y?l.t("article_card.unstarred"):l.t("article_card.starred"))):W.deltaX<-x&&(await h(t),j.success(v?l.t("article_card.marked_as_read"):l.t("article_card.marked_as_unread")))}catch(Q){console.error("Failed to update entry: ",Q),j.error(l.t("article_card.update_failed"))}p(0)}}),[$,L]=m.useState(!1),[_,b]=m.useState(!1),U=()=>h(t),J=20,{ref:X}=Be({skip:_,onChange:async(W,Q)=>{if(!(!a||!v)){if(W)L(!0);else if($){const{top:de}=Q.boundingClientRect;de<J&&(await U(),b(!0))}}}});return e.jsx("div",{className:"article-card",...k,children:e.jsxs("div",{ref:X,children:[e.jsx(dt.div,{className:"swipe-card",style:{x:d},animate:{x:d},transition:{type:"spring",stiffness:300,damping:30},children:e.jsx(Re,{className:je("swipe-content","card-custom-style","card-custom-hover-style",{"card-custom-selected-style":c}),"data-entry-id":t.id,hoverable:!0,onClick:()=>s(t),bordered:!1,children:e.jsx(Re.Meta,{description:e.jsx(oo,{entry:t,showFeedIcon:o,mini:n,children:r})})})}),e.jsxs("div",{className:"swipe-actions",children:[e.jsx("div",{className:"swipe-action left",children:y?e.jsx(ct,{style:{color:"#ffcd00",fontSize:"24px"}}):e.jsx(at,{style:{color:"#ffffff",fontSize:"24px"}})}),e.jsx("div",{className:"swipe-action right",children:v?e.jsx(Gt,{style:{color:"#ffffff",fontSize:"24px"}}):e.jsx(Yt,{style:{color:"#ffffff",fontSize:"24px"}})})]})]})},t.id)},lo=({layout:t,isArticleListReady:s})=>e.jsx(Re,{className:"card-style",cover:t==="large"?e.jsx("div",{className:"card-cover-style"}):null,children:e.jsx(Re.Meta,{description:e.jsx(Ne,{loading:!s,animation:!0,text:{rows:3,width:150}})})}),co=()=>{const{layout:t}=f(S),{isArticleListReady:s}=f(A),n=t==="large"?2:4;return!s&&Array.from({length:n},(r,a)=>e.jsx(lo,{layout:t,isArticleListReady:s},a))},uo=(...t)=>s=>{for(const n of t)typeof n=="function"?n(s):n&&typeof n=="object"&&(n.current=s)},ho=(t,s,n)=>{m.useLayoutEffect(()=>{let r=null;return t>0&&(clearTimeout(r),r=setTimeout(()=>{n(),clearTimeout(r)},s*4)),()=>clearTimeout(r)},[t,s,n])},po=({duration:t,color:s})=>{const[n,r]=m.useState([]);ho(n.length,t,()=>{r([])});const a=o=>{const i=o.currentTarget.getBoundingClientRect(),l=i.width>i.height?i.width:i.height,c=o.pageX-i.x-l/2,u=o.pageY-i.y-l/2,h={x:c,y:u,size:l,id:`${new Date().getTime()}-${c}-${u}`};r([...n,h])};return e.jsx("div",{className:"ripple-container",onMouseDown:a,children:n.length>0&&n.map(o=>e.jsx("span",{className:"ripple-span",style:{top:o.y,left:o.x,width:o.size,height:o.size,backgroundColor:s,animationDuration:`${t}ms`}},o.id))})},fo=({getEntries:t})=>{const{isArticleListReady:s,loadMoreVisible:n}=f(A),{loadingMore:r,handleLoadMore:a}=Ns(),{ref:o,inView:i}=Be(),l=m.useCallback(async()=>{n&&i&&s&&!r&&await a(t)},[n,i,s,r,a,t]);return m.useEffect(()=>{const c=setInterval(l,500);return()=>clearInterval(c)},[l]),s&&n&&e.jsxs("div",{className:"load-more-container",ref:o,children:[e.jsx(On,{loading:r,style:{paddingRight:"10px"}}),"Loading more ..."]})},mo=m.forwardRef(({getEntries:t,handleEntryClick:s,cardsRef:n},r)=>{const{layout:a,pageSize:o}=f(S),i=a==="small",{isArticleListReady:l,loadMoreVisible:c}=f(A),u=f(Se),h=u.length-Math.ceil(o*.2)-1,{loadingMore:d,handleLoadMore:p}=Ns(),{ref:x}=Be({skip:!c,onChange:async k=>{!k||!l||d||await p(t)}}),g=Mn({count:u.length,getScrollElement:()=>n.current,estimateSize:m.useCallback(()=>i?120:280,[i]),overscan:5}),y=g.getVirtualItems(),v=m.useCallback(k=>k===h?uo(g.measureElement,x):g.measureElement,[h,g.measureElement,x]);return e.jsx(e.Fragment,{children:e.jsxs(rt,{className:"entry-list",ref:r,children:[e.jsx(co,{}),l&&e.jsx(As,{children:e.jsx("div",{ref:n,children:e.jsx("div",{style:{height:g.getTotalSize(),width:"100%",position:"relative"},children:y.map(k=>e.jsx("div",{"data-index":k.index,ref:v(k.index),style:{position:"absolute",top:0,left:0,width:"100%",transform:`translateY(${k.start}px)`},children:e.jsx(io,{entry:u[k.index],handleEntryClick:s,mini:i,children:e.jsx(po,{color:"var(--color-text-4)",duration:1e3})})},k.key))})})}),e.jsx(fo,{getEntries:t})]})})}),go=()=>{const{filterDate:t,filterString:s,filterType:n}=f(A),{orderDirection:r}=f(S),{polyglot:a}=f(E),o=a.t("search.tooltip").split(`
`),[i,l]=m.useState(""),c=m.useCallback(_a(p=>Ue(p),500),[]),u=p=>{l(p),c(p)},{isBelowMedium:h}=ne(),d=()=>{H({orderDirection:r==="desc"?"asc":"desc"})};return m.useEffect(()=>{me(null),Ve("title"),Ue("")},[]),m.useEffect(()=>{s!==i&&l(s)},[s]),e.jsxs("div",{className:"search-and-sort-bar",children:[e.jsx(K.Search,{allowClear:!0,onChange:u,placeholder:a.t("search.placeholder"),style:{width:h?"100%":272,marginLeft:8},value:i,addBefore:e.jsxs(F,{onChange:Ve,style:{width:80},triggerProps:{autoAlignPopupWidth:!1,autoAlignPopupMinWidth:!0,position:"bl"},value:n,children:[e.jsx(F.Option,{value:"title",children:a.t("search.type_title")}),e.jsx(F.Option,{value:"content",children:a.t("search.type_content")}),e.jsx(F.Option,{value:"author",children:a.t("search.type_author")})]}),prefix:e.jsx(ze,{mini:!0,content:e.jsx("div",{children:o.map((p,x)=>e.jsxs(m.Fragment,{children:[p,x<o.length-1&&e.jsx("br",{})]},`line-${x}-${p.length}`))}),children:e.jsx(lt,{})})}),e.jsxs("div",{className:"button-group",children:[e.jsx(Un,{position:"bottom",triggerElement:e.jsx(D,{mini:!0,content:a.t("search.select_date"),children:e.jsx(w,{shape:"circle",size:"small",icon:e.jsx(Bt,{}),type:t?"primary":"default"})}),showNowBtn:!1,extra:e.jsxs("div",{className:"calendar-actions",children:[e.jsx(w,{onClick:()=>me(Sr()),type:"primary",size:"mini",long:!0,children:a.t("search.today")}),e.jsx(w,{onClick:()=>me(null),size:"mini",long:!0,children:a.t("search.clear_date")})]}),value:t,onChange:p=>me(p)}),e.jsx(D,{mini:!0,content:r==="desc"?a.t("article_list.sort_direction_desc"):a.t("article_list.sort_direction_asc"),children:e.jsx(w,{shape:"circle",size:"small",icon:r==="desc"?e.jsx(Vn,{}):e.jsx($n,{}),onClick:d})})]})]})},xo=()=>{Ce(t=>t.map(s=>({...s,status:"read"})))},_o=({info:t,refreshArticleList:s,markAllAsRead:n})=>{const{isArticleListReady:r}=f(A),{showStatus:a}=f(S),{polyglot:o}=f(E),{fetchAppData:i}=xt(),l=async()=>{try{await n(),xo(),await i(),j.success(o.t("article_list.mark_all_as_read_success"))}catch(u){console.error("Failed to mark all as read: ",u),j.error(o.t("article_list.mark_all_as_read_error"))}},c=u=>{H({showStatus:u})};return m.useEffect(()=>{me(null),Ve("title"),Ue("")},[a]),e.jsxs("div",{className:"entry-panel",children:[e.jsx(Kt,{focusLock:!0,onOk:l,title:o.t("article_list.mark_all_as_read_confirm"),children:e.jsx(D,{content:o.t("article_list.mark_all_as_read_tooltip"),mini:!0,children:e.jsx(w,{icon:e.jsx(Ht,{}),shape:"circle",style:{visibility:["starred","history"].includes(t.from)?"hidden":"visible"}})})}),e.jsx(zn.Group,{onChange:c,options:[{label:o.t("article_list.filter_status_all"),value:"all"},{label:o.t("article_list.filter_status_unread"),value:"unread"}],style:{visibility:t.from==="history"?"hidden":"visible"},type:"button",value:a}),e.jsx(D,{content:o.t("article_list.refresh_tooltip"),mini:!0,children:e.jsx(w,{icon:e.jsx(be,{}),loading:!r,shape:"circle",onClick:s})})]})},ce=({info:t,getEntries:s,markAllAsRead:n})=>{const{activeContent:r,filterDate:a,isArticleLoading:o}=f(A),{isAppDataReady:i}=f(O),{orderBy:l,orderDirection:c,showAllFeeds:u,showStatus:h}=f(S),{polyglot:d}=f(E),p=f(bt),x=f(pt),g=f(Ye),y=m.useRef(null),{entryDetailRef:v,entryListRef:k,handleEntryClick:$,isSwipingCodeBlock:L}=_t(),{exitDetailView:_,fetchOriginalArticle:b,navigateToNextArticle:U,navigateToNextUnreadArticle:J,navigateToPreviousArticle:X,navigateToPreviousUnreadArticle:W,openLinkExternally:Q,openPhotoSlider:de,saveToThirdPartyServices:N,showHotkeysSettings:te,toggleReadStatus:ke,toggleStarStatus:Ct}=Es(),{fetchAppData:kt}=xt(),{fetchArticleList:Je}=$a(t,s),{isBelowMedium:Ds}=ne(),{handleFetchContent:Ms,handleSaveToThirdPartyServices:Os,handleToggleStarred:Us,handleToggleStatus:Vs}=Ge(),$s={exitDetailView:_,fetchOriginalArticle:()=>b(Ms),navigateToNextArticle:()=>U(),navigateToNextUnreadArticle:()=>J(),navigateToPreviousArticle:()=>X(),navigateToPreviousUnreadArticle:()=>W(),openLinkExternally:Q,openPhotoSlider:de,saveToThirdPartyServices:()=>N(Os),showHotkeysSettings:te,toggleReadStatus:()=>ke(()=>Vs(r)),toggleStarStatus:()=>Ct(()=>Us(r))},zs=he=>he.filter(Xe=>!p.includes(Xe));for(const[he,Xe]of Object.entries($s))Bn(zs(g[he]),Xe);const ue=async he=>{$e(0),i?await Je(he):await kt()},Bs=m.useCallback(()=>{L||U()},[L,U]),Hs=m.useCallback(()=>{L||X()},[L,X]),qs=Xt({onSwipedLeft:Bs,onSwipedRight:Hs});return m.useEffect(()=>{p.length>0&&j.error(d.t("settings.duplicate_hotkeys"))},[p]),m.useEffect(()=>{ea(t.from),r&&Y(null),ue(s)},[t]),m.useEffect(()=>{["starred","history"].includes(t.from)||ue(s)},[l]),m.useEffect(()=>{x.length===0||["starred","history"].includes(t.from)||ue(s)},[u]),m.useEffect(()=>{ue(s)},[a,c,h]),e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"entry-col",style:{opacity:Ds&&o?0:1},children:[e.jsx(go,{}),e.jsx(mo,{cardsRef:y,getEntries:s,handleEntryClick:$,ref:k}),e.jsx(_o,{info:t,refreshArticleList:()=>ue(s),markAllAsRead:n})]}),r?e.jsxs("div",{className:"article-container",...qs,children:[!o&&e.jsx(to,{ref:v}),e.jsx(Ha,{})]}):e.jsxs("div",{className:"content-empty",children:[e.jsx(Hn,{style:{fontSize:"64px"}}),e.jsx(T.Title,{heading:6,style:{color:"var(--color-text-3)",marginTop:"10px"},children:"ReactFlux"})]})]})},yo=()=>e.jsx(ce,{info:{from:"all",id:""},getEntries:Fr,markAllAsRead:Br}),jo=()=>{const{id:t}=Qt(),s=V("orderBy"),n=V("pageSize"),r=V("showAllFeeds"),a=async(o=0,i=null)=>{const l={baseUrl:`/v1/categories/${t}/entries`,orderField:s,offset:o,limit:n,status:i},c={globally_visible:!r};return C.get(le(l,c))};return e.jsx(ce,{info:{from:"category",id:t},getEntries:a,markAllAsRead:()=>jr(t)})},bo=()=>{const t=ee(),s=qn();return console.error(s),m.useEffect(()=>{vt()},[]),e.jsx("div",{id:"error-page",style:{top:"30%",position:"relative"},children:e.jsx(Kn,{status:"404",subTitle:s.statusText||s.message,extra:[e.jsx(w,{type:"primary",onClick:()=>t("/"),children:"Back to Home"},"back")]})})},vo=()=>{const{id:t}=Qt(),s=V("orderBy"),n=V("pageSize"),r=async(a=0,o=null)=>{const i={baseUrl:`/v1/feeds/${t}/entries`,orderField:s,offset:a,limit:n,status:o};return C.get(le(i))};return e.jsx(ce,{info:{from:"feed",id:t},getEntries:r,markAllAsRead:()=>Ur(t)})},wo=()=>e.jsx(ce,{info:{from:"history",id:""},getEntries:Lr}),So=t=>{const s=t.getFieldsValue();let n=!0;for(const[r,a]of Object.entries(s))if(r!=="password"){const o=a==null?void 0:a.trim();t.setFieldValue(r,o),o||(n=!1)}else a||(n=!1);return n},Fe=(t,s)=>{t.key==="Enter"&&s.submit()},Co=()=>{Zt(),Cs();const t=f(ve),{homePage:s}=f(S),{polyglot:n}=f(E),[r]=Wn(),[a,o]=m.useState(!1),[i,l]=m.useState("token"),c=ee(),u=async d=>{o(!0);const{server:p,token:x,username:g,password:y}=d;try{(await $t.raw("v1/me",{baseURL:p,headers:x?{"X-Auth-Token":x}:{Authorization:`Basic ${btoa(`${g}:${y}`)}`}})).status===200&&(j.success(n.t("login.success")),es({server:p,token:x,username:g,password:y}),c("/"))}catch(v){console.error(v),j.error(v.message)}o(!1)},h=async d=>{if(!De(d)){j.error(n.t("login.auth_error"));return}await u(d)};return m.useEffect(()=>{vt()},[]),m.useEffect(()=>{const d=new URL(window.location.href),{server:p,token:x,username:g,password:y}=Object.fromEntries(d.searchParams);p&&(g&&l("user"),r.setFieldsValue({server:p,token:x,username:g,password:y}),r.submit())},[n]),De(t)?e.jsx(ut,{to:`/${s}`}):n&&e.jsxs("div",{className:"page-layout",children:[e.jsx("div",{className:"form-panel",children:e.jsxs("div",{className:"login-form",children:[e.jsx(T.Title,{heading:3,children:n.t("login.login_to_your_server")}),e.jsxs(P,{autoComplete:"off",form:r,layout:"vertical",onSubmit:async()=>{So(r)?(history.replaceState(null,"","/login"),await h(r.getFieldsValue())):j.error(n.t("login.submit_error"))},children:[e.jsx(P.Item,{field:"server",label:n.t("login.server_label"),rules:[{required:!0}],onKeyDown:d=>{Fe(d,r)},children:e.jsx(K,{disabled:a,placeholder:n.t("login.server_placeholder"),prefix:e.jsx(Gn,{})})}),i==="token"&&e.jsx(P.Item,{field:"token",label:n.t("login.token_label"),rules:[{required:!0}],onKeyDown:d=>{Fe(d,r)},children:e.jsx(K.Password,{disabled:a,placeholder:n.t("login.token_placeholder"),prefix:e.jsx(At,{})})}),i==="user"&&e.jsxs(e.Fragment,{children:[e.jsx(P.Item,{field:"username",label:n.t("login.username_label"),rules:[{required:!0}],onKeyDown:d=>{Fe(d,r)},children:e.jsx(K,{disabled:a,placeholder:n.t("login.username_placeholder"),prefix:e.jsx(qt,{})})}),e.jsx(P.Item,{field:"password",label:n.t("login.password_label"),rules:[{required:!0}],onKeyDown:d=>{Fe(d,r)},children:e.jsx(K.Password,{disabled:a,placeholder:n.t("login.password_placeholder"),prefix:e.jsx(At,{})})})]})]}),e.jsx(w,{loading:a,type:"primary",long:!0,onClick:()=>r.submit(),style:{marginTop:"20px"},children:n.t("login.login_button")}),e.jsx(z,{children:n.t("login.another_login_method")}),e.jsx(w,{type:"secondary",long:!0,onClick:()=>l(i==="token"?"user":"token"),style:{marginTop:"20px"},children:i==="token"?n.t("login.another_login_button"):n.t("login.token_label")}),e.jsxs("div",{style:{display:"flex",marginTop:"40px"},children:[e.jsx(T.Text,{disabled:!0,children:n.t("login.need_help")}),e.jsx(Yn,{href:"https://miniflux.app/docs/api.html#authentication",style:{fontWeight:"500"},children:n.t("login.miniflux_official_website")})]})]})}),e.jsx("div",{className:"background"})]})},ko=({children:t})=>{const s=f(ve);return De(s)?e.jsx(e.Fragment,{children:t}):e.jsx(ut,{to:"/login"})},To=()=>e.jsx(ce,{info:{from:"starred",id:""},getEntries:ns}),Io=()=>{const t=async()=>{const s=await Le(0,"unread"),n=s.total;let r=s.entries;n>r.length&&(r=Le(0,"unread",n).then(o=>o.entries));const a=r.map(o=>o.id);return Ke(a,"read")};return e.jsx(ce,{info:{from:"today",id:""},getEntries:Le,markAllAsRead:t})},Eo=V("homePage"),Ao=[{path:"/all",element:e.jsx(yo,{})},{path:"/today",element:e.jsx(Io,{})},{path:"/starred",element:e.jsx(To,{})},{path:"/history",element:e.jsx(wo,{})},{path:"/category/:id",element:e.jsx(jo,{})},{path:"/feed/:id",element:e.jsx(vo,{})}],Rs=Jn([{path:"/",element:e.jsx(ko,{children:e.jsx(Ua,{})}),errorElement:e.jsx(bo,{}),children:[...Ao,{index:!0,element:e.jsx(ut,{to:`/${Eo}`,replace:!0})}]},{path:"/login",element:e.jsx(Co,{})}]),Fo={"zh-CN":tr,"es-ES":sr},Lo=()=>Fo[or()]||er;Xn.createRoot(document.getElementById("root")).render(e.jsx(Qn,{locale:Lo(),children:e.jsx(Zn,{router:Rs})}));
